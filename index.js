(()=>{var e,n={9650:(e,n,t)=>{var a,r=(a=(a="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var n,r,i;e=e||{},n||(n=void 0!==e?e:{}),n.ready=new Promise((function(e,n){r=e,i=n}));var o,s,l,c,u,d={};for(o in n)n.hasOwnProperty(o)&&(d[o]=n[o]);s="object"==typeof window,l="function"==typeof importScripts,c="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,u=!s&&!c&&!l;var f,h,p,m,v="";c?(v=l?t(5783).dirname(v)+"/":"//",f=function(e,n){return p||(p=t(2203)),m||(m=t(5783)),e=m.normalize(e),p.readFileSync(e,n?null:"utf8")},h=function(e){return(e=f(e,!0)).buffer||(e=new Uint8Array(e)),w(e.buffer),e},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){throw e})),process.on("unhandledRejection",J),n.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(f=function(e){return read(e)}),h=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(w("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(s||l)&&(l?v=self.location.href:"undefined"!=typeof document&&document.currentScript&&(v=document.currentScript.src),a&&(v=a),v=0!==v.indexOf("blob:")?v.substr(0,v.lastIndexOf("/")+1):"",f=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),n.responseText},l&&(h=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}));var g,b=n.print||console.log.bind(console),y=n.printErr||console.warn.bind(console);for(o in d)d.hasOwnProperty(o)&&(n[o]=d[o]);d=null,n.wasmBinary&&(g=n.wasmBinary),n.noExitRuntime&&n.noExitRuntime,"object"!=typeof WebAssembly&&J("no native wasm support detected");var x,j=!1;function w(e,n){e||J("Assertion failed: "+n)}var C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function O(e,n,t){var a=n+t;for(t=n;e[t]&&!(t>=a);)++t;if(16<t-n&&e.subarray&&C)return C.decode(e.subarray(n,t));for(a="";n<t;){var r=e[n++];if(128&r){var i=63&e[n++];if(192==(224&r))a+=String.fromCharCode((31&r)<<6|i);else{var o=63&e[n++];65536>(r=224==(240&r)?(15&r)<<12|i<<6|o:(7&r)<<18|i<<12|o<<6|63&e[n++])?a+=String.fromCharCode(r):(r-=65536,a+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else a+=String.fromCharCode(r)}return a}var _,N,S,k,E,P,A,V,T,R="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function F(e,n){for(var t=e>>1,a=t+n/2;!(t>=a)&&E[t];)++t;if(32<(t<<=1)-e&&R)return R.decode(S.subarray(e,t));for(t="",a=0;!(a>=n/2);++a){var r=k[e+2*a>>1];if(0==r)break;t+=String.fromCharCode(r)}return t}function M(e,n,t){if(void 0===t&&(t=2147483647),2>t)return 0;var a=n;t=(t-=2)<2*e.length?t/2:e.length;for(var r=0;r<t;++r)k[n>>1]=e.charCodeAt(r),n+=2;return k[n>>1]=0,n-a}function I(e){return 2*e.length}function L(e,n){for(var t=0,a="";!(t>=n/4);){var r=P[e+4*t>>2];if(0==r)break;++t,65536<=r?(r-=65536,a+=String.fromCharCode(55296|r>>10,56320|1023&r)):a+=String.fromCharCode(r)}return a}function z(e,n,t){if(void 0===t&&(t=2147483647),4>t)return 0;var a=n;t=a+t-4;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),P[n>>2]=i,(n+=4)+4>t)break}return P[n>>2]=0,n-a}function W(e){for(var n=0,t=0;t<e.length;++t){var a=e.charCodeAt(t);55296<=a&&57343>=a&&++t,n+=4}return n}function U(){var e=x.buffer;_=e,n.HEAP8=N=new Int8Array(e),n.HEAP16=k=new Int16Array(e),n.HEAP32=P=new Int32Array(e),n.HEAPU8=S=new Uint8Array(e),n.HEAPU16=E=new Uint16Array(e),n.HEAPU32=A=new Uint32Array(e),n.HEAPF32=V=new Float32Array(e),n.HEAPF64=T=new Float64Array(e)}var D,B=[],q=[],H=[],Y=[];function Z(){var e=n.preRun.shift();B.unshift(e)}var X=0,G=null,Q=null;function J(e){throw n.onAbort&&n.onAbort(e),y(e),j=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),i(e),e}function $(e){var n=ee;return String.prototype.startsWith?n.startsWith(e):0===n.indexOf(e)}function K(){return $("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={};var ee="diff.wasm";if(!K()){var ne=ee;ee=n.locateFile?n.locateFile(ne,v):v+ne}function te(){var e=ee;try{if(e==ee&&g)return new Uint8Array(g);if(h)return h(e);throw"both async and sync fetching of the wasm failed"}catch(e){J(e)}}function ae(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t(n);else{var a=t.qa;"number"==typeof a?void 0===t.ga?D.get(a)():D.get(a)(t.ga):a(void 0===t.ga?null:t.ga)}}}function re(e){this.O=e-16,this.Ga=function(e){P[this.O+8>>2]=e},this.Da=function(e){P[this.O+0>>2]=e},this.Ea=function(){P[this.O+4>>2]=0},this.Ca=function(){N[this.O+12>>0]=0},this.Fa=function(){N[this.O+13>>0]=0},this.xa=function(e,n){this.Ga(e),this.Da(n),this.Ea(),this.Ca(),this.Fa()}}var ie={};function oe(e){for(;e.length;){var n=e.pop();e.pop()(n)}}function se(e){return this.fromWireType(A[e>>2])}var le={},ce={},ue={};function de(e){if(void 0===e)return"_unknown";var n=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=n&&57>=n?"_"+e:e}function fe(e,n){return e=de(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(n)}function he(e){var n=Error,t=fe(e,(function(n){this.name=e,this.message=n,void 0!==(n=Error(n).stack)&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},t}var pe=void 0;function me(e){throw new pe(e)}function ve(e,n,t){function a(n){(n=t(n)).length!==e.length&&me("Mismatched type converter count");for(var a=0;a<e.length;++a)we(e[a],n[a])}e.forEach((function(e){ue[e]=n}));var r=Array(n.length),i=[],o=0;n.forEach((function(e,n){ce.hasOwnProperty(e)?r[n]=ce[e]:(i.push(e),le.hasOwnProperty(e)||(le[e]=[]),le[e].push((function(){r[n]=ce[e],++o===i.length&&a(r)})))})),0===i.length&&a(r)}function ge(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var be=void 0;function ye(e){for(var n="";S[e];)n+=be[S[e++]];return n}var xe=void 0;function je(e){throw new xe(e)}function we(e,n,t){if(t=t||{},!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var a=n.name;if(e||je('type "'+a+'" must have a positive integer typeid pointer'),ce.hasOwnProperty(e)){if(t.wa)return;je("Cannot register type '"+a+"' twice")}ce[e]=n,delete ue[e],le.hasOwnProperty(e)&&(n=le[e],delete le[e],n.forEach((function(e){e()})))}function Ce(e){return{count:e.count,Z:e.Z,aa:e.aa,O:e.O,R:e.R,S:e.S,T:e.T}}function Oe(e){je(e.N.R.P.name+" instance already deleted")}var _e=!1;function Ne(){}function Se(e){--e.count.value,0===e.count.value&&(e.S?e.T.X(e.S):e.R.P.X(e.O))}function ke(e){return"undefined"==typeof FinalizationGroup?(ke=function(e){return e},e):(_e=new FinalizationGroup((function(e){for(var n=e.next();!n.done;n=e.next())(n=n.value).O?Se(n):console.warn("object already deleted: "+n.O)})),Ne=function(e){_e.unregister(e.N)},(ke=function(e){return _e.register(e,e.N,e.N),e})(e))}var Ee=void 0,Pe=[];function Ae(){for(;Pe.length;){var e=Pe.pop();e.N.Z=!1,e.delete()}}function Ve(){}var Te={};function Re(e,n,t){if(void 0===e[n].W){var a=e[n];e[n]=function(){return e[n].W.hasOwnProperty(arguments.length)||je("Function '"+t+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[n].W+")!"),e[n].W[arguments.length].apply(this,arguments)},e[n].W=[],e[n].W[a.da]=a}}function Fe(e,n,t,a,r,i,o,s){this.name=e,this.constructor=n,this.$=t,this.X=a,this.U=r,this.ra=i,this.ba=o,this.oa=s,this.Aa=[]}function Me(e,n,t){for(;n!==t;)n.ba||je("Expected null or instance of "+t.name+", got an instance of "+n.name),e=n.ba(e),n=n.U;return e}function Ie(e,n){return null===n?(this.ha&&je("null is not a valid "+this.name),0):(n.N||je('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||je("Cannot pass deleted object as a pointer of type "+this.name),Me(n.N.O,n.N.R.P,this.P))}function Le(e,n){if(null===n){if(this.ha&&je("null is not a valid "+this.name),this.fa){var t=this.ia();return null!==e&&e.push(this.X,t),t}return 0}if(n.N||je('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||je("Cannot pass deleted object as a pointer of type "+this.name),!this.ea&&n.N.R.ea&&je("Cannot convert argument of type "+(n.N.T?n.N.T.name:n.N.R.name)+" to parameter type "+this.name),t=Me(n.N.O,n.N.R.P,this.P),this.fa)switch(void 0===n.N.S&&je("Passing raw pointer to smart pointer is illegal"),this.Ka){case 0:n.N.T===this?t=n.N.S:je("Cannot convert argument of type "+(n.N.T?n.N.T.name:n.N.R.name)+" to parameter type "+this.name);break;case 1:t=n.N.S;break;case 2:if(n.N.T===this)t=n.N.S;else{var a=n.clone();t=this.Ba(t,Ke((function(){a.delete()}))),null!==e&&e.push(this.X,t)}break;default:je("Unsupporting sharing policy")}return t}function ze(e,n){return null===n?(this.ha&&je("null is not a valid "+this.name),0):(n.N||je('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||je("Cannot pass deleted object as a pointer of type "+this.name),n.N.R.ea&&je("Cannot convert argument of type "+n.N.R.name+" to parameter type "+this.name),Me(n.N.O,n.N.R.P,this.P))}function We(e,n,t){return n===t?e:void 0===t.U||null===(e=We(e,n,t.U))?null:t.oa(e)}var Ue={};function De(e,n){return n.R&&n.O||me("makeClassHandle requires ptr and ptrType"),!!n.T!=!!n.S&&me("Both smartPtrType and smartPtr must be specified"),n.count={value:1},ke(Object.create(e,{N:{value:n}}))}function Be(e,n,t,a){this.name=e,this.P=n,this.ha=t,this.ea=a,this.fa=!1,this.X=this.Ba=this.ia=this.ma=this.Ka=this.za=void 0,void 0!==n.U?this.toWireType=Le:(this.toWireType=a?Ie:ze,this.V=null)}function qe(e,t){var a=-1!=(e=ye(e)).indexOf("j")?function(e,t){w(0<=e.indexOf("j"),"getDynCaller should only be called with i64 sigs");var a=[];return function(){a.length=arguments.length;for(var r=0;r<arguments.length;r++)a[r]=arguments[r];return-1!=e.indexOf("j")?a&&a.length?n["dynCall_"+e].apply(null,[t].concat(a)):n["dynCall_"+e].call(null,t):D.get(t).apply(null,a)}}(e,t):D.get(t);return"function"!=typeof a&&je("unknown function pointer with signature "+e+": "+t),a}var He=void 0;function Ye(e){var n=ye(e=yn(e));return bn(e),n}function Ze(e,n){var t=[],a={};throw n.forEach((function e(n){a[n]||ce[n]||(ue[n]?ue[n].forEach(e):(t.push(n),a[n]=!0))})),new He(e+": "+t.map(Ye).join([", "]))}function Xe(e,n){for(var t=[],a=0;a<e;a++)t.push(P[(n>>2)+a]);return t}function Ge(e){var n=Function;if(!(n instanceof Function))throw new TypeError("new_ called with constructor type "+typeof n+" which is not a function");var t=fe(n.name||"unknownFunctionName",(function(){}));return t.prototype=n.prototype,t=new t,(e=n.apply(t,e))instanceof Object?e:t}var Qe=[],Je=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function $e(e){4<e&&0==--Je[e].ja&&(Je[e]=void 0,Qe.push(e))}function Ke(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var n=Qe.length?Qe.pop():Je.length;return Je[n]={ja:1,value:e},n}}function en(e){if(null===e)return"null";var n=typeof e;return"object"===n||"array"===n||"function"===n?e.toString():""+e}function nn(e,n){switch(n){case 2:return function(e){return this.fromWireType(V[e>>2])};case 3:return function(e){return this.fromWireType(T[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function tn(e,n,t){switch(n){case 0:return t?function(e){return N[e]}:function(e){return S[e]};case 1:return t?function(e){return k[e>>1]}:function(e){return E[e>>1]};case 2:return t?function(e){return P[e>>2]}:function(e){return A[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var an={};function rn(e){var n=an[e];return void 0===n?ye(e):n}var on=[];function sn(e){return e||je("Cannot use deleted val. handle = "+e),Je[e].value}function ln(){return"object"==typeof globalThis?globalThis:Function("return this")()}function cn(e,n){var t=ce[e];return void 0===t&&je(n+" has unknown type "+Ye(e)),t}var un={},dn=[null,[],[]];pe=n.InternalError=he("InternalError");for(var fn=Array(256),hn=0;256>hn;++hn)fn[hn]=String.fromCharCode(hn);be=fn,xe=n.BindingError=he("BindingError"),Ve.prototype.isAliasOf=function(e){if(!(this instanceof Ve&&e instanceof Ve))return!1;var n=this.N.R.P,t=this.N.O,a=e.N.R.P;for(e=e.N.O;n.U;)t=n.ba(t),n=n.U;for(;a.U;)e=a.ba(e),a=a.U;return n===a&&t===e},Ve.prototype.clone=function(){if(this.N.O||Oe(this),this.N.aa)return this.N.count.value+=1,this;var e=ke(Object.create(Object.getPrototypeOf(this),{N:{value:Ce(this.N)}}));return e.N.count.value+=1,e.N.Z=!1,e},Ve.prototype.delete=function(){this.N.O||Oe(this),this.N.Z&&!this.N.aa&&je("Object already scheduled for deletion"),Ne(this),Se(this.N),this.N.aa||(this.N.S=void 0,this.N.O=void 0)},Ve.prototype.isDeleted=function(){return!this.N.O},Ve.prototype.deleteLater=function(){return this.N.O||Oe(this),this.N.Z&&!this.N.aa&&je("Object already scheduled for deletion"),Pe.push(this),1===Pe.length&&Ee&&Ee(Ae),this.N.Z=!0,this},Be.prototype.sa=function(e){return this.ma&&(e=this.ma(e)),e},Be.prototype.ka=function(e){this.X&&this.X(e)},Be.prototype.argPackAdvance=8,Be.prototype.readValueFromPointer=se,Be.prototype.deleteObject=function(e){null!==e&&e.delete()},Be.prototype.fromWireType=function(e){function n(){return this.fa?De(this.P.$,{R:this.za,O:t,T:this,S:e}):De(this.P.$,{R:this,O:e})}var t=this.sa(e);if(!t)return this.ka(e),null;var a=function(e,n){for(void 0===n&&je("ptr should not be undefined");e.U;)n=e.ba(n),e=e.U;return Ue[n]}(this.P,t);if(void 0!==a)return 0===a.N.count.value?(a.N.O=t,a.N.S=e,a.clone()):(a=a.clone(),this.ka(e),a);if(a=this.P.ra(t),!(a=Te[a]))return n.call(this);a=this.ea?a.na:a.pointerType;var r=We(t,this.P,a.P);return null===r?n.call(this):this.fa?De(a.P.$,{R:a,O:r,T:this,S:e}):De(a.P.$,{R:a,O:r})},n.getInheritedInstanceCount=function(){return Object.keys(Ue).length},n.getLiveInheritedInstances=function(){var e,n=[];for(e in Ue)Ue.hasOwnProperty(e)&&n.push(Ue[e]);return n},n.flushPendingDeletes=Ae,n.setDelayFunction=function(e){Ee=e,Pe.length&&Ee&&Ee(Ae)},He=n.UnboundTypeError=he("UnboundTypeError"),n.count_emval_handles=function(){for(var e=0,n=5;n<Je.length;++n)void 0!==Je[n]&&++e;return e},n.get_first_emval=function(){for(var e=5;e<Je.length;++e)if(void 0!==Je[e])return Je[e];return null},q.push({qa:function(){vn()}});var pn={b:function(e,n,t,a){J("Assertion failed: "+(e?O(S,e,void 0):"")+", at: "+[n?n?O(S,n,void 0):"":"unknown filename",t,a?a?O(S,a,void 0):"":"unknown function"])},B:function(e){return gn(e+16)+16},E:function(){},A:function(e,n,t){throw new re(e).xa(n,t),e},i:function(e){var n=ie[e];delete ie[e];var t=n.ia,a=n.X,r=n.la;ve([e],r.map((function(e){return e.va})).concat(r.map((function(e){return e.Ia}))),(function(e){var i={};return r.forEach((function(n,t){var a=e[t],o=n.ta,s=n.ua,l=e[t+r.length],c=n.Ha,u=n.Ja;i[n.pa]={read:function(e){return a.fromWireType(o(s,e))},write:function(e,n){var t=[];c(u,e,l.toWireType(t,n)),oe(t)}}})),[{name:n.name,fromWireType:function(e){var n,t={};for(n in i)t[n]=i[n].read(e);return a(e),t},toWireType:function(e,n){for(var r in i)if(!(r in n))throw new TypeError('Missing field:  "'+r+'"');var o=t();for(r in i)i[r].write(o,n[r]);return null!==e&&e.push(a,o),o},argPackAdvance:8,readValueFromPointer:se,V:a}]}))},y:function(e,n,t,a,r){var i=ge(t);we(e,{name:n=ye(n),fromWireType:function(e){return!!e},toWireType:function(e,n){return n?a:r},argPackAdvance:8,readValueFromPointer:function(e){if(1===t)var a=N;else if(2===t)a=k;else{if(4!==t)throw new TypeError("Unknown boolean type size: "+n);a=P}return this.fromWireType(a[e>>i])},V:null})},t:function(e,t,a,r,i,o,s,l,c,u,d,f,h){d=ye(d),o=qe(i,o),l&&(l=qe(s,l)),u&&(u=qe(c,u)),h=qe(f,h);var p=de(d);!function(e,t){n.hasOwnProperty(e)?(je("Cannot register public name '"+e+"' twice"),Re(n,e,e),n.hasOwnProperty(void 0)&&je("Cannot register multiple overloads of a function with the same number of arguments (undefined)!"),n[e].W[void 0]=t):n[e]=t}(p,(function(){Ze("Cannot construct "+d+" due to unbound types",[r])})),ve([e,t,a],r?[r]:[],(function(t){if(t=t[0],r)var a=t.P,i=a.$;else i=Ve.prototype;t=fe(p,(function(){if(Object.getPrototypeOf(this)!==s)throw new xe("Use 'new' to construct "+d);if(void 0===c.Y)throw new xe(d+" has no accessible constructor");var e=c.Y[arguments.length];if(void 0===e)throw new xe("Tried to invoke ctor of "+d+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(c.Y).toString()+") parameters instead!");return e.apply(this,arguments)}));var s=Object.create(i,{constructor:{value:t}});t.prototype=s;var c=new Fe(d,t,s,h,a,o,l,u);a=new Be(d,c,!0,!1),i=new Be(d+"*",c,!1,!1);var f=new Be(d+" const*",c,!1,!0);return Te[e]={pointerType:i,na:f},function(e,t){n.hasOwnProperty(e)||me("Replacing nonexistant public symbol"),n[e]=t,n[e].da=void 0}(p,t),[a,i,f]}))},s:function(e,n,t,a,r,i){w(0<n);var o=Xe(n,t);r=qe(a,r);var s=[i],l=[];ve([],[e],(function(e){var t="constructor "+(e=e[0]).name;if(void 0===e.P.Y&&(e.P.Y=[]),void 0!==e.P.Y[n-1])throw new xe("Cannot register multiple constructors with identical number of parameters ("+(n-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.P.Y[n-1]=function(){Ze("Cannot construct "+e.name+" due to unbound types",o)},ve([],o,(function(a){return e.P.Y[n-1]=function(){arguments.length!==n-1&&je(t+" called with "+arguments.length+" arguments, expected "+(n-1)),l.length=0,s.length=n;for(var e=1;e<n;++e)s[e]=a[e].toWireType(l,arguments[e-1]);return e=r.apply(null,s),oe(l),a[0].fromWireType(e)},[]})),[]}))},r:function(e,n,t,a,r,i,o,s){var l=Xe(t,a);n=ye(n),i=qe(r,i),ve([],[e],(function(e){function a(){Ze("Cannot call "+r+" due to unbound types",l)}var r=(e=e[0]).name+"."+n;s&&e.P.Aa.push(n);var c=e.P.$,u=c[n];return void 0===u||void 0===u.W&&u.className!==e.name&&u.da===t-2?(a.da=t-2,a.className=e.name,c[n]=a):(Re(c,n,r),c[n].W[t-2]=a),ve([],l,(function(a){var s=r,l=e,u=i,d=a.length;2>d&&je("argTypes array size mismatch! Must at least get return value and 'this' types!");var f=null!==a[1]&&null!==l,h=!1;for(l=1;l<a.length;++l)if(null!==a[l]&&void 0===a[l].V){h=!0;break}var p="void"!==a[0].name,m="",v="";for(l=0;l<d-2;++l)m+=(0!==l?", ":"")+"arg"+l,v+=(0!==l?", ":"")+"arg"+l+"Wired";s="return function "+de(s)+"("+m+") {\nif (arguments.length !== "+(d-2)+") {\nthrowBindingError('function "+s+" called with ' + arguments.length + ' arguments, expected "+(d-2)+" args!');\n}\n",h&&(s+="var destructors = [];\n");var g=h?"destructors":"null";for(m="throwBindingError invoker fn runDestructors retType classParam".split(" "),u=[je,u,o,oe,a[0],a[1]],f&&(s+="var thisWired = classParam.toWireType("+g+", this);\n"),l=0;l<d-2;++l)s+="var arg"+l+"Wired = argType"+l+".toWireType("+g+", arg"+l+"); // "+a[l+2].name+"\n",m.push("argType"+l),u.push(a[l+2]);if(f&&(v="thisWired"+(0<v.length?", ":"")+v),s+=(p?"var rv = ":"")+"invoker(fn"+(0<v.length?", ":"")+v+");\n",h)s+="runDestructors(destructors);\n";else for(l=f?1:2;l<a.length;++l)d=1===l?"thisWired":"arg"+(l-2)+"Wired",null!==a[l].V&&(s+=d+"_dtor("+d+"); // "+a[l].name+"\n",m.push(d+"_dtor"),u.push(a[l].V));return p&&(s+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),m.push(s+"}\n"),a=Ge(m).apply(null,u),void 0===c[n].W?(a.da=t-2,c[n]=a):c[n].W[t-2]=a,[]})),[]}))},x:function(e,n){we(e,{name:n=ye(n),fromWireType:function(e){var n=Je[e].value;return $e(e),n},toWireType:function(e,n){return Ke(n)},argPackAdvance:8,readValueFromPointer:se,V:null})},k:function(e,n,t){t=ge(t),we(e,{name:n=ye(n),fromWireType:function(e){return e},toWireType:function(e,n){if("number"!=typeof n&&"boolean"!=typeof n)throw new TypeError('Cannot convert "'+en(n)+'" to '+this.name);return n},argPackAdvance:8,readValueFromPointer:nn(n,t),V:null})},d:function(e,n,t,a,r){function i(e){return e}n=ye(n),-1===r&&(r=4294967295);var o=ge(t);if(0===a){var s=32-8*t;i=function(e){return e<<s>>>s}}var l=-1!=n.indexOf("unsigned");we(e,{name:n,fromWireType:i,toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+en(t)+'" to '+this.name);if(t<a||t>r)throw new TypeError('Passing a number "'+en(t)+'" from JS side to C/C++ side to an argument of type "'+n+'", which is outside the valid range ['+a+", "+r+"]!");return l?t>>>0:0|t},argPackAdvance:8,readValueFromPointer:tn(n,o,0!==a),V:null})},c:function(e,n,t){function a(e){var n=A;return new r(_,n[1+(e>>=2)],n[e])}var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][n];we(e,{name:t=ye(t),fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{wa:!0})},l:function(e,n){var t="std::string"===(n=ye(n));we(e,{name:n,fromWireType:function(e){var n=A[e>>2];if(t)for(var a=e+4,r=0;r<=n;++r){var i=e+4+r;if(r==n||0==S[i]){if(a=a?O(S,a,i-a):"",void 0===o)var o=a;else o+=String.fromCharCode(0),o+=a;a=i+1}}else{for(o=Array(n),r=0;r<n;++r)o[r]=String.fromCharCode(S[e+4+r]);o=o.join("")}return bn(e),o},toWireType:function(e,n){n instanceof ArrayBuffer&&(n=new Uint8Array(n));var a="string"==typeof n;a||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||je("Cannot pass non-string to std::string");var r=(t&&a?function(){for(var e=0,t=0;t<n.length;++t){var a=n.charCodeAt(t);55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&n.charCodeAt(++t)),127>=a?++e:e=2047>=a?e+2:65535>=a?e+3:e+4}return e}:function(){return n.length})(),i=gn(4+r+1);if(A[i>>2]=r,t&&a)!function(e,n,t){var a=S;if(0<t){t=n+t-1;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),127>=i){if(n>=t)break;a[n++]=i}else{if(2047>=i){if(n+1>=t)break;a[n++]=192|i>>6}else{if(65535>=i){if(n+2>=t)break;a[n++]=224|i>>12}else{if(n+3>=t)break;a[n++]=240|i>>18,a[n++]=128|i>>12&63}a[n++]=128|i>>6&63}a[n++]=128|63&i}}a[n]=0}}(n,i+4,r+1);else if(a)for(a=0;a<r;++a){var o=n.charCodeAt(a);255<o&&(bn(i),je("String has UTF-16 code units that do not fit in 8 bits")),S[i+4+a]=o}else for(a=0;a<r;++a)S[i+4+a]=n[a];return null!==e&&e.push(bn,i),i},argPackAdvance:8,readValueFromPointer:se,V:function(e){bn(e)}})},g:function(e,n,t){if(t=ye(t),2===n)var a=F,r=M,i=I,o=function(){return E},s=1;else 4===n&&(a=L,r=z,i=W,o=function(){return A},s=2);we(e,{name:t,fromWireType:function(e){for(var t,r=A[e>>2],i=o(),l=e+4,c=0;c<=r;++c){var u=e+4+c*n;c!=r&&0!=i[u>>s]||(l=a(l,u-l),void 0===t?t=l:(t+=String.fromCharCode(0),t+=l),l=u+n)}return bn(e),t},toWireType:function(e,a){"string"!=typeof a&&je("Cannot pass non-string to C++ string type "+t);var o=i(a),l=gn(4+o+n);return A[l>>2]=o>>s,r(a,l+4,o+n),null!==e&&e.push(bn,l),l},argPackAdvance:8,readValueFromPointer:se,V:function(e){bn(e)}})},m:function(e,n,t,a,r,i){ie[e]={name:ye(n),ia:qe(t,a),X:qe(r,i),la:[]}},e:function(e,n,t,a,r,i,o,s,l,c){ie[e].la.push({pa:ye(n),va:t,ta:qe(a,r),ua:i,Ia:o,Ha:qe(s,l),Ja:c})},z:function(e,n){we(e,{ya:!0,name:n=ye(n),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},n:function(e,n,t,a){(e=on[e])(n=sn(n),t=rn(t),null,a)},f:$e,p:function(e){return 0===e?Ke(ln()):(e=rn(e),Ke(ln()[e]))},o:function(e,n){for(var t=(n=function(e,n){for(var t=Array(e),a=0;a<e;++a)t[a]=cn(P[(n>>2)+a],"parameter "+a);return t}(e,n))[0],a=t.name+"_$"+n.slice(1).map((function(e){return e.name})).join("_")+"$",r=["retType"],i=[t],o="",s=0;s<e-1;++s)o+=(0!==s?", ":"")+"arg"+s,r.push("argType"+s),i.push(n[1+s]);a="return function "+de("methodCaller_"+a)+"(handle, name, destructors, args) {\n";var l=0;for(s=0;s<e-1;++s)a+="    var arg"+s+" = argType"+s+".readValueFromPointer(args"+(l?"+"+l:"")+");\n",l+=n[s+1].argPackAdvance;for(a+="    var rv = handle[name]("+o+");\n",s=0;s<e-1;++s)n[s+1].deleteObject&&(a+="    argType"+s+".deleteObject(arg"+s+");\n");return t.ya||(a+="    return retType.toWireType(destructors, rv);\n"),r.push(a+"};\n"),function(e){var n=on.length;return on.push(e),n}(e=Ge(r).apply(null,i))},h:function(e){4<e&&(Je[e].ja+=1)},D:function(e,t,a,r){e=sn(e);var i=un[t];if(!i){i="";for(var o=0;o<t;++o)i+=(0!==o?", ":"")+"arg"+o;var s="return function emval_allocator_"+t+"(constructor, argTypes, args) {\n";for(o=0;o<t;++o)s+="var argType"+o+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+o+'], "parameter '+o+'");\nvar arg'+o+" = argType"+o+".readValueFromPointer(args);\nargs += argType"+o+"['argPackAdvance'];\n";i=new Function("requireRegisteredType","Module","__emval_register",s+"var obj = new constructor("+i+");\nreturn __emval_register(obj);\n}\n")(cn,n,Ke),un[t]=i}return i(e,a,r)},C:function(){return Ke([])},q:function(e,n){return Ke(e=(e=cn(e,"_emval_take_value")).readValueFromPointer(n))},a:function(){J()},v:function(e,n,t){S.copyWithin(e,n,n+t)},w:function(e){e>>>=0;var n=S.length;if(2147483648<e)return!1;for(var t=1;4>=t;t*=2){var a=n*(1+.2/t);a=Math.min(a,e+100663296),0<(a=Math.max(16777216,e,a))%65536&&(a+=65536-a%65536);e:{try{x.grow(Math.min(2147483648,a)-_.byteLength+65535>>>16),U();var r=1;break e}catch(e){}r=void 0}if(r)return!0}return!1},j:function(e,n,t,a){for(var r=0,i=0;i<t;i++){for(var o=P[n+8*i>>2],s=P[n+(8*i+4)>>2],l=0;l<s;l++){var c=S[o+l],u=dn[e];0===c||10===c?((1===e?b:y)(O(u,0)),u.length=0):u.push(c)}r+=s}return P[a>>2]=r,0},u:function(){}};!function(){function e(e){n.asm=e.exports,x=n.asm.F,U(),D=n.asm.G,X--,n.monitorRunDependencies&&n.monitorRunDependencies(X),0==X&&(null!==G&&(clearInterval(G),G=null),Q&&(e=Q,Q=null,e()))}function t(n){e(n.instance)}function a(e){return(g||!s&&!l||"function"!=typeof fetch||$("file://")?Promise.resolve().then((function(){return te()})):fetch(ee,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ee+"'";return e.arrayBuffer()})).catch((function(){return te()}))).then((function(e){return WebAssembly.instantiate(e,r)})).then(e,(function(e){y("failed to asynchronously prepare wasm: "+e),J(e)}))}var r={a:pn};if(X++,n.monitorRunDependencies&&n.monitorRunDependencies(X),n.instantiateWasm)try{return n.instantiateWasm(r,e)}catch(e){return y("Module.instantiateWasm callback failed with error: "+e),!1}(g||"function"!=typeof WebAssembly.instantiateStreaming||K()||$("file://")||"function"!=typeof fetch?a(t):fetch(ee,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,r).then(t,(function(e){return y("wasm streaming compile failed: "+e),y("falling back to ArrayBuffer instantiation"),a(t)}))}))).catch(i)}();var mn,vn=n.___wasm_call_ctors=function(){return(vn=n.___wasm_call_ctors=n.asm.H).apply(null,arguments)},gn=n._malloc=function(){return(gn=n._malloc=n.asm.I).apply(null,arguments)},bn=n._free=function(){return(bn=n._free=n.asm.J).apply(null,arguments)},yn=n.___getTypeName=function(){return(yn=n.___getTypeName=n.asm.K).apply(null,arguments)};function xn(){function e(){if(!mn&&(mn=!0,n.calledRun=!0,!j)){if(ae(q),ae(H),r(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;){var e=n.postRun.shift();Y.unshift(e)}ae(Y)}}if(!(0<X)){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)Z();ae(B),0<X||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e())}}if(n.___embind_register_native_and_builtin_types=function(){return(n.___embind_register_native_and_builtin_types=n.asm.L).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.M).apply(null,arguments)},Q=function e(){mn||xn(),mn||(Q=e)},n.run=xn,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();return xn(),e.ready});e.exports=r},9006:(e,n,t)=>{"use strict";var a={};t.r(a),t.d(a,{Controls:()=>Be,OptionsPanel:()=>De,encode:()=>He,extension:()=>Fe,getOptionsList:()=>qe,initControlState:()=>We,initOptionsState:()=>Ue,mimeType:()=>Re,name:()=>Te});var r={};t.r(r),t.d(r,{Controls:()=>en,OptionsPanel:()=>Ke,encode:()=>tn,extension:()=>Ge,getOptionsList:()=>nn,initControlState:()=>Je,initOptionsState:()=>$e,mimeType:()=>Xe,name:()=>Ze});var i={};t.r(i),t.d(i,{Controls:()=>fn,OptionsPanel:()=>dn,encode:()=>pn,extension:()=>sn,getOptionsList:()=>hn,initControlState:()=>cn,initOptionsState:()=>un,mimeType:()=>on,name:()=>rn});var o={};t.r(o),t.d(o,{Controls:()=>On,OptionsPanel:()=>Cn,Subsampling:()=>yn,encode:()=>Nn,extension:()=>bn,getOptionsList:()=>_n,initControlState:()=>jn,initOptionsState:()=>wn,mimeType:()=>gn,name:()=>vn});var s={};t.r(s),t.d(s,{Controls:()=>In,Csp:()=>An,OptionsPanel:()=>Mn,UVMode:()=>Pn,encode:()=>zn,extension:()=>En,getOptionsList:()=>Ln,initControlState:()=>Rn,initOptionsState:()=>Fn,mimeType:()=>kn,name:()=>Sn});var l=t(4637),c=t(7995),u=t(3036),d=t(4146),f=t(9496),h=t(4279);const p=new Map;async function m(e){const n=URL.createObjectURL(e);try{return await async function(e){const n=new Image;n.decoding="async",n.src=e;const t=new Promise(((e,t)=>{n.onload=()=>e(),n.onerror=()=>t(Error("Image loading error"))}));return n.decode&&await n.decode().catch((()=>null)),await t,n}(n)}finally{URL.revokeObjectURL(n)}}new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\xF4\xFF\x6F/,"image/webp2"],[/^\x00\x00\x00 ftypavif\x00\x00\x00\x00/,"image/avif"],[/^\xff\x0a/,"image/jxl"],[/^\x00\x00\x00\x0cJXL \x0d\x0a\x87\x0a/,"image/jxl"]]);class v{constructor(e,n){if(this.terminated=!1,this.queue=[],this.waiters=[],n<1)throw new Error("Worker count must be at least 1");this.workers=new Array(n),this.remotes=new Array(n);for(let t=0;t<n;t++){const n=e();this.workers[t]=n,this.remotes[t]=(0,h.Ud)(n)}}runOnEach(e){return Promise.all(this.remotes.map(e))}run(e){return new Promise((n=>this.addJob({task:e,resolve:n})))}join(){const{queue:e,remotes:n,workers:t,waiters:a}=this;return 0===e.length&&n.length===t.length?Promise.resolve():new Promise((e=>a.push(e)))}terminate(){this.terminated=!0,this.workers.forEach((e=>e.terminate())),this.waiters.forEach((e=>e()))}addJob(e){const n=this.remotes.pop();if(n)return this.runJob(n,e);this.queue.push(e)}async runJob(e,n){const{task:t,resolve:a}=n;a(await t(e));const r=this.queue.pop();if(r)return this.runJob(e,r);const{remotes:i,workers:o,waiters:s}=this;i.push(e),i.length===o.length&&s.splice(0,s.length).forEach((e=>e()))}}function g(){return new Worker(new URL(t.p+t.u(225),t.b))}class b{constructor(e,n){this.image=e,this.measureOptions=n,this.pool=new v(g,n.workerCount)}onProgress(){}async initialize(){await this.pool.runOnEach((e=>e.setImageToEncode(this.image)))}encode(e,n){return this.pool.run((t=>this.poll(t,e,n)))}terminate(){this.pool.terminate()}async poll(e,n,t){const{buffer:a,time:r}=await n.encode(t,e),i=new Blob([a],{type:n.mimeType}),o=await j(i,e);return this.onProgress(),{time:r,buffer:a,data:o,metrics:await this.measure(e,o)}}async measure(e,n){const{SSIM:t,PSNR:a,butteraugli:r}=this.measureOptions,i={};if(a&&(i.PSNR=await e.calcPSNR(n),this.onProgress()),t.enabled&&(i.SSIM=await e.calcSSIM(n,t.options),this.onProgress()),r.enabled){const[t,a]=await e.calcButteraugli(n,r.options);this.onProgress();const o=function(e,n,t){if(e.byteLength/n/t!=4)throw new Error("Buffer must be a 8-bit depth RGBA array");const a=document.createElement("canvas").getContext("2d");if(!a)throw new Error("Could not create canvas context");const r=a.createImageData(n,t);return r.data.set(new Uint8ClampedArray(e)),r}(a,n.width,n.height);i.butteraugli={source:t,heatMap:o}}return i}}async function y(e){const n="createImageBitmap"in self?await createImageBitmap(e):await m(e),t=document.createElement("canvas"),{width:a,height:r}=n;t.width=a,t.height=r;const i=t.getContext("2d");if(!i)throw new Error("Canvas not initialized");return i.drawImage(n,0,0),i.getImageData(0,0,a,r)}async function x(e){e=function(e){const n=(new DOMParser).parseFromString(e,"image/svg+xml"),t=n.documentElement;if(t.getAttribute("width")&&t.getAttribute("height"))return e;const a=t.getAttribute("viewBox");if(null===a)throw Error("SVG must have width/height or viewBox");const[,,r,i]=a.split(/\s+/);return t.setAttribute("width",r),t.setAttribute("height",i),(new XMLSerializer).serializeToString(n)}(e);const n=new Blob([e],{type:"image/svg+xml"});return function(e,n={}){const{width:t=e.width,height:a=e.height,sx:r=0,sy:i=0,sw:o=e.width,sh:s=e.height}=n,l=document.createElement("canvas");l.width=t,l.height=a;const c=l.getContext("2d");if(!c)throw new Error("Could not create canvas context");return c.drawImage(e,r,i,o,s,0,0,t,a),c.getImageData(0,0,t,a)}(await m(n))}async function j(e,n){const{type:t}=e;if("image/svg+xml"===t)return e.text().then(x);if(await function(e){if(!p.has(e)){const n=(async()=>{const n=document.createElement("picture"),t=document.createElement("img"),a=document.createElement("source");return a.srcset="data:,x",a.type=e,n.append(a,t),await 0,!!t.currentSrc})();p.set(e,n)}return p.get(e)}(t))return y(e);null!=n||(n=(0,h.Ud)(g()));const a=await e.arrayBuffer();switch(t){case"image/webp":return n.webpDecode(a);case"image/avif":return n.avifDecode(a);case"image/jxl":return n.jxlDecode(a);case"image/webp2":return n.webp2Decode(a);default:return y(e)}}var w=t(1626),C=t(4685),O=t(8481),_=t(2794),N=t(9573),S=t(8877),k=t(7721),E=t(5185);function P(){return(P=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var A=f.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),V=f.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"});const T=function(e){return f.createElement("svg",P({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),A,V)};function R(){return(R=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var F=f.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),M=f.createElement("path",{d:"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"});const I=function(e){return f.createElement("svg",R({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),F,M)};function L(){return(L=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var z=f.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),W=f.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"});const U=function(e){return f.createElement("svg",L({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),z,W)};function D(){return(D=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var B=f.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),q=f.createElement("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"});const H=function(e){return f.createElement("svg",D({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),B,q)},Y=()=>{},Z=["","K","M","G","T","P","E","Z","Y"];function X(e,n=1024){const t=Math.abs(e);if(0===t)return`${e.toFixed(2)} B`;const a=~~(Math.log2(t)/Math.log2(n));return`${(e/n**a).toFixed(2)} ${Z[a]}B`}function G(e){const{className:n,type:t,Icon:a,IconChecked:r,name:i,value:o,checked:s,disabled:c,onClick:u,onChange:d=Y,onValueChange:f=Y,children:h}=e;return(0,l.jsxs)("label",Object.assign({className:(0,w.Z)("_2Ov17",n),onClick:u},{children:[(0,l.jsx)("input",{type:t,className:"_2IoHf",name:i,value:o,disabled:c,checked:s,onChange:function(e){d(e),f(e.currentTarget.checked)}},void 0),(0,l.jsx)("span",Object.assign({className:"_2H-Mw"},{children:s?(0,l.jsx)(r,{},void 0):(0,l.jsx)(a,{},void 0)}),void 0),h&&(0,l.jsx)("span",Object.assign({className:"_11H37"},{children:h}),void 0)]}),void 0)}function Q(e){const{className:n,name:t,value:a,min:r,max:i,step:o,disabled:s,onClick:c,onChange:u=Y,onValueChange:d=Y}=e,f={"--value-percent":(a-r)/(i-r)*100+"%"};return(0,l.jsxs)("div",Object.assign({className:(0,w.Z)("_2DhF4",n),style:f},{children:[(0,l.jsx)("input",{type:"range",className:"_3dzMs",name:t,disabled:s,value:a,min:r,max:i,step:o,onClick:c,onChange:function(e){u(e),d(e.currentTarget.valueAsNumber)}},void 0),(0,l.jsx)("div",Object.assign({className:"_2b567"},{children:(0,l.jsx)("div",{className:"_26ZKf"},void 0)}),void 0)]}),void 0)}const J={text:"_3asye",active:"_1lox2",button:"_2wLkD",outline:"_1UDsQ _2wLkD",busy:"_3XmXG"};function $(e){const{type:n="button",href:t,active:a,title:r,className:i,disabled:o,onClick:s,children:c}=e,u=(0,w.Z)(J[n],i,{[J.active]:a}),d=t?"a":"button",f=t?void 0:"button";return(0,l.jsx)(d,Object.assign({className:u,href:t,title:r,disabled:o,type:f,onClick:s},{children:c}),void 0)}const K="_1H0a4";function ee(e){const{name:n,className:t,disabled:a,value:r,min:i=0,max:o=Number.MAX_SAFE_INTEGER,step:s=1,onValueChange:c=Y}=e;function u(e){let n=0;const t=Math.pow(10,function(e){const n=e.toString(),t=n.indexOf(".")+1;return t||n.length-t}(s));function a(n){return n+=e,n=Math.min(Math.max(n,i),o),Math.round(n*t)/t}function l(e){const t=a(e);c(t),n=window.setTimeout((()=>l(t)),50)}const u=a(r);c(u),n=window.setTimeout((()=>l(u)),400),document.addEventListener("mouseup",(function e(){clearTimeout(n),document.removeEventListener("mouseup",e)}))}return(0,l.jsxs)("div",Object.assign({className:(0,w.Z)("_2dfjc",t)},{children:[(0,l.jsx)("input",{type:"number",className:"xI_9P",disabled:a,name:n,min:i,max:o,step:s,value:r,onChange:e=>c(e.currentTarget.valueAsNumber)},void 0),(0,l.jsx)("button",{type:"button",className:(0,w.Z)(K,"dBnP0"),tabIndex:-1,disabled:a,onMouseDown:()=>u(s)},void 0),(0,l.jsx)("button",{type:"button",className:K,tabIndex:-1,disabled:a,onMouseDown:()=>u(-s)},void 0)]}),void 0)}const ne="_3_cLi",te="_1p1yr";function ae(){const e=document.body.querySelectorAll("._3_cLi"),n=e[e.length-2];if(n)return n.classList.add(te),()=>n.classList.remove(te)}function re(e){const{className:n,name:t,onClose:a=Y,children:r}=e;return(0,f.useEffect)((function(){function e(e){"Escape"===e.key&&(a(),e.stopImmediatePropagation())}return window.addEventListener("keyup",e),()=>window.removeEventListener("keyup",e)}),[a]),(0,f.useLayoutEffect)(ae,[]),(0,c.createPortal)((0,l.jsx)("div",Object.assign({className:ne},{children:(0,l.jsx)("div",Object.assign({role:"dialog","aria-label":t,className:(0,w.Z)(n,"_1Vq87")},{children:r}),void 0)}),void 0),document.body)}function ie(e){const{state:n,className:t,children:a,onChange:r}=e;function i(e,t){const a=n.x+e,i=n.y+t;r({scale:n.scale,x:a,y:i})}return(0,l.jsx)("div",Object.assign({style:{touchAction:"none"},className:t,onWheel:function(e){const{ctrlKey:t,deltaMode:a,clientX:i,clientY:o}=e;let{deltaY:s}=e;e.preventDefault(),1===a&&(s*=15);const l=1-s/(t?100:300),c=e.currentTarget.firstElementChild.getBoundingClientRect(),u=(c.left+c.width/2-i)*(l-1),d=(c.top+c.height/2-o)*(l-1);r({x:n.x+u,y:n.y+d,scale:n.scale*l})},onTouchStart:function(e){!function(e,n){const t=e.touches[0];function a(e){const a=e.touches[0];n(a.pageX-t.pageX,a.pageY-t.pageY)}document.addEventListener("touchmove",a),document.addEventListener("touchend",(function e(n){n.preventDefault(),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",e)}))}(e.nativeEvent,i)},onMouseDown:function(e){0===e.button&&function(e,n){const t=e.pageX,a=e.pageY;function r(e){n(e.pageX-t,e.pageY-a)}document.addEventListener("mousemove",r),document.addEventListener("mouseup",(function e(n){n.preventDefault(),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",e)}))}(e.nativeEvent,i)}},{children:a}),void 0)}var oe=t(693);function se(e){return(0,l.jsxs)("div",Object.assign({className:"_3Neg9"},{children:[(0,l.jsx)("select",Object.assign({},e,{className:"_2rF3V"}),void 0),(0,l.jsx)(oe.Z,{className:"_2Arv_"},void 0)]}),void 0)}function le(e){const{className:n,name:t,checked:a,disabled:r,onClick:i,onChange:o=Y,onValueChange:s=Y}=e,c=(0,w.Z)("_23L3Q",n,{_38B3L:a});return(0,l.jsx)("label",Object.assign({className:c},{children:(0,l.jsx)("input",{type:"checkbox",className:"rBLkp",disabled:r,checked:a,name:t,onClick:i,onChange:function(e){o(e),s(e.currentTarget.checked)}},void 0)}),void 0)}function ce(e){const{active:n,className:t,onFocus:a,children:r}=e,i=(0,w.Z)("_7lvOB",t,{_31kUg:n});return(0,l.jsx)("div",Object.assign({className:i,onClick:a},{children:r}),void 0)}function ue(e){return G({...e,type:"checkbox",Icon:T,IconChecked:I})}function de(e){return G({...e,type:"radio",Icon:U,IconChecked:H})}function fe(e){const{description:n,url:t,icon:a,onClick:r}=e,[i,o]=(0,f.useState)(!1);return(0,l.jsxs)("button",Object.assign({className:"_2Z_sH",onClick:async function(){if(!i){o(!0);try{await r(t)}finally{o(!1)}}}},{children:[(0,l.jsx)("img",{src:a,alt:"icon",className:"ZflhA"},void 0),i&&(0,l.jsx)("div",{className:"_2BAvs"},void 0),(0,l.jsx)("span",Object.assign({className:"_3fIXD"},{children:n}),void 0)]}),t)}const he="_3SDL7",pe=[{description:"Large photo (2.8MB)",url:O,icon:_},{description:"Artwork (408KB)",url:N,icon:S},{description:"Colorful text (68KB)",url:E,icon:k}],me=new AbortController;function ve(e){const{onCancel:n,onFileChange:t}=e,a=function(){const[e,n]=(0,f.useState)(!1),t=(0,f.useRef)(0);return{isInArea:e,enter:function(){n(++t.current>0)},leave:function(){n(--t.current>0)},reset:function(){t.current=0,n(!1)}}}(),r=(0,f.useRef)(me),[i,o]=(0,f.useState)("");function s(e){j(e).then((n=>t(e,n))).catch((()=>o("Can not decode file as image.")))}async function c(e){const n=new AbortController;r.current.abort(),r.current=n;const{signal:t}=n;try{s(await async function(e,n){const t=await fetch(e,{signal:n}),a=await t.blob(),r=/[^;]*/.exec(a.type)[0],i=new URL(e).pathname.split("/").pop()||"image",o=t.headers.get("last-modified"),s=o?new Date(o).getTime():void 0;return new File([a],i,{type:r,lastModified:s})}(e,t))}catch(e){if("AbortError"!==e.name)throw e}}const u=pe.map((e=>(0,f.createElement)(fe,Object.assign({},e,{key:e.url,onClick:c}))));return(0,l.jsxs)(re,Object.assign({onClose:n},{children:[(0,l.jsxs)("div",Object.assign({className:"dialog-content"},{children:[(0,l.jsxs)("label",Object.assign({className:(0,w.Z)("_3uHix",{_2jvwR:a.isInArea}),tabIndex:0,onDragEnter:a.enter,onDragOver:e=>e.preventDefault(),onDrop:function(e){e.preventDefault(),a.reset(),r.current.abort();const{items:n}=e.dataTransfer,t=n[0].getAsFile();t?s(t):o("The dropped item is not a file")},onDragLeave:a.leave},{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",Object.assign({className:"wYvdR"},{children:(0,l.jsx)(C.Z,{},void 0)}),void 0),(0,l.jsx)("span",Object.assign({className:he},{children:"Drag & drop"}),void 0)]},void 0),(0,l.jsx)("div",Object.assign({className:he},{children:"Or select an image"}),void 0),(0,l.jsx)("input",{className:"_3-brh",name:"file",type:"file",accept:"image/*",onChange:function(e){r.current.abort();const{files:n}=e.currentTarget;(null==n?void 0:n.length)&&s(n[0])}},void 0)]}),void 0),(0,l.jsx)("span",Object.assign({className:"_2Sr67"},{children:"Or try one of these:"}),void 0),(0,l.jsx)("div",Object.assign({className:"_3BC6E"},{children:u}),void 0)]}),void 0),(0,l.jsxs)("div",Object.assign({className:"dialog-actions"},{children:[(0,l.jsx)("span",Object.assign({className:"Qed9H"},{children:i}),void 0),(0,l.jsx)($,Object.assign({className:"second",onClick:n},{children:"Back"}),void 0)]}),void 0)]}),void 0)}function ge(e){const{file:n}=e,{width:t,height:a,data:r}=e.image,i=(n.size/r.byteLength*100).toFixed(2);return(0,l.jsxs)("div",Object.assign({className:"dialog-content",role:"tabpanel"},{children:[(0,l.jsx)("canvas",{className:"WKrzW","aria-label":"Preview",ref:function(n){if(!n)return;const t=n.getContext("2d");null==t||t.putImageData(e.image,0,0)},width:t,height:a},void 0),(0,l.jsxs)("dl",Object.assign({className:"lL9Er"},{children:[(0,l.jsx)("dt",{children:"File name:"},void 0),(0,l.jsx)("dd",{children:n.name},void 0),(0,l.jsx)("dt",{children:"Type:"},void 0),(0,l.jsx)("dd",{children:n.type},void 0),(0,l.jsx)("dt",{children:"Resolution:"},void 0),(0,l.jsxs)("dd",{children:[t," x ",a]},void 0),(0,l.jsx)("dt",{children:"Raw size:"},void 0),(0,l.jsx)("dd",{children:X(r.byteLength)},void 0),(0,l.jsx)("dt",{children:"File size (Ratio %):"},void 0),(0,l.jsxs)("dd",{children:[X(n.size)," (",i,"%)"]},void 0)]}),void 0)]}),void 0)}var be=t(8059);t(9650);const ye={hfAsymmetry:1,goodQualitySeek:1.5,badQualitySeek:.5},xe={form:"_3_OKa dialog-content",field:"_2vX3s",inlineLabel:"_2MSGh",label:"ba7J1"};function je(e){return e||{version:1,workerCount:navigator.hardwareConcurrency,time:!0,PSNR:!0,SSIM:{enabled:!1,options:be.getOptions()},butteraugli:{enabled:!1,options:ye}}}function we(e){const{value:n,onChange:t}=e;function a(e,a){const r={...n.options,[e]:a};t({...n,options:r})}const r=Object.entries(n.options).map((([e,n])=>(0,l.jsxs)("label",Object.assign({className:xe.field},{children:[(0,l.jsx)("span",Object.assign({className:xe.label},{children:e}),void 0),(0,l.jsx)(ee,{className:xe.value,name:e,min:0,max:2,step:.1,value:n,onValueChange:n=>a(e,n)},void 0)]}),e)));return(0,l.jsxs)("div",{children:[(0,l.jsx)(ue,Object.assign({checked:n.enabled,name:"butteraugli",onValueChange:e=>t({...n,enabled:e})},{children:"Calculate Butteraugli"}),void 0),(0,l.jsx)("fieldset",Object.assign({className:"subfields"},{children:n.enabled&&r}),void 0)]},void 0)}function Ce(e){const{value:n,onChange:t}=e,{workerCount:a,time:r,SSIM:i,PSNR:o,butteraugli:s}=n;function c(e){const{name:a,checked:r}=e.currentTarget;t({...n,[a]:r})}return(0,l.jsxs)("form",Object.assign({className:xe.form,role:"tabpanel"},{children:[(0,l.jsxs)("label",{children:[(0,l.jsx)("span",Object.assign({className:xe.inlineLabel},{children:"Worker count:"}),void 0),(0,l.jsx)(ee,{value:a,min:1,step:1,onValueChange:function(e){t({...n,workerCount:e})}},void 0)]},void 0),(0,l.jsx)(ue,Object.assign({checked:r,name:"time",onChange:c},{children:"Encode time (Not very accurate)"}),void 0),(0,l.jsx)(ue,Object.assign({checked:o,name:"PSNR",onChange:c},{children:"Calculate PSNR"}),void 0),(0,l.jsx)(ue,Object.assign({checked:i.enabled,name:"SSIM",onChange:c},{children:"Calculate SSIM"}),void 0),(0,l.jsx)(we,{value:s,onChange:function(e){t({...n,butteraugli:e})}},void 0)]}),void 0)}function Oe(e){const{id:n,label:t,defaultValue:a}=e;return{id:n,initControlValue:function(){return{value:!1,labels:["false","true"]}},newOptionState:function(){return[Boolean(a),void 0]},Controller:function(e){const{value:n,onChange:a}=e;return(0,l.jsxs)(ce,Object.assign({},e,{className:"_1JOas"},{children:[t,(0,l.jsx)(le,{checked:n,onValueChange:a,onClick:e=>e.stopPropagation()},void 0)]}),void 0)},OptionField:function(e){const{isVariable:a,value:r,onValueChange:i,onVariabilityChange:o}=e;return(0,l.jsxs)("fieldset",Object.assign({className:"_1Whgl _3be6o"},{children:[(0,l.jsx)(ue,Object.assign({className:"_3SupV",checked:a,onValueChange:o},{children:t}),void 0),a?(0,l.jsx)("strong",{children:"OFF & ON"},void 0):(0,l.jsx)(le,{name:n,checked:r,onValueChange:i},void 0)]}),void 0)},populate:function(e,t){t[n]=e},generate:function(e,t){return[{...t,[n]:!1},{...t,[n]:!0}]}}}const _e="_2ds9S";function Ne(e){const{id:n,label:t,enumObject:a,defaultValue:r}=e;return{id:n,initControlValue:function(e){return{value:e[0],labels:e}},newOptionState:function(){return[r,[r]]},Controller:function(e){const{value:a,range:r,onChange:i}=e;function o(e){i(e.currentTarget.name)}const s=r.map((e=>(0,l.jsx)(de,Object.assign({className:_e,checked:e===a,name:n,onChange:o},{children:e}),e)));return(0,l.jsxs)(ce,Object.assign({},e,{children:[t,(0,l.jsx)("div",Object.assign({className:"_3gET2"},{children:s}),void 0)]}),void 0)},OptionField:function(e){const{isVariable:r,value:i,range:o,onValueChange:s,onRangeChange:c,onVariabilityChange:u}=e;function d(e){const{checked:n,name:t}=e.currentTarget;let a=[...o];n?a.push(t):a=o.filter((e=>e!==t)),a.length>0&&c(a)}function f(e){s(e.currentTarget.value)}let h;return h=r?Object.keys(a).map((e=>(0,l.jsx)(ue,Object.assign({className:_e,name:e,checked:o.includes(e),onChange:d},{children:e}),e))):Object.keys(a).map((e=>(0,l.jsx)(de,Object.assign({className:_e,name:n,value:e,checked:i===e,onChange:f},{children:e}),e))),(0,l.jsxs)("fieldset",Object.assign({className:"_2g87T"},{children:[(0,l.jsx)(ue,Object.assign({className:"_3Cf8v",checked:r,onValueChange:u},{children:t}),void 0),(0,l.jsx)("div",Object.assign({className:"_38c4A"},{children:h}),void 0)]}),void 0)},populate:function(e,t){t[n]=a[e]},generate:function(e,t){return e.map((e=>({...t,[n]:a[e]})))}}}const Se="_1DFIs",ke="_2hMcD",Ee="_1QAox";function Pe(e){const{id:n,label:t,min:a,max:r,step:i,offset:o=0,defaultValue:s}=e;function c(e){const{min:n,max:t,step:a}=e;return new Array(Math.ceil((t+1-n)/a)).fill(n).map(((e,n)=>e+o+n*a))}function u(e){const{value:t,onValueChange:o}=e;return(0,l.jsx)(Q,{className:Ee,name:n,value:t,min:a,max:r,step:i,onValueChange:o},void 0)}function d(n){const{range:t,onRangeChange:a}=n,r=n=>{const{name:r,min:i,max:o,step:s}={...e,...n};return(0,l.jsxs)("label",Object.assign({className:"_1NEr4"},{children:[(0,l.jsx)("span",{children:r},void 0),(0,l.jsx)(ee,{className:"_2drmu",name:r,value:t[r],min:i,max:o,step:s,onValueChange:e=>function(e,n){a({...t,[e]:n})}(r,e)},void 0)]}),void 0)};return(0,l.jsxs)("div",Object.assign({className:Ee},{children:[(0,l.jsx)(r,{name:"min",max:t.max},void 0),(0,l.jsx)(r,{name:"max",min:t.min},void 0),(0,l.jsx)(r,{name:"step",min:i},void 0)]}),void 0)}return{id:n,initControlValue:function(e){const n=c(e).map((e=>e.toString()));return{value:e.min,labels:n}},newOptionState:function(){return[s,{min:a,max:r,step:i}]},Controller:function(e){const{value:a,range:r,onChange:i}=e,{min:o,max:s,step:c}=r;return(0,l.jsxs)(ce,Object.assign({},e,{children:[(0,l.jsxs)("div",Object.assign({className:Se},{children:[(0,l.jsx)("span",Object.assign({className:ke},{children:t}),void 0),a]}),void 0),(0,l.jsx)(Q,{name:n,value:a,min:o,max:s,step:c,onClick:e=>e.stopPropagation(),onValueChange:i},void 0)]}),void 0)},OptionField:function(e){const{isVariable:n,value:a,onVariabilityChange:r}=e;return(0,l.jsxs)("fieldset",Object.assign({className:"_2eY19"},{children:[(0,l.jsxs)("div",Object.assign({className:Se},{children:[(0,l.jsx)(ue,Object.assign({className:ke,checked:n,onValueChange:r},{children:t}),void 0),!n&&a]}),void 0),n?(0,l.jsx)(d,Object.assign({},e),void 0):(0,l.jsx)(u,Object.assign({},e),void 0)]}),void 0)},populate:function(e,t){t[n]=o+e},generate:function(e,t){return c(e).map((e=>({...t,[n]:e})))}}}function Ae(e,n){const{varNames:t,values:a,ranges:r}=n;return e.reduce((function(e,n){return e.map((e=>t.includes(n.id)?n.generate(r[n.id],e):(n.populate(a[n.id],e),[e]))).reduce(((e,n)=>e.concat(n)),[])}),[{}])}function Ve(e,n){return{...e,...n}}const Te="MozJPEG",Re="image/jpeg",Fe="jpg",Me={GRAYSCALE:1,RGB:2,YCbCr:3},Ie={"JPEG Annex K":0,Flat:1,"MSSIM-tuned Kodak":2,ImageMagick:3,"PSNR-HVS-M-tuned Kodak":4,"Klein et al":5,"Watson et al":6,"Ahumada et al":7,"Peterson et al":8},Le={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:Me.YCbCr,quant_table:Ie.ImageMagick,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75},ze=[Pe({id:"quality",label:"Quality (-q)",min:0,max:100,step:1,defaultValue:Le.quality}),Ne({id:"color_space",label:"Channels",enumObject:Me,defaultValue:"YCbCr"}),Ne({id:"quant_table",label:"Quantization",enumObject:Ie,defaultValue:"ImageMagick"}),Oe({id:"arithmetic",label:"Arithmetic",defaultValue:Le.arithmetic}),Oe({id:"auto_subsample",label:"Auto subsample chroma",defaultValue:Le.auto_subsample}),Oe({id:"separate_chroma_quality",label:"Separate chroma quality",defaultValue:Le.separate_chroma_quality}),Pe({id:"chroma_quality",label:"Chroma quality",min:0,max:100,step:1,defaultValue:Le.chroma_quality}),Pe({id:"smoothing",label:"Smoothing",min:0,max:100,step:1,defaultValue:Le.smoothing}),Oe({id:"baseline",label:"Pointless spec compliance",defaultValue:Le.baseline}),Oe({id:"progressive",label:"Progressive",defaultValue:Le.progressive}),Oe({id:"optimize_coding",label:"Optimize Huffman table",defaultValue:Le.optimize_coding}),Oe({id:"trellis_multipass",label:"Trellis multipass",defaultValue:Le.trellis_multipass}),Oe({id:"trellis_opt_zero",label:"Optimize zero block runs",defaultValue:Le.trellis_opt_zero}),Oe({id:"trellis_opt_table",label:"Optimize after trellis quantization",defaultValue:Le.trellis_opt_table}),Pe({id:"trellis_loops",label:"Trellis quantization passes",min:0,max:50,step:1,defaultValue:Le.trellis_loops})];function We(e){const{varNames:n,ranges:t,values:a}=e,r={};for(const e of ze){if(!n.includes(e.id))continue;const i=e.initControlValue(t[e.id]);a[e.id]=i.value,r[e.id]=i.labels}return{values:a,labels:r}}function Ue(e){if(e)return e;const n={},t={};for(const e of ze){const[a,r]=e.newOptionState();n[e.id]=a,t[e.id]=r}return{varNames:[],values:n,ranges:t}}function De(e){const{state:n,onChange:t}=e,{varNames:a,values:r,ranges:i}=n,o=ze.map((({id:e,OptionField:o})=>(0,l.jsx)(o,{isVariable:a.includes(e),value:r[e],range:i[e],onValueChange:a=>function(e,a){t({...n,values:{...r,[e]:a}})}(e,a),onRangeChange:a=>function(e,a){t({...n,ranges:{...i,[e]:a}})}(e,a),onVariabilityChange:a=>function(e,a){let{varNames:r}=n;a?r.push(e):r=r.filter((n=>n!==e)),t({...n,varNames:r})}(e,a)},e)));return(0,l.jsx)(l.Fragment,{children:o},void 0)}function Be(e){const{state:n,variableName:t,onChange:a,onVariableChange:r}=e,{varNames:i,values:o,ranges:s}=n,c=ze.filter((e=>i.includes(e.id))).map((({id:e,Controller:n})=>(0,l.jsx)(n,{active:e===t,value:o[e],range:s[e],onFocus:()=>r(e),onChange:function(n){r(e),a({...o,[e]:n})}},e)));return(0,l.jsx)(l.Fragment,{children:c},void 0)}function qe(e){return Ae(ze,e)}function He(e,n){return n.mozjpegEncode(Ve(Le,e))}const Ye={speed:4,quality:75,progressive:!1,epf:-1,nearLossless:0,lossyPalette:!1},Ze="JPEG XL",Xe="image/jxl",Ge="jxl",Qe=[Pe({id:"quality",label:"Quality",min:0,max:100,step:.1,defaultValue:Ye.quality}),Oe({id:"lossyPalette",label:"Slight loss",defaultValue:Ye.lossyPalette}),Oe({id:"progressive",label:"Progressive",defaultValue:Ye.progressive}),Pe({id:"speed",label:"Speed",min:0,max:6,step:1,defaultValue:Ye.speed}),Pe({id:"epf",label:"Edge preserving filter",min:-1,max:6,step:1,defaultValue:Ye.epf})];function Je(e){const{varNames:n,ranges:t,values:a}=e,r={};for(const e of Qe){if(!n.includes(e.id))continue;const i=e.initControlValue(t[e.id]);a[e.id]=i.value,r[e.id]=i.labels}return{values:a,labels:r}}function $e(e){if(e)return e;const n={},t={};for(const e of Qe){const[a,r]=e.newOptionState();n[e.id]=a,t[e.id]=r}return{varNames:[],values:n,ranges:t}}function Ke(e){const{state:n,onChange:t}=e,{varNames:a,values:r,ranges:i}=n,o=Qe.map((({id:e,OptionField:o})=>(0,l.jsx)(o,{isVariable:a.includes(e),value:r[e],range:i[e],onValueChange:a=>function(e,a){t({...n,values:{...r,[e]:a}})}(e,a),onRangeChange:a=>function(e,a){t({...n,ranges:{...i,[e]:a}})}(e,a),onVariabilityChange:a=>function(e,a){let{varNames:r}=n;a?r.push(e):r=r.filter((n=>n!==e)),t({...n,varNames:r})}(e,a)},e)));return(0,l.jsx)(l.Fragment,{children:o},void 0)}function en(e){const{state:n,variableName:t,onChange:a,onVariableChange:r}=e,{varNames:i,values:o,ranges:s}=n,c=Qe.filter((e=>i.includes(e.id))).map((({id:e,Controller:n})=>(0,l.jsx)(n,{active:e===t,value:o[e],range:s[e],onFocus:()=>r(e),onChange:function(n){r(e),a({...o,[e]:n})}},e)));return(0,l.jsx)(l.Fragment,{children:c},void 0)}function nn(e){return Ae(Qe,e)}function tn(e,n){return n.jxlEncode(Ve(Ye,e))}const an={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0},rn="WebP",on="image/webp",sn="webp",ln=[Oe({id:"lossless",label:"lossless",defaultValue:an.lossless}),Pe({id:"quality",label:"Quality (-q)",min:0,max:100,step:1,defaultValue:an.quality}),Pe({id:"near_lossless",label:"Near lossless (-near_lossless)",min:0,max:100,step:1,defaultValue:an.near_lossless}),Pe({id:"method",label:"Method (-m)",min:0,max:6,step:1,defaultValue:an.method}),function(e){const{enumObject:n}=e,t=Ne(e);return t.generate=(e,n)=>e.map((e=>{const a={...n};return t.populate(e,a),a})),t.populate=(e,t)=>{Object.entries(n[e]).forEach((([e,n])=>t[e]="function"==typeof n?n(t[e]):n))},t}({id:"preset",label:"Preset (-preset)",enumObject:{default:{},photo:{sns_strength:80,filter_sharpness:3,filter_strength:30,preprocessing:e=>2|e},picture:{sns_strength:80,filter_sharpness:4,filter_strength:35,preprocessing:e=>-3&e},drawing:{sns_strength:25,filter_sharpness:6,filter_strength:10},icon:{sns_strength:25,filter_strength:10,preprocessing:e=>-3&e},text:{sns_strength:0,filter_strength:0,segments:2,preprocessing:e=>-3&e}},defaultValue:"default"}),Pe({id:"sns_strength",label:"Spatial noise shaping (-sns)",min:0,max:100,step:1,defaultValue:an.sns_strength}),Oe({id:"filter_type",label:"User strong filter (-strong)",defaultValue:an.filter_type}),Oe({id:"autofilter",label:"Auto adjust filter strength (-af)",defaultValue:an.autofilter}),Pe({id:"filter_strength",label:"Filter strength (-f)",min:0,max:100,step:1,defaultValue:an.filter_strength}),Pe({id:"filter_sharpness",label:"Filter sharpness (-sharpness)",min:0,max:7,step:1,defaultValue:an.filter_sharpness}),Oe({id:"use_sharp_yuv",label:"Sharp YUV",defaultValue:an.use_sharp_yuv}),Ne({id:"image_hint",label:"Hint (-hint)",enumObject:{Default:0,Picture:1,Photo:2,Graph:3},defaultValue:"Default"})];function cn(e){const{varNames:n,ranges:t,values:a}=e,r={};for(const e of ln){if(!n.includes(e.id))continue;const i=e.initControlValue(t[e.id]);a[e.id]=i.value,r[e.id]=i.labels}return{values:a,labels:r}}function un(e){if(e)return e;const n={},t={};for(const e of ln){const[a,r]=e.newOptionState();n[e.id]=a,t[e.id]=r}return t.quality.step=5,{varNames:["quality"],values:n,ranges:t}}function dn(e){const{state:n,onChange:t}=e,{varNames:a,values:r,ranges:i}=n,o=ln.map((({id:e,OptionField:o})=>(0,l.jsx)(o,{isVariable:a.includes(e),value:r[e],range:i[e],onValueChange:a=>function(e,a){t({...n,values:{...r,[e]:a}})}(e,a),onRangeChange:a=>function(e,a){t({...n,ranges:{...i,[e]:a}})}(e,a),onVariabilityChange:a=>function(e,a){let{varNames:r}=n;a?r.push(e):r=r.filter((n=>n!==e)),t({...n,varNames:r})}(e,a)},e)));return(0,l.jsx)(l.Fragment,{children:o},void 0)}function fn(e){const{state:n,variableName:t,onChange:a,onVariableChange:r}=e,{varNames:i,values:o,ranges:s}=n,c=ln.filter((e=>i.includes(e.id))).map((({id:e,Controller:n})=>(0,l.jsx)(n,{active:e===t,value:o[e],range:s[e],onFocus:()=>r(e),onChange:function(n){r(e),a({...o,[e]:n})}},e)));return(0,l.jsx)(l.Fragment,{children:c},void 0)}function hn(e){return Ae(ln,e)}function pn(e,n){return n.webpEncode(Ve(an,e))}const mn={cqLevel:33,minQuantizerAlpha:0,tileColsLog2:0,tileRowsLog2:0,speed:8,subsample:1,chromaDeltaQ:!1,sharpness:0,targetSsim:!1},vn="AVIF",gn="image/avif",bn="avif",yn={YUV400:0,YUV420:1,YUV422:2,YUV444:3},xn=[Pe({id:"minQuantizer",label:"Min quality",min:0,max:63,step:1,defaultValue:mn.minQuantizer}),Pe({id:"maxQuantizer",label:"Max quality",min:0,max:63,step:1,defaultValue:mn.maxQuantizer}),Pe({id:"minQuantizerAlpha",label:"Min alpha quality",min:0,max:63,step:1,defaultValue:mn.minQuantizerAlpha}),Pe({id:"maxQuantizerAlpha",label:"Max alpha quality",min:0,max:63,step:1,defaultValue:mn.maxQuantizerAlpha}),Pe({id:"tileRowsLog2",label:"Log2 of tile rows",min:0,max:6,step:1,defaultValue:mn.tileRowsLog2}),Pe({id:"tileColsLog2",label:"Log2 of tile cols",min:0,max:6,step:1,defaultValue:mn.tileColsLog2}),Pe({id:"speed",label:"Speed",min:0,max:10,step:8,defaultValue:mn.speed}),Ne({id:"subsample",label:"Subsample",enumObject:yn,defaultValue:"YUV420"})];function jn(e){const{varNames:n,ranges:t,values:a}=e,r={};for(const e of xn){if(!n.includes(e.id))continue;const i=e.initControlValue(t[e.id]);a[e.id]=i.value,r[e.id]=i.labels}return{values:a,labels:r}}function wn(e){if(e)return e;const n={},t={};for(const e of xn){const[a,r]=e.newOptionState();n[e.id]=a,t[e.id]=r}return{varNames:[],values:n,ranges:t}}function Cn(e){const{state:n,onChange:t}=e,{varNames:a,values:r,ranges:i}=n,o=xn.map((({id:e,OptionField:o})=>(0,l.jsx)(o,{isVariable:a.includes(e),value:r[e],range:i[e],onValueChange:a=>function(e,a){t({...n,values:{...r,[e]:a}})}(e,a),onRangeChange:a=>function(e,a){t({...n,ranges:{...i,[e]:a}})}(e,a),onVariabilityChange:a=>function(e,a){let{varNames:r}=n;a?r.push(e):r=r.filter((n=>n!==e)),t({...n,varNames:r})}(e,a)},e)));return(0,l.jsx)(l.Fragment,{children:o},void 0)}function On(e){const{state:n,variableName:t,onChange:a,onVariableChange:r}=e,{varNames:i,values:o,ranges:s}=n,c=xn.filter((e=>i.includes(e.id))).map((({id:e,Controller:n})=>(0,l.jsx)(n,{active:e===t,value:o[e],range:s[e],onFocus:()=>r(e),onChange:function(n){r(e),a({...o,[e]:n})}},e)));return(0,l.jsx)(l.Fragment,{children:c},void 0)}function _n(e){return Ae(xn,e)}function Nn(e,n){return n.avifEncode({...mn,...e})}const Sn="WebP v2",kn="image/webp2",En="wp2",Pn={Adapt:0,420:1,444:2,Auto:3},An={YCoCg:0,YCbCr:1,Custom:2,YIQ:3},Vn={quality:75,alpha_quality:75,effort:5,pass:1,sns:50,uv_mode:Pn.Adapt,csp_type:An.YCoCg,error_diffusion:0,use_random_matrix:!1},Tn=[Pe({id:"quality",label:"Quality",min:0,max:95,step:.1,defaultValue:Vn.quality}),Pe({id:"alpha_quality",label:"Alpha Quality",min:0,max:95,step:.1,defaultValue:Vn.alpha_quality}),Pe({id:"effort",label:"Effort",min:0,max:9,step:1,defaultValue:Vn.effort}),Pe({id:"pass",label:"Passes",min:0,max:9,step:1,defaultValue:Vn.pass}),Pe({id:"sns",label:"Spatial noise shaping",min:0,max:100,step:1,defaultValue:Vn.sns}),Pe({id:"error_diffusion",label:"Error diffusion",min:0,max:100,step:1,defaultValue:Vn.error_diffusion}),Ne({id:"uv_mode",label:"UVMode",enumObject:Pn,defaultValue:"Adapt"}),Ne({id:"csp_type",label:"Color space",enumObject:An,defaultValue:"YCoCg"}),Oe({id:"use_random_matrix",label:"Random matrix",defaultValue:Vn.use_random_matrix})];function Rn(e){const{varNames:n,ranges:t,values:a}=e,r={};for(const e of Tn){if(!n.includes(e.id))continue;const i=e.initControlValue(t[e.id]);a[e.id]=i.value,r[e.id]=i.labels}return{values:a,labels:r}}function Fn(e){if(e)return e;const n={},t={};for(const e of Tn){const[a,r]=e.newOptionState();n[e.id]=a,t[e.id]=r}return{varNames:[],values:n,ranges:t}}function Mn(e){const{state:n,onChange:t}=e,{varNames:a,values:r,ranges:i}=n,o=Tn.map((({id:e,OptionField:o})=>(0,l.jsx)(o,{isVariable:a.includes(e),value:r[e],range:i[e],onValueChange:a=>function(e,a){t({...n,values:{...r,[e]:a}})}(e,a),onRangeChange:a=>function(e,a){t({...n,ranges:{...i,[e]:a}})}(e,a),onVariabilityChange:a=>function(e,a){let{varNames:r}=n;a?r.push(e):r=r.filter((n=>n!==e)),t({...n,varNames:r})}(e,a)},e)));return(0,l.jsx)(l.Fragment,{children:o},void 0)}function In(e){const{state:n,variableName:t,onChange:a,onVariableChange:r}=e,{varNames:i,values:o,ranges:s}=n,c=Tn.filter((e=>i.includes(e.id))).map((({id:e,Controller:n})=>(0,l.jsx)(n,{active:e===t,value:o[e],range:s[e],onFocus:()=>r(e),onChange:function(n){r(e),a({...o,[e]:n})}},e)));return(0,l.jsx)(l.Fragment,{children:c},void 0)}function Ln(e){return Ae(Tn,e)}function zn(e,n){return n.webp2Encode(Ve(Vn,e))}const Wn=[a,r,i,o,s],Un=Object.fromEntries(Wn.map((e=>[e.name,e])));function Dn(e){if(e)return e;const n={};for(const e of Wn)n[e.name]={enable:!1,state:e.initOptionsState()};return n.WebP.enable=!0,n}function Bn(e){const{value:n,onChange:t}=e,[a,r]=(0,f.useState)("WebP"),i=Wn.map((e=>{const{name:i}=e,o=(0,w.Z)("_3rUeO",{_1krxL:i===a});return(0,l.jsxs)("button",Object.assign({className:o,onClick:()=>r(i)},{children:[(0,l.jsx)(ue,{checked:n[i].enable,onClick:e=>e.stopPropagation(),onChange:function(e){const a={...n[i],enable:e.currentTarget.checked};t({...n,[i]:a})}},void 0),(0,l.jsx)("span",Object.assign({className:"_2G5o7"},{children:i}),void 0)]}),i)})),{OptionsPanel:o}=Un[a];return(0,l.jsxs)("div",Object.assign({className:"_1LeZ1 dialog-content",role:"tabpanel"},{children:[(0,l.jsx)("div",Object.assign({className:"_1sBf2"},{children:i}),void 0),(0,l.jsx)("form",Object.assign({className:"_3GSpr"},{children:(0,l.jsx)(o,{state:n[a].state,onChange:function(e){const r={...n[a],state:e};t({...n,[a]:r})}},void 0)}),void 0)]}),void 0)}function qn(){const e=localStorage.getItem("Config");return e?JSON.parse(e):{encoders:Dn(),measure:je()}}const Hn=["Information","Encoding","Measure"];function Yn(e){const{file:n,image:t,onStart:a,onClose:r,onSelectFile:i}=e,[o,s]=(0,f.useState)(0),[c,u]=(0,f.useState)(qn),d=Hn.map(((e,n)=>(0,l.jsx)("div",Object.assign({className:"_29qBc",role:"tab","aria-selected":n===o,onClick:()=>s(n)},{children:e}),n)));let h;switch(o){case 0:h=(0,l.jsx)(ge,{file:n,image:t},void 0);break;case 1:h=(0,l.jsx)(Bn,{value:c.encoders,onChange:e=>u({...c,encoders:e})},void 0);break;case 2:h=(0,l.jsx)(Ce,{value:c.measure,onChange:e=>u({...c,measure:e})},void 0)}const p=n&&Object.values(c.encoders).some((e=>e.enable));return(0,l.jsxs)(re,Object.assign({name:"Analysis config",className:"_6sryz",onClose:r},{children:[(0,l.jsx)("div",Object.assign({className:"_3x7vU",role:"tablist"},{children:d}),void 0),h,(0,l.jsxs)("div",Object.assign({className:"dialog-actions"},{children:[(0,l.jsx)($,Object.assign({onClick:i},{children:"Select file..."}),void 0),(0,l.jsx)($,Object.assign({className:"second",onClick:r},{children:"Cancel"}),void 0),(0,l.jsx)($,Object.assign({disabled:!p,onClick:function(){a(c),localStorage.setItem("Config",JSON.stringify(c))}},{children:"Start"}),void 0)]}),void 0)]}),void 0)}const Zn=new Intl.RelativeTimeFormat("en");function Xn(e,n,t){return(t-n)/n*(performance.now()-e)}function Gn(e){const{error:n,value:t,max:a,onCancel:r}=e,[i]=(0,f.useState)((()=>performance.now())),o=(0,f.useMemo)((()=>function(e,n){let t,a=!1;return function(...e){return a?t:(a=!0,setTimeout((()=>a=!1),500),t=n.apply(this,e))}}(0,Xn)),[])(i,t,a),s=Number.isNaN(o)?"----":Zn.format(~~(o/1e3),"seconds");return(0,l.jsxs)(re,{children:[(0,l.jsxs)("div",Object.assign({className:"_1RFbq dialog-content"},{children:[(0,l.jsx)("h1",{children:"Encoding..."},void 0),n&&(0,l.jsxs)("p",Object.assign({className:"O-Yz-"},{children:["Error: ",n]}),void 0),(0,l.jsxs)("div",Object.assign({className:"_3vxdS"},{children:[(0,l.jsxs)("span",{children:[t," / ",a]},void 0),(0,l.jsx)("span",{children:s},void 0)]}),void 0),(0,l.jsx)("progress",{value:t,max:a,className:"mrzz8"},void 0)]}),void 0),(0,l.jsx)("div",Object.assign({className:"_3UNgR dialog-actions"},{children:(0,l.jsx)($,Object.assign({color:"second",onClick:r},{children:" Cancel "}),void 0)}),void 0)]},void 0)}function Qn(e){const{open:n,onClose:t,onChange:a}=e,[r,i]=(0,f.useState)(!0),[o,s]=(0,f.useState)(),[c,u]=(0,f.useState)(),[d,h]=(0,f.useState)(),p=function(e=1){const[n,t]=(0,f.useState)(e),[a,r]=(0,f.useState)(0);return{value:a,max:n,increase:function(){r((e=>e+1))},reset:function(e){r(0),t(e)}}}(),[m,v]=(0,f.useState)();return n?d?(0,l.jsx)(Gn,{value:p.value,max:p.max,error:m,onCancel:function(){d.terminate()}},void 0):r?(0,l.jsx)(ve,{onCancel:function(){o?i(!1):t()},onFileChange:async function(e){const n=await j(e);s(e),u(n),i(!1)}},void 0):(0,l.jsx)(Yn,{image:c,file:o,onStart:async function(e){if(!o)throw new Error("File is null");const{encoders:n,measure:t}=e,r=await j(o);let i=0;const s=[];for(const e of Wn){const{name:t,getOptionsList:a}=e,r=n[t];if(!r.enable)continue;const o=a(r.state);s.push([e,o]),i+=o.length}let l=1;t.butteraugli.enabled&&l++,t.PSNR&&l++,t.SSIM.enabled&&l++;const c=t.time?t.workerCount:0;p.reset(i*l+c);const u={},d=new b(r,t);h(d),d.onProgress=p.increase;try{if(await d.initialize(),t.time)for(const[e,n]of s)await d.pool.runOnEach((async t=>e.encode(t,n[0]).then(p.increase)));for(const[e,n]of s){const t={};u[e.name]=t;for(let a=0;a<n.length;a++){const r=n[a];d.encode(e,r).then((e=>t[JSON.stringify(r)]=e))}}await d.pool.join(),d.pool.terminated||(h(void 0),a({config:e,map:u,original:{file:o,data:r}}))}catch(e){console.error(e),v(e.message)}d.terminate()},onClose:t,onSelectFile:()=>i(!0)},void 0):null}const Jn="_3YpNu",$n="_3c5c0";function Kn(){return(Kn=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var et=f.createElement("path",{d:"M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"});const nt=function(e){return f.createElement("svg",Kn({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 438.549 438.549",fill:"currentColor"},e),et)};var tt=t(7500);function at(e){const{onStart:n}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("section",Object.assign({className:"Tt2Yp"},{children:[(0,l.jsx)("img",{className:"_2g3gN",alt:"banner",src:tt},void 0),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",Object.assign({className:"_2UBpq"},{children:"ICAnalyze"}),void 0),(0,l.jsx)("h2",{children:"Image Codec & Quality analyze tool"},void 0),(0,l.jsx)($,Object.assign({type:"outline",className:Jn,onClick:n},{children:"Try it!"}),void 0),(0,l.jsxs)($,Object.assign({type:"outline",className:"_3YpNu second",href:"https://github.com/Kaciras/ICAnalyze"},{children:[(0,l.jsx)(nt,{},void 0),"Source Code"]}),void 0)]},void 0),(0,l.jsxs)("div",Object.assign({className:"_3tP01"},{children:["Photo by",(0,l.jsx)("a",Object.assign({className:$n,href:"https://unsplash.com/@veverkolog?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},{children:"Dušan veverkolog"}),void 0),"on",(0,l.jsx)("a",Object.assign({className:$n,href:"https://unsplash.com/s/photos/eagle?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},{children:"Unsplash"}),void 0)]}),void 0)]}),void 0),(0,l.jsx)("section",Object.assign({className:"_2SF9G"},{children:"TODO"}),void 0)]},void 0)}var rt=t(6551),it=t(3937),ot=t(7174),st=t(659);const lt={container:"_3kS7K",inputs:"_1Tvc7 controls",option:"_92kbo",imageView:"_1iZci",wrapper:"_2sQef",canvas:"_1YBWC"};var ct;function ut(e,n){if(null===n.current)throw new Error("Canvas is null");const t=n.current.getContext("2d");if(!t)throw new Error("Canvas not initialized");t.putImageData(e,0,0)}function dt(e){const{original:n,output:t}=e,{width:a=0,height:r=0}=n.data||{},[i,o]=(0,f.useState)(ct.Compressed),[s,c]=(0,f.useState)(100),[u,d,h]=function(e){const[n,t]=(0,f.useState)(e);return[n,t,()=>t(e)]}({x:0,y:0,scale:1}),p=(0,f.useRef)(null),m=(0,f.useRef)(null);function v(e){const{children:n,target:t,disabled:a,title:r}=e;return(0,l.jsx)($,Object.assign({type:"text",active:i===t,disabled:a,title:r,onClick:()=>o(t)},{children:n}),void 0)}(0,f.useEffect)((function(){h(),ut(n.data,p)}),[n]),(0,f.useEffect)((function(){const{metrics:e,data:n}=t;ut(i===ct.HeatMap?e.butteraugli.heatMap:n,m)}),[i,t]);let g=null,b=100;i===ct.AbsDiff&&(b=s,g=(0,l.jsxs)("label",Object.assign({className:lt.option},{children:["Brightness %:",(0,l.jsx)(ee,{value:s,min:100,step:50,onValueChange:c},void 0)]}),void 0));const y={width:a,height:r,"--scale":u.scale,"--x":u.x+"px","--y":u.y+"px","--brightness":`${b}%`},x=i===ct.AbsDiff?"difference":void 0,j=!t.metrics.butteraugli,w=j?"Require enable butteraugli":void 0;return(0,l.jsxs)("div",Object.assign({className:lt.container},{children:[(0,l.jsxs)("div",Object.assign({className:lt.inputs},{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(v,Object.assign({target:ct.Original},{children:"Original"}),void 0),(0,l.jsx)(v,Object.assign({target:ct.Compressed},{children:"Output"}),void 0),(0,l.jsx)(v,Object.assign({target:ct.AbsDiff},{children:"Difference"}),void 0),(0,l.jsx)(v,Object.assign({disabled:j,title:w,target:ct.HeatMap},{children:"HeatMap"}),void 0)]},void 0),g]}),void 0),(0,l.jsx)("div",{className:lt.controls},void 0),(0,l.jsx)(ie,Object.assign({className:lt.imageView,state:u,onChange:d},{children:(0,l.jsxs)("div",Object.assign({className:lt.wrapper,style:y},{children:[(0,l.jsx)("canvas",{className:lt.canvas,ref:p,width:a,height:r},void 0),(0,l.jsx)("canvas",{className:lt.canvas,ref:m,width:a,height:r,style:{mixBlendMode:x},hidden:i===ct.Original},void 0)]}),void 0)}),void 0)]}),void 0)}!function(e){e[e.Original=0]="Original",e[e.Compressed=1]="Compressed",e[e.AbsDiff=2]="AbsDiff",e[e.HeatMap=3]="HeatMap"}(ct||(ct={}));var ft=t(8726),ht=t.n(ft),pt=t(2688),mt=t.n(pt),vt=t(4301),gt=t.n(vt);function bt(){return(bt=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var yt=f.createElement("path",{d:"M403.88 196.563h-9.484v-44.388c0-82.099-65.151-150.681-146.582-152.145-2.225-.04-6.671-.04-8.895 0C157.486 1.494 92.336 70.076 92.336 152.175v44.388h-9.485c-14.616 0-26.538 15.082-26.538 33.709v222.632c0 18.606 11.922 33.829 26.539 33.829H403.88c14.616 0 26.539-15.223 26.539-33.829V230.272c0-18.626-11.922-33.709-26.539-33.709zM273.442 341.362v67.271c0 7.703-6.449 14.222-14.158 14.222H227.45c-7.71 0-14.159-6.519-14.159-14.222v-67.271c-7.477-7.36-11.83-17.537-11.83-28.795 0-21.334 16.491-39.666 37.459-40.513 2.222-.09 6.673-.09 8.895 0 20.968.847 37.459 19.179 37.459 40.513-.002 11.258-4.355 21.435-11.832 28.795zm58.444-144.799H154.847v-44.388c0-48.905 39.744-89.342 88.519-89.342 48.775 0 88.521 40.437 88.521 89.342v44.388z"});const xt=function(e){return f.createElement("svg",bt({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 486.733 486.733",fill:"currentColor"},e),yt)};mt()(ht()),gt()(ht());class jt{constructor(e,n){this.mapping=[],this.labels=[],this.divisor=e.file.size/100;const{labels:t,mapping:a,divisor:r}=this,[i]=n;function o(e,n){void 0!==n(i)&&(a.push(n),t.push(e))}o("Compression Ratio %",(e=>e.buffer.byteLength/r)),o("Encode Time (s)",(e=>e.time)),o("SSIM",(e=>e.metrics.SSIM)),o("PSNR (db)",(e=>e.metrics.PSNR)),o("Butteraugli Source",(e=>{var n;return null===(n=e.metrics.butteraugli)||void 0===n?void 0:n.source}))}convert(e){return this.mapping.map((n=>e.map((e=>n(e)))))}}function wt(e,n){e.yAxis.forEach(((e,t)=>{0!==t&&e.update({visible:n===t},!1)})),e.redraw()}function Ct(e){e.series.forEach(((n,t)=>{0!==t&&n.legendItem.on("mouseover",(()=>wt(e,t)))}))}function Ot(e){const{visible:n,original:t,outputs:a,index:r,values:i}=e,[o,s]=(0,f.useState)(),[c,u]=(0,f.useState)(!1),d=(0,f.useMemo)((()=>new jt(t,a)),[t]);(0,f.useEffect)((()=>o&&function(e){const n=d.convert(a);e.xAxis[0].setCategories(i,!1),e.series.forEach(((e,t)=>e.setData(n[t],!1)))}(o)),[a]),(0,f.useEffect)((()=>o&&function(e){const[n]=e.xAxis;n.removePlotLine("MarkLine"),n.addPlotLine({id:"MarkLine",value:r,dashStyle:"Dash"}),e.legend.update({labelFormatter(){const{name:e,options:n}=this,t=n.data[r];let a;switch(t){case 1/0:a="∞";break;case-1/0:a="-∞";break;default:a=t.toFixed(2)}return`${e}: <b>${a}</b>`}}),Ct(e)}(o)));const h=n?{}:{display:"none"};return(0,l.jsxs)("section",Object.assign({className:"_120CL",style:h},{children:[(0,l.jsx)($,Object.assign({title:"Lock Y axis range",type:"text",className:"_2SMWc",active:c,onClick:function(){if(c){const e={min:null,max:null};o.yAxis.forEach((n=>n.update(e,!1))),u(!1)}else u(!0),o.yAxis.forEach((e=>e.update({min:e.min,max:e.max})),!1);o.redraw()}},{children:(0,l.jsx)(xt,{},void 0)}),void 0),(0,l.jsx)("div",{className:"N21M3",ref:function(e){if(!e||o)return;const n=d.convert(a),t=new Array(n.length),r=new Array(n.length);for(let e=0;e<n.length;e++){const a=d.labels[e];t[e]={name:a,type:"line",data:n[e],yAxis:e},r[e]={title:{text:a},visible:!1,opposite:!0}}const[l,c]=r;l.visible=!0,l.opposite=!1,c&&(c.visible=!0);const u={series:t,yAxis:r,chart:{animation:!1,styledMode:!0},title:{text:""},tooltip:{borderRadius:0},legend:{verticalAlign:"top",width:450,alignColumns:!1},xAxis:{categories:i,width:430},exporting:{buttons:{contextButton:{y:5,x:-5,height:32,width:32,symbolSize:16,symbolX:17,symbolY:16}},chartOptions:{chart:{className:"exporting_chart_class"}}}};s(ht().chart(e,u,(e=>{!function(e){e.legend.allItems.forEach(((n,t)=>{0!==t&&(n.onMouseOver=()=>wt(e,t))}))}(e),Ct(e)})))}},void 0)]}),void 0)}function _t(e){const{config:n,value:t,onChange:a}=e,{variableType:r,variableName:i,encoderName:o,encoderState:s}=t;if(r===kt.None)return null;function c(e,n){a({variableType:e,variableName:n})}const u=Un[o],d=Wn.filter((e=>n.encoders[e.name].enable)).map((({name:e})=>(0,l.jsx)("option",Object.assign({value:e},{children:e}),e)));return(0,l.jsxs)("form",Object.assign({className:"_33pnL controls"},{children:[(0,l.jsx)(u.Controls,{state:s[o],variableName:r===kt.Options&&i,onChange:function(e){const{varNames:n,ranges:t,labels:r}=s[o],i={...s,[o]:{varNames:n,values:e,ranges:t,labels:r}};a({encoderState:i})},onVariableChange:e=>c(kt.Options,e)},void 0),d.length>1&&(0,l.jsx)(ce,Object.assign({active:r===kt.Encoder,onFocus:()=>c(kt.Encoder,"Encoder")},{children:(0,l.jsx)(se,Object.assign({value:o,onChange:function(e){a({encoderName:e.currentTarget.value})}},{children:d}),void 0)}),void 0)]}),void 0)}const Nt="_3RfWA";function St(e){const{title:n,buffer:t,filename:a,children:r}=e,{mimeType:i,extension:o}=e.codec,s=(0,f.useRef)("");return(0,f.useEffect)((()=>()=>URL.revokeObjectURL(s.current)),[]),(0,l.jsx)($,Object.assign({className:Nt,type:"text",title:n,onClick:function(){const e=new Blob([t],{type:i});URL.revokeObjectURL(s.current);const n=URL.createObjectURL(e);s.current=n;const r=document.createElement("a");r.href=n,r.download=a.replace(/.[^.]*$/,`.${o}`),document.body.appendChild(r),r.click(),document.body.removeChild(r)}},{children:r}),void 0)}var kt;function Et(e){const{result:n,onStart:t,onClose:a}=e,{original:r,config:i,map:o}=n,[s,c]=(0,f.useState)(!0),[u,d]=(0,f.useReducer)((function(e,n){return{...e,...n}}),null,(function(){const{encoders:e}=i;let n=kt.None,t="";const a=Object.entries(e).filter((e=>e[1].enable));a.length>1&&(n=kt.Encoder,t="");const r=function(e){const n={};for(const[t,a]of Object.entries(e)){if(!a.enable)continue;const e=Un[t].initControlState(a.state);n[t]={...a.state,...e}}return n}(e),[o,s]=a[0];return s.state.varNames.length>0&&(n=kt.Options,t=s.state.varNames[0]),{variableType:n,variableName:t,encoderName:o,encoderState:r}})),{variableType:h,variableName:p,encoderName:m,encoderState:v}=u,g=Un[m],[b]=g.getOptionsList({varNames:[],values:v[m].values,ranges:v[m].ranges}),y=o[m][JSON.stringify(b)],[x,j]=(0,f.useMemo)((()=>{if(h===kt.Encoder){const e=Wn.filter((e=>e.name in o)),n=e.map((e=>{const n=e.getOptionsList({varNames:[],values:v[e.name].values,ranges:v[e.name].ranges});return o[e.name][JSON.stringify(n[0])]}));return[e.map((e=>e.name)),n]}if(h===kt.Options){const e=o[m],n=g.getOptionsList({varNames:[p],values:v[m].values,ranges:v[m].ranges}).map((n=>e[JSON.stringify(n)]));return[v[m].labels[p],n]}return[[""],[y]]}),[b,n,h,p]),w=j.indexOf(y);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(dt,{original:r,output:y},void 0),(0,l.jsx)(Ot,{visible:s,original:r,index:w,values:x,outputs:j},void 0),(0,l.jsxs)("div",Object.assign({className:"_3BYoV controls"},{children:[(0,l.jsx)($,Object.assign({title:"Back",type:"text",className:Nt,onClick:a},{children:(0,l.jsx)(st.Z,{},void 0)}),void 0),(0,l.jsx)($,Object.assign({title:"Select an image",type:"text",className:Nt,onClick:t},{children:(0,l.jsx)(rt.Z,{},void 0)}),void 0),(0,l.jsx)($,Object.assign({title:"Show chart",type:"text",className:Nt,active:s,onClick:()=>c(!s)},{children:(0,l.jsx)(it.Z,{},void 0)}),void 0),(0,l.jsx)(St,Object.assign({title:"Download compressed image",filename:r.file.name,codec:g,buffer:y.buffer},{children:(0,l.jsx)(ot.Z,{},void 0)}),void 0)]}),void 0),(0,l.jsx)(_t,{value:u,onChange:d,config:i},void 0)]},void 0)}!function(e){e[e.None=0]="None",e[e.Encoder=1]="Encoder",e[e.Options=2]="Options"}(kt||(kt={})),function(){try{new File([],"")}catch{return!1}return!!CSS.supports("mix-blend-mode: difference")&&"AbortController"in window}()||alert("ICAnalyze does not support this browser, please switch to a modern one"),u.S({integrations:[new d.jK.BrowserTracing],tracesSampleRate:.2,release:"ic-analyze@0.1.0",dsn:"https://d101904fac2c486ea6f8563c2cf054af@o253601.ingest.sentry.io/5499968"}),c.render((0,l.jsx)((function(){const[e,n]=(0,f.useState)(!1),[t,a]=(0,f.useState)(),r=()=>n(!0);return(0,l.jsxs)(l.Fragment,{children:[t?(0,l.jsx)(Et,{result:t,onStart:r,onClose:()=>a(void 0)},t.id):(0,l.jsx)(at,{onStart:r},void 0),(0,l.jsx)(Qn,{open:e,onChange:function(e){n(!1),e.id=((null==t?void 0:t.id)||1)+1,a(e)},onClose:()=>n(!1)},void 0)]},void 0)}),{},void 0),document.getElementById("root"))},8877:(e,n,t)=>{"use strict";e.exports=t.p+"artwork-icon.bc259.jpg"},9573:(e,n,t)=>{"use strict";e.exports=t.p+"artwork.b7c32.jpg"},7721:(e,n,t)=>{"use strict";e.exports=t.p+"colorful-text-icon.75a8e.png"},5185:(e,n,t)=>{"use strict";e.exports=t.p+"colorful-text.b5bb7.png"},2794:(e,n,t)=>{"use strict";e.exports=t.p+"large-photo-icon.a4fd9.jpg"},8481:(e,n,t)=>{"use strict";e.exports=t.p+"large-photo.54b97.jpg"},7500:(e,n,t)=>{"use strict";e.exports=t.p+"intro-banner.8d466.png"},2203:()=>{},5783:()=>{}},t={};function a(e){var r=t[e];if(void 0!==r)return r.exports;var i=t[e]={id:e,loaded:!1,exports:{}};return n[e].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=n,e=[],a.O=(n,t,r,i)=>{if(!t){var o=1/0;for(c=0;c<e.length;c++){for(var[t,r,i]=e[c],s=!0,l=0;l<t.length;l++)(!1&i||o>=i)&&Object.keys(a.O).every((e=>a.O[e](t[l])))?t.splice(l--,1):(s=!1,i<o&&(o=i));s&&(e.splice(c--,1),n=r())}return n}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,r,i]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.u=e=>e+".js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var n=a.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{a.b=document.baseURI||self.location.href;var e={826:0};a.O.j=n=>0===e[n];var n=(n,t)=>{var r,i,[o,s,l]=t,c=0;for(r in s)a.o(s,r)&&(a.m[r]=s[r]);for(l&&l(a),n&&n(t);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[o[c]]=0;a.O()},t=self.webpackChunkic_analyze=self.webpackChunkic_analyze||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var r=a.O(void 0,[983],(()=>a(9006)));r=a.O(r)})();
//# sourceMappingURL=index.js.map
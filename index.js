(()=>{var e={5564:(e,n,t)=>{"use strict";e.exports=t.p+"demo-large-photo.b8cae.jpg"},6314:(e,n,t)=>{"use strict";e.exports=t.p+"icon-demo-large-photo.464fc.jpg"},9650:(e,n,t)=>{var r,i=(r=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var n,i,a;e=e||{},n||(n=void 0!==e?e:{}),n.ready=new Promise((function(e,n){i=e,a=n}));var o,s,c,l,u,d={};for(o in n)n.hasOwnProperty(o)&&(d[o]=n[o]);s="object"==typeof window,c="function"==typeof importScripts,l="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,u=!s&&!l&&!c;var f,h,p,v,g="";l?(g=c?t(1386).dirname(g)+"/":"//",f=function(e,n){return p||(p=t(2993)),v||(v=t(1386)),e=v.normalize(e),p.readFileSync(e,n?null:"utf8")},h=function(e){return(e=f(e,!0)).buffer||(e=new Uint8Array(e)),w(e.buffer),e},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){throw e})),process.on("unhandledRejection",K),n.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(f=function(e){return read(e)}),h=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(w("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(s||c)&&(c?g=self.location.href:"undefined"!=typeof document&&document.currentScript&&(g=document.currentScript.src),r&&(g=r),g=0!==g.indexOf("blob:")?g.substr(0,g.lastIndexOf("/")+1):"",f=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),n.responseText},c&&(h=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}));var m,b=n.print||console.log.bind(console),y=n.printErr||console.warn.bind(console);for(o in d)d.hasOwnProperty(o)&&(n[o]=d[o]);d=null,n.wasmBinary&&(m=n.wasmBinary),n.noExitRuntime&&n.noExitRuntime,"object"!=typeof WebAssembly&&K("no native wasm support detected");var j,x=!1;function w(e,n){e||K("Assertion failed: "+n)}var A="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function O(e,n,t){var r=n+t;for(t=n;e[t]&&!(t>=r);)++t;if(16<t-n&&e.subarray&&A)return A.decode(e.subarray(n,t));for(r="";n<t;){var i=e[n++];if(128&i){var a=63&e[n++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|a);else{var o=63&e[n++];65536>(i=224==(240&i)?(15&i)<<12|a<<6|o:(7&i)<<18|a<<12|o<<6|63&e[n++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r}var C,N,_,S,k,T,E,P,I,F="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function R(e,n){for(var t=e>>1,r=t+n/2;!(t>=r)&&k[t];)++t;if(32<(t<<=1)-e&&F)return F.decode(_.subarray(e,t));for(t="",r=0;!(r>=n/2);++r){var i=S[e+2*r>>1];if(0==i)break;t+=String.fromCharCode(i)}return t}function B(e,n,t){if(void 0===t&&(t=2147483647),2>t)return 0;var r=n;t=(t-=2)<2*e.length?t/2:e.length;for(var i=0;i<t;++i)S[n>>1]=e.charCodeAt(i),n+=2;return S[n>>1]=0,n-r}function W(e){return 2*e.length}function M(e,n){for(var t=0,r="";!(t>=n/4);){var i=T[e+4*t>>2];if(0==i)break;++t,65536<=i?(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i)):r+=String.fromCharCode(i)}return r}function U(e,n,t){if(void 0===t&&(t=2147483647),4>t)return 0;var r=n;t=r+t-4;for(var i=0;i<e.length;++i){var a=e.charCodeAt(i);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++i)),T[n>>2]=a,(n+=4)+4>t)break}return T[n>>2]=0,n-r}function D(e){for(var n=0,t=0;t<e.length;++t){var r=e.charCodeAt(t);55296<=r&&57343>=r&&++t,n+=4}return n}function L(){var e=j.buffer;C=e,n.HEAP8=N=new Int8Array(e),n.HEAP16=S=new Int16Array(e),n.HEAP32=T=new Int32Array(e),n.HEAPU8=_=new Uint8Array(e),n.HEAPU16=k=new Uint16Array(e),n.HEAPU32=E=new Uint32Array(e),n.HEAPF32=P=new Float32Array(e),n.HEAPF64=I=new Float64Array(e)}var V,z=[],H=[],Z=[],G=[];function Y(){var e=n.preRun.shift();z.unshift(e)}var X=0,$=null,q=null;function K(e){throw n.onAbort&&n.onAbort(e),y(e),x=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),a(e),e}function Q(e){var n=ee;return String.prototype.startsWith?n.startsWith(e):0===n.indexOf(e)}function J(){return Q("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={};var ee="diff.wasm";if(!J()){var ne=ee;ee=n.locateFile?n.locateFile(ne,g):g+ne}function te(){var e=ee;try{if(e==ee&&m)return new Uint8Array(m);if(h)return h(e);throw"both async and sync fetching of the wasm failed"}catch(e){K(e)}}function re(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t(n);else{var r=t.qa;"number"==typeof r?void 0===t.ga?V.get(r)():V.get(r)(t.ga):r(void 0===t.ga?null:t.ga)}}}function ie(e){this.O=e-16,this.Ga=function(e){T[this.O+8>>2]=e},this.Da=function(e){T[this.O+0>>2]=e},this.Ea=function(){T[this.O+4>>2]=0},this.Ca=function(){N[this.O+12>>0]=0},this.Fa=function(){N[this.O+13>>0]=0},this.xa=function(e,n){this.Ga(e),this.Da(n),this.Ea(),this.Ca(),this.Fa()}}var ae={};function oe(e){for(;e.length;){var n=e.pop();e.pop()(n)}}function se(e){return this.fromWireType(E[e>>2])}var ce={},le={},ue={};function de(e){if(void 0===e)return"_unknown";var n=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=n&&57>=n?"_"+e:e}function fe(e,n){return e=de(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(n)}function he(e){var n=Error,t=fe(e,(function(n){this.name=e,this.message=n,void 0!==(n=Error(n).stack)&&(this.stack=this.toString()+"\n"+n.replace(/^Error(:[^\n]*)?\n/,""))}));return t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},t}var pe=void 0;function ve(e){throw new pe(e)}function ge(e,n,t){function r(n){(n=t(n)).length!==e.length&&ve("Mismatched type converter count");for(var r=0;r<e.length;++r)we(e[r],n[r])}e.forEach((function(e){ue[e]=n}));var i=Array(n.length),a=[],o=0;n.forEach((function(e,n){le.hasOwnProperty(e)?i[n]=le[e]:(a.push(e),ce.hasOwnProperty(e)||(ce[e]=[]),ce[e].push((function(){i[n]=le[e],++o===a.length&&r(i)})))})),0===a.length&&r(i)}function me(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var be=void 0;function ye(e){for(var n="";_[e];)n+=be[_[e++]];return n}var je=void 0;function xe(e){throw new je(e)}function we(e,n,t){if(t=t||{},!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=n.name;if(e||xe('type "'+r+'" must have a positive integer typeid pointer'),le.hasOwnProperty(e)){if(t.wa)return;xe("Cannot register type '"+r+"' twice")}le[e]=n,delete ue[e],ce.hasOwnProperty(e)&&(n=ce[e],delete ce[e],n.forEach((function(e){e()})))}function Ae(e){return{count:e.count,Z:e.Z,aa:e.aa,O:e.O,R:e.R,S:e.S,T:e.T}}function Oe(e){xe(e.N.R.P.name+" instance already deleted")}var Ce=!1;function Ne(){}function _e(e){--e.count.value,0===e.count.value&&(e.S?e.T.X(e.S):e.R.P.X(e.O))}function Se(e){return"undefined"==typeof FinalizationGroup?(Se=function(e){return e},e):(Ce=new FinalizationGroup((function(e){for(var n=e.next();!n.done;n=e.next())(n=n.value).O?_e(n):console.warn("object already deleted: "+n.O)})),Ne=function(e){Ce.unregister(e.N)},(Se=function(e){return Ce.register(e,e.N,e.N),e})(e))}var ke=void 0,Te=[];function Ee(){for(;Te.length;){var e=Te.pop();e.N.Z=!1,e.delete()}}function Pe(){}var Ie={};function Fe(e,n,t){if(void 0===e[n].W){var r=e[n];e[n]=function(){return e[n].W.hasOwnProperty(arguments.length)||xe("Function '"+t+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[n].W+")!"),e[n].W[arguments.length].apply(this,arguments)},e[n].W=[],e[n].W[r.da]=r}}function Re(e,n,t,r,i,a,o,s){this.name=e,this.constructor=n,this.$=t,this.X=r,this.U=i,this.ra=a,this.ba=o,this.oa=s,this.Aa=[]}function Be(e,n,t){for(;n!==t;)n.ba||xe("Expected null or instance of "+t.name+", got an instance of "+n.name),e=n.ba(e),n=n.U;return e}function We(e,n){return null===n?(this.ha&&xe("null is not a valid "+this.name),0):(n.N||xe('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||xe("Cannot pass deleted object as a pointer of type "+this.name),Be(n.N.O,n.N.R.P,this.P))}function Me(e,n){if(null===n){if(this.ha&&xe("null is not a valid "+this.name),this.fa){var t=this.ia();return null!==e&&e.push(this.X,t),t}return 0}if(n.N||xe('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||xe("Cannot pass deleted object as a pointer of type "+this.name),!this.ea&&n.N.R.ea&&xe("Cannot convert argument of type "+(n.N.T?n.N.T.name:n.N.R.name)+" to parameter type "+this.name),t=Be(n.N.O,n.N.R.P,this.P),this.fa)switch(void 0===n.N.S&&xe("Passing raw pointer to smart pointer is illegal"),this.Ka){case 0:n.N.T===this?t=n.N.S:xe("Cannot convert argument of type "+(n.N.T?n.N.T.name:n.N.R.name)+" to parameter type "+this.name);break;case 1:t=n.N.S;break;case 2:if(n.N.T===this)t=n.N.S;else{var r=n.clone();t=this.Ba(t,Je((function(){r.delete()}))),null!==e&&e.push(this.X,t)}break;default:xe("Unsupporting sharing policy")}return t}function Ue(e,n){return null===n?(this.ha&&xe("null is not a valid "+this.name),0):(n.N||xe('Cannot pass "'+en(n)+'" as a '+this.name),n.N.O||xe("Cannot pass deleted object as a pointer of type "+this.name),n.N.R.ea&&xe("Cannot convert argument of type "+n.N.R.name+" to parameter type "+this.name),Be(n.N.O,n.N.R.P,this.P))}function De(e,n,t){return n===t?e:void 0===t.U||null===(e=De(e,n,t.U))?null:t.oa(e)}var Le={};function Ve(e,n){return n.R&&n.O||ve("makeClassHandle requires ptr and ptrType"),!!n.T!=!!n.S&&ve("Both smartPtrType and smartPtr must be specified"),n.count={value:1},Se(Object.create(e,{N:{value:n}}))}function ze(e,n,t,r){this.name=e,this.P=n,this.ha=t,this.ea=r,this.fa=!1,this.X=this.Ba=this.ia=this.ma=this.Ka=this.za=void 0,void 0!==n.U?this.toWireType=Me:(this.toWireType=r?We:Ue,this.V=null)}function He(e,t){var r=-1!=(e=ye(e)).indexOf("j")?function(e,t){w(0<=e.indexOf("j"),"getDynCaller should only be called with i64 sigs");var r=[];return function(){r.length=arguments.length;for(var i=0;i<arguments.length;i++)r[i]=arguments[i];return-1!=e.indexOf("j")?r&&r.length?n["dynCall_"+e].apply(null,[t].concat(r)):n["dynCall_"+e].call(null,t):V.get(t).apply(null,r)}}(e,t):V.get(t);return"function"!=typeof r&&xe("unknown function pointer with signature "+e+": "+t),r}var Ze=void 0;function Ge(e){var n=ye(e=yn(e));return bn(e),n}function Ye(e,n){var t=[],r={};throw n.forEach((function e(n){r[n]||le[n]||(ue[n]?ue[n].forEach(e):(t.push(n),r[n]=!0))})),new Ze(e+": "+t.map(Ge).join([", "]))}function Xe(e,n){for(var t=[],r=0;r<e;r++)t.push(T[(n>>2)+r]);return t}function $e(e){var n=Function;if(!(n instanceof Function))throw new TypeError("new_ called with constructor type "+typeof n+" which is not a function");var t=fe(n.name||"unknownFunctionName",(function(){}));return t.prototype=n.prototype,t=new t,(e=n.apply(t,e))instanceof Object?e:t}var qe=[],Ke=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Qe(e){4<e&&0==--Ke[e].ja&&(Ke[e]=void 0,qe.push(e))}function Je(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var n=qe.length?qe.pop():Ke.length;return Ke[n]={ja:1,value:e},n}}function en(e){if(null===e)return"null";var n=typeof e;return"object"===n||"array"===n||"function"===n?e.toString():""+e}function nn(e,n){switch(n){case 2:return function(e){return this.fromWireType(P[e>>2])};case 3:return function(e){return this.fromWireType(I[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function tn(e,n,t){switch(n){case 0:return t?function(e){return N[e]}:function(e){return _[e]};case 1:return t?function(e){return S[e>>1]}:function(e){return k[e>>1]};case 2:return t?function(e){return T[e>>2]}:function(e){return E[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var rn={};function an(e){var n=rn[e];return void 0===n?ye(e):n}var on=[];function sn(e){return e||xe("Cannot use deleted val. handle = "+e),Ke[e].value}function cn(){return"object"==typeof globalThis?globalThis:Function("return this")()}function ln(e,n){var t=le[e];return void 0===t&&xe(n+" has unknown type "+Ge(e)),t}var un={},dn=[null,[],[]];pe=n.InternalError=he("InternalError");for(var fn=Array(256),hn=0;256>hn;++hn)fn[hn]=String.fromCharCode(hn);be=fn,je=n.BindingError=he("BindingError"),Pe.prototype.isAliasOf=function(e){if(!(this instanceof Pe&&e instanceof Pe))return!1;var n=this.N.R.P,t=this.N.O,r=e.N.R.P;for(e=e.N.O;n.U;)t=n.ba(t),n=n.U;for(;r.U;)e=r.ba(e),r=r.U;return n===r&&t===e},Pe.prototype.clone=function(){if(this.N.O||Oe(this),this.N.aa)return this.N.count.value+=1,this;var e=Se(Object.create(Object.getPrototypeOf(this),{N:{value:Ae(this.N)}}));return e.N.count.value+=1,e.N.Z=!1,e},Pe.prototype.delete=function(){this.N.O||Oe(this),this.N.Z&&!this.N.aa&&xe("Object already scheduled for deletion"),Ne(this),_e(this.N),this.N.aa||(this.N.S=void 0,this.N.O=void 0)},Pe.prototype.isDeleted=function(){return!this.N.O},Pe.prototype.deleteLater=function(){return this.N.O||Oe(this),this.N.Z&&!this.N.aa&&xe("Object already scheduled for deletion"),Te.push(this),1===Te.length&&ke&&ke(Ee),this.N.Z=!0,this},ze.prototype.sa=function(e){return this.ma&&(e=this.ma(e)),e},ze.prototype.ka=function(e){this.X&&this.X(e)},ze.prototype.argPackAdvance=8,ze.prototype.readValueFromPointer=se,ze.prototype.deleteObject=function(e){null!==e&&e.delete()},ze.prototype.fromWireType=function(e){function n(){return this.fa?Ve(this.P.$,{R:this.za,O:t,T:this,S:e}):Ve(this.P.$,{R:this,O:e})}var t=this.sa(e);if(!t)return this.ka(e),null;var r=function(e,n){for(void 0===n&&xe("ptr should not be undefined");e.U;)n=e.ba(n),e=e.U;return Le[n]}(this.P,t);if(void 0!==r)return 0===r.N.count.value?(r.N.O=t,r.N.S=e,r.clone()):(r=r.clone(),this.ka(e),r);if(r=this.P.ra(t),!(r=Ie[r]))return n.call(this);r=this.ea?r.na:r.pointerType;var i=De(t,this.P,r.P);return null===i?n.call(this):this.fa?Ve(r.P.$,{R:r,O:i,T:this,S:e}):Ve(r.P.$,{R:r,O:i})},n.getInheritedInstanceCount=function(){return Object.keys(Le).length},n.getLiveInheritedInstances=function(){var e,n=[];for(e in Le)Le.hasOwnProperty(e)&&n.push(Le[e]);return n},n.flushPendingDeletes=Ee,n.setDelayFunction=function(e){ke=e,Te.length&&ke&&ke(Ee)},Ze=n.UnboundTypeError=he("UnboundTypeError"),n.count_emval_handles=function(){for(var e=0,n=5;n<Ke.length;++n)void 0!==Ke[n]&&++e;return e},n.get_first_emval=function(){for(var e=5;e<Ke.length;++e)if(void 0!==Ke[e])return Ke[e];return null},H.push({qa:function(){gn()}});var pn={b:function(e,n,t,r){K("Assertion failed: "+(e?O(_,e,void 0):"")+", at: "+[n?n?O(_,n,void 0):"":"unknown filename",t,r?r?O(_,r,void 0):"":"unknown function"])},B:function(e){return mn(e+16)+16},E:function(){},A:function(e,n,t){throw new ie(e).xa(n,t),e},i:function(e){var n=ae[e];delete ae[e];var t=n.ia,r=n.X,i=n.la;ge([e],i.map((function(e){return e.va})).concat(i.map((function(e){return e.Ia}))),(function(e){var a={};return i.forEach((function(n,t){var r=e[t],o=n.ta,s=n.ua,c=e[t+i.length],l=n.Ha,u=n.Ja;a[n.pa]={read:function(e){return r.fromWireType(o(s,e))},write:function(e,n){var t=[];l(u,e,c.toWireType(t,n)),oe(t)}}})),[{name:n.name,fromWireType:function(e){var n,t={};for(n in a)t[n]=a[n].read(e);return r(e),t},toWireType:function(e,n){for(var i in a)if(!(i in n))throw new TypeError('Missing field:  "'+i+'"');var o=t();for(i in a)a[i].write(o,n[i]);return null!==e&&e.push(r,o),o},argPackAdvance:8,readValueFromPointer:se,V:r}]}))},y:function(e,n,t,r,i){var a=me(t);we(e,{name:n=ye(n),fromWireType:function(e){return!!e},toWireType:function(e,n){return n?r:i},argPackAdvance:8,readValueFromPointer:function(e){if(1===t)var r=N;else if(2===t)r=S;else{if(4!==t)throw new TypeError("Unknown boolean type size: "+n);r=T}return this.fromWireType(r[e>>a])},V:null})},t:function(e,t,r,i,a,o,s,c,l,u,d,f,h){d=ye(d),o=He(a,o),c&&(c=He(s,c)),u&&(u=He(l,u)),h=He(f,h);var p=de(d);!function(e,t){n.hasOwnProperty(e)?(xe("Cannot register public name '"+e+"' twice"),Fe(n,e,e),n.hasOwnProperty(void 0)&&xe("Cannot register multiple overloads of a function with the same number of arguments (undefined)!"),n[e].W[void 0]=t):n[e]=t}(p,(function(){Ye("Cannot construct "+d+" due to unbound types",[i])})),ge([e,t,r],i?[i]:[],(function(t){if(t=t[0],i)var r=t.P,a=r.$;else a=Pe.prototype;t=fe(p,(function(){if(Object.getPrototypeOf(this)!==s)throw new je("Use 'new' to construct "+d);if(void 0===l.Y)throw new je(d+" has no accessible constructor");var e=l.Y[arguments.length];if(void 0===e)throw new je("Tried to invoke ctor of "+d+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(l.Y).toString()+") parameters instead!");return e.apply(this,arguments)}));var s=Object.create(a,{constructor:{value:t}});t.prototype=s;var l=new Re(d,t,s,h,r,o,c,u);r=new ze(d,l,!0,!1),a=new ze(d+"*",l,!1,!1);var f=new ze(d+" const*",l,!1,!0);return Ie[e]={pointerType:a,na:f},function(e,t){n.hasOwnProperty(e)||ve("Replacing nonexistant public symbol"),n[e]=t,n[e].da=void 0}(p,t),[r,a,f]}))},s:function(e,n,t,r,i,a){w(0<n);var o=Xe(n,t);i=He(r,i);var s=[a],c=[];ge([],[e],(function(e){var t="constructor "+(e=e[0]).name;if(void 0===e.P.Y&&(e.P.Y=[]),void 0!==e.P.Y[n-1])throw new je("Cannot register multiple constructors with identical number of parameters ("+(n-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.P.Y[n-1]=function(){Ye("Cannot construct "+e.name+" due to unbound types",o)},ge([],o,(function(r){return e.P.Y[n-1]=function(){arguments.length!==n-1&&xe(t+" called with "+arguments.length+" arguments, expected "+(n-1)),c.length=0,s.length=n;for(var e=1;e<n;++e)s[e]=r[e].toWireType(c,arguments[e-1]);return e=i.apply(null,s),oe(c),r[0].fromWireType(e)},[]})),[]}))},r:function(e,n,t,r,i,a,o,s){var c=Xe(t,r);n=ye(n),a=He(i,a),ge([],[e],(function(e){function r(){Ye("Cannot call "+i+" due to unbound types",c)}var i=(e=e[0]).name+"."+n;s&&e.P.Aa.push(n);var l=e.P.$,u=l[n];return void 0===u||void 0===u.W&&u.className!==e.name&&u.da===t-2?(r.da=t-2,r.className=e.name,l[n]=r):(Fe(l,n,i),l[n].W[t-2]=r),ge([],c,(function(r){var s=i,c=e,u=a,d=r.length;2>d&&xe("argTypes array size mismatch! Must at least get return value and 'this' types!");var f=null!==r[1]&&null!==c,h=!1;for(c=1;c<r.length;++c)if(null!==r[c]&&void 0===r[c].V){h=!0;break}var p="void"!==r[0].name,v="",g="";for(c=0;c<d-2;++c)v+=(0!==c?", ":"")+"arg"+c,g+=(0!==c?", ":"")+"arg"+c+"Wired";s="return function "+de(s)+"("+v+") {\nif (arguments.length !== "+(d-2)+") {\nthrowBindingError('function "+s+" called with ' + arguments.length + ' arguments, expected "+(d-2)+" args!');\n}\n",h&&(s+="var destructors = [];\n");var m=h?"destructors":"null";for(v="throwBindingError invoker fn runDestructors retType classParam".split(" "),u=[xe,u,o,oe,r[0],r[1]],f&&(s+="var thisWired = classParam.toWireType("+m+", this);\n"),c=0;c<d-2;++c)s+="var arg"+c+"Wired = argType"+c+".toWireType("+m+", arg"+c+"); // "+r[c+2].name+"\n",v.push("argType"+c),u.push(r[c+2]);if(f&&(g="thisWired"+(0<g.length?", ":"")+g),s+=(p?"var rv = ":"")+"invoker(fn"+(0<g.length?", ":"")+g+");\n",h)s+="runDestructors(destructors);\n";else for(c=f?1:2;c<r.length;++c)d=1===c?"thisWired":"arg"+(c-2)+"Wired",null!==r[c].V&&(s+=d+"_dtor("+d+"); // "+r[c].name+"\n",v.push(d+"_dtor"),u.push(r[c].V));return p&&(s+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),v.push(s+"}\n"),r=$e(v).apply(null,u),void 0===l[n].W?(r.da=t-2,l[n]=r):l[n].W[t-2]=r,[]})),[]}))},x:function(e,n){we(e,{name:n=ye(n),fromWireType:function(e){var n=Ke[e].value;return Qe(e),n},toWireType:function(e,n){return Je(n)},argPackAdvance:8,readValueFromPointer:se,V:null})},k:function(e,n,t){t=me(t),we(e,{name:n=ye(n),fromWireType:function(e){return e},toWireType:function(e,n){if("number"!=typeof n&&"boolean"!=typeof n)throw new TypeError('Cannot convert "'+en(n)+'" to '+this.name);return n},argPackAdvance:8,readValueFromPointer:nn(n,t),V:null})},d:function(e,n,t,r,i){function a(e){return e}n=ye(n),-1===i&&(i=4294967295);var o=me(t);if(0===r){var s=32-8*t;a=function(e){return e<<s>>>s}}var c=-1!=n.indexOf("unsigned");we(e,{name:n,fromWireType:a,toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+en(t)+'" to '+this.name);if(t<r||t>i)throw new TypeError('Passing a number "'+en(t)+'" from JS side to C/C++ side to an argument of type "'+n+'", which is outside the valid range ['+r+", "+i+"]!");return c?t>>>0:0|t},argPackAdvance:8,readValueFromPointer:tn(n,o,0!==r),V:null})},c:function(e,n,t){function r(e){var n=E;return new i(C,n[1+(e>>=2)],n[e])}var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][n];we(e,{name:t=ye(t),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{wa:!0})},l:function(e,n){var t="std::string"===(n=ye(n));we(e,{name:n,fromWireType:function(e){var n=E[e>>2];if(t)for(var r=e+4,i=0;i<=n;++i){var a=e+4+i;if(i==n||0==_[a]){if(r=r?O(_,r,a-r):"",void 0===o)var o=r;else o+=String.fromCharCode(0),o+=r;r=a+1}}else{for(o=Array(n),i=0;i<n;++i)o[i]=String.fromCharCode(_[e+4+i]);o=o.join("")}return bn(e),o},toWireType:function(e,n){n instanceof ArrayBuffer&&(n=new Uint8Array(n));var r="string"==typeof n;r||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Int8Array||xe("Cannot pass non-string to std::string");var i=(t&&r?function(){for(var e=0,t=0;t<n.length;++t){var r=n.charCodeAt(t);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&n.charCodeAt(++t)),127>=r?++e:e=2047>=r?e+2:65535>=r?e+3:e+4}return e}:function(){return n.length})(),a=mn(4+i+1);if(E[a>>2]=i,t&&r)!function(e,n,t){var r=_;if(0<t){t=n+t-1;for(var i=0;i<e.length;++i){var a=e.charCodeAt(i);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++i)),127>=a){if(n>=t)break;r[n++]=a}else{if(2047>=a){if(n+1>=t)break;r[n++]=192|a>>6}else{if(65535>=a){if(n+2>=t)break;r[n++]=224|a>>12}else{if(n+3>=t)break;r[n++]=240|a>>18,r[n++]=128|a>>12&63}r[n++]=128|a>>6&63}r[n++]=128|63&a}}r[n]=0}}(n,a+4,i+1);else if(r)for(r=0;r<i;++r){var o=n.charCodeAt(r);255<o&&(bn(a),xe("String has UTF-16 code units that do not fit in 8 bits")),_[a+4+r]=o}else for(r=0;r<i;++r)_[a+4+r]=n[r];return null!==e&&e.push(bn,a),a},argPackAdvance:8,readValueFromPointer:se,V:function(e){bn(e)}})},g:function(e,n,t){if(t=ye(t),2===n)var r=R,i=B,a=W,o=function(){return k},s=1;else 4===n&&(r=M,i=U,a=D,o=function(){return E},s=2);we(e,{name:t,fromWireType:function(e){for(var t,i=E[e>>2],a=o(),c=e+4,l=0;l<=i;++l){var u=e+4+l*n;l!=i&&0!=a[u>>s]||(c=r(c,u-c),void 0===t?t=c:(t+=String.fromCharCode(0),t+=c),c=u+n)}return bn(e),t},toWireType:function(e,r){"string"!=typeof r&&xe("Cannot pass non-string to C++ string type "+t);var o=a(r),c=mn(4+o+n);return E[c>>2]=o>>s,i(r,c+4,o+n),null!==e&&e.push(bn,c),c},argPackAdvance:8,readValueFromPointer:se,V:function(e){bn(e)}})},m:function(e,n,t,r,i,a){ae[e]={name:ye(n),ia:He(t,r),X:He(i,a),la:[]}},e:function(e,n,t,r,i,a,o,s,c,l){ae[e].la.push({pa:ye(n),va:t,ta:He(r,i),ua:a,Ia:o,Ha:He(s,c),Ja:l})},z:function(e,n){we(e,{ya:!0,name:n=ye(n),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},n:function(e,n,t,r){(e=on[e])(n=sn(n),t=an(t),null,r)},f:Qe,p:function(e){return 0===e?Je(cn()):(e=an(e),Je(cn()[e]))},o:function(e,n){for(var t=(n=function(e,n){for(var t=Array(e),r=0;r<e;++r)t[r]=ln(T[(n>>2)+r],"parameter "+r);return t}(e,n))[0],r=t.name+"_$"+n.slice(1).map((function(e){return e.name})).join("_")+"$",i=["retType"],a=[t],o="",s=0;s<e-1;++s)o+=(0!==s?", ":"")+"arg"+s,i.push("argType"+s),a.push(n[1+s]);r="return function "+de("methodCaller_"+r)+"(handle, name, destructors, args) {\n";var c=0;for(s=0;s<e-1;++s)r+="    var arg"+s+" = argType"+s+".readValueFromPointer(args"+(c?"+"+c:"")+");\n",c+=n[s+1].argPackAdvance;for(r+="    var rv = handle[name]("+o+");\n",s=0;s<e-1;++s)n[s+1].deleteObject&&(r+="    argType"+s+".deleteObject(arg"+s+");\n");return t.ya||(r+="    return retType.toWireType(destructors, rv);\n"),i.push(r+"};\n"),function(e){var n=on.length;return on.push(e),n}(e=$e(i).apply(null,a))},h:function(e){4<e&&(Ke[e].ja+=1)},D:function(e,t,r,i){e=sn(e);var a=un[t];if(!a){a="";for(var o=0;o<t;++o)a+=(0!==o?", ":"")+"arg"+o;var s="return function emval_allocator_"+t+"(constructor, argTypes, args) {\n";for(o=0;o<t;++o)s+="var argType"+o+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+o+'], "parameter '+o+'");\nvar arg'+o+" = argType"+o+".readValueFromPointer(args);\nargs += argType"+o+"['argPackAdvance'];\n";a=new Function("requireRegisteredType","Module","__emval_register",s+"var obj = new constructor("+a+");\nreturn __emval_register(obj);\n}\n")(ln,n,Je),un[t]=a}return a(e,r,i)},C:function(){return Je([])},q:function(e,n){return Je(e=(e=ln(e,"_emval_take_value")).readValueFromPointer(n))},a:function(){K()},v:function(e,n,t){_.copyWithin(e,n,n+t)},w:function(e){e>>>=0;var n=_.length;if(2147483648<e)return!1;for(var t=1;4>=t;t*=2){var r=n*(1+.2/t);r=Math.min(r,e+100663296),0<(r=Math.max(16777216,e,r))%65536&&(r+=65536-r%65536);e:{try{j.grow(Math.min(2147483648,r)-C.byteLength+65535>>>16),L();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},j:function(e,n,t,r){for(var i=0,a=0;a<t;a++){for(var o=T[n+8*a>>2],s=T[n+(8*a+4)>>2],c=0;c<s;c++){var l=_[o+c],u=dn[e];0===l||10===l?((1===e?b:y)(O(u,0)),u.length=0):u.push(l)}i+=s}return T[r>>2]=i,0},u:function(){}};!function(){function e(e){n.asm=e.exports,j=n.asm.F,L(),V=n.asm.G,X--,n.monitorRunDependencies&&n.monitorRunDependencies(X),0==X&&(null!==$&&(clearInterval($),$=null),q&&(e=q,q=null,e()))}function t(n){e(n.instance)}function r(e){return(m||!s&&!c||"function"!=typeof fetch||Q("file://")?Promise.resolve().then((function(){return te()})):fetch(ee,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ee+"'";return e.arrayBuffer()})).catch((function(){return te()}))).then((function(e){return WebAssembly.instantiate(e,i)})).then(e,(function(e){y("failed to asynchronously prepare wasm: "+e),K(e)}))}var i={a:pn};if(X++,n.monitorRunDependencies&&n.monitorRunDependencies(X),n.instantiateWasm)try{return n.instantiateWasm(i,e)}catch(e){return y("Module.instantiateWasm callback failed with error: "+e),!1}(m||"function"!=typeof WebAssembly.instantiateStreaming||J()||Q("file://")||"function"!=typeof fetch?r(t):fetch(ee,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,i).then(t,(function(e){return y("wasm streaming compile failed: "+e),y("falling back to ArrayBuffer instantiation"),r(t)}))}))).catch(a)}();var vn,gn=n.___wasm_call_ctors=function(){return(gn=n.___wasm_call_ctors=n.asm.H).apply(null,arguments)},mn=n._malloc=function(){return(mn=n._malloc=n.asm.I).apply(null,arguments)},bn=n._free=function(){return(bn=n._free=n.asm.J).apply(null,arguments)},yn=n.___getTypeName=function(){return(yn=n.___getTypeName=n.asm.K).apply(null,arguments)};function jn(){function e(){if(!vn&&(vn=!0,n.calledRun=!0,!x)){if(re(H),re(Z),i(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;){var e=n.postRun.shift();G.unshift(e)}re(G)}}if(!(0<X)){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)Y();re(z),0<X||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e())}}if(n.___embind_register_native_and_builtin_types=function(){return(n.___embind_register_native_and_builtin_types=n.asm.L).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.M).apply(null,arguments)},q=function e(){vn||jn(),vn||(q=e)},n.run=jn,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();return jn(),e.ready});e.exports=i},1614:(e,n,t)=>{"use strict";var r={};t.r(r),t.d(r,{Controls:()=>Fe,OptionsPanel:()=>Ie,encode:()=>Be,extension:()=>Te,getDefaultOptions:()=>Ee,getOptionsList:()=>Re,mimeType:()=>ke,name:()=>Se});var i=t(1925),a=t(6258),o=t(4136),s=t(4034),c=t(3889),l=t(4279);async function u(e){const n=URL.createObjectURL(e);try{return await async function(e){const n=new Image;n.decoding="async",n.src=e;const t=new Promise(((e,t)=>{n.onload=()=>e(),n.onerror=()=>t(Error("Image loading error"))}));return n.decode&&await n.decode().catch((()=>null)),await t,n}(n)}finally{URL.revokeObjectURL(n)}}new Map,new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\xF4\xFF\x6F/,"image/webp2"],[/^\x00\x00\x00 ftypavif\x00\x00\x00\x00/,"image/avif"],[/^\xff\x0a/,"image/jpegxl"]]);const d=()=>{},f=["","K","M","G","T","P","E","Z","Y"];function h(e,n=1024){const t=Math.abs(e);if(0==t)return`${e.toFixed(2)} B`;const r=~~(Math.log2(t)/Math.log2(n));return`${(e/n**r).toFixed(2)} ${f[r]}B`}class p{constructor(e,n){this.workers=[],this.remotes=[],this.workers=new Array(n),this.remotes=new Array(n);for(let t=0;t<n;t++){const n=e();this.workers[t]=n,this.remotes[t]=(0,l.Ud)(n)}}get count(){return this.workers.length}runOnEach(e){return Promise.all(this.remotes.map(e))}async all(e,n){const t=new Array(e.length);let r=0;return this.runOnEach((async i=>{for(;r<e.length;){const a=r++;t[a]=await n(i,e[a])}})).then((()=>t))}terminate(){this.workers.forEach((e=>e.terminate()))}}function v(){return new Worker(new URL(t.p+t.u(762),t.b))}class g{constructor(e,n){this.progress=0;const{threads:t,optionsList:r}=n;if(t<1)throw new Error("Thread count must be at least 1");const i=Math.min(t,r.length);this.image=e,this.config=n,this.pool=new p(v,i),this.progressMax=this.getProgressMax()}getProgressMax(){const{optionsList:e,measure:n}=this.config;let t=1;n.butteraugli&&t++,n.SSIM&&t++,n.PSNR&&t++;const r=e.length*t;return n.time?r+this.pool.count:r}onProgress(e){}increaseProgress(){this.onProgress(this.progress++)}async encode(){const{encoder:e,optionsList:n,measure:t}=this.config,{image:r}=this;return await this.pool.runOnEach((e=>e.setImageToEncode(r))),t.time&&await this.pool.runOnEach((async t=>{await e.encode(n[0],t),this.increaseProgress()})),this.pool.all(n,this.poll.bind(this))}terminate(){this.pool.terminate()}async poll(e,n){const{encoder:t}=this.config,{buffer:r,time:i}=await t.encode(n,e),a=new Blob([r],{type:t.mimeType}),o=await w(a);return this.increaseProgress(),{time:i,buffer:r,data:o,metrics:await this.measure(e,o)}}async measure(e,n){const{SSIM:t,PSNR:r,butteraugli:i}=this.config.measure,a={};if(r&&(a.PSNR=await e.calcPSNR(n),this.increaseProgress()),t&&(a.SSIM=await e.calcSSIM(n,t),this.increaseProgress()),i){const[t,r]=await e.calcButteraugli(n,i);this.increaseProgress();const o=function(e,n,t){if(e.byteLength/n/t!=4)throw new Error("Buffer must be a 8-bit depth RGBA array");const r=document.createElement("canvas").getContext("2d");if(!r)throw new Error("Could not create canvas context");const i=r.createImageData(n,t);return i.data.set(new Uint8ClampedArray(e)),i}(r,n.width,n.height);a.butteraugli={source:t,heatMap:o}}return a}}async function m(e){const n="createImageBitmap"in self?await createImageBitmap(e):await u(e),t=document.createElement("canvas"),{width:r,height:i}=n;t.width=r,t.height=i;const a=t.getContext("2d");if(!a)throw new Error("Canvas not initialized");return a.drawImage(n,0,0),a.getImageData(0,0,r,i)}function b(e,n,t){let r;return r=async function(i){return r=await e()?n:t,await r(i)},e=>r(e)}const y=b((function(){const e=new Image;return e.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",new Promise((n=>{e.onload=()=>n(!0),e.onerror=()=>n(!1)}))}),m,(function(e){const n=v();return e.arrayBuffer().then((e=>(0,l.Ud)(n).webpDecode(e))).finally((()=>n.terminate()))})),j=b((function(){const e=new Image;return e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABYAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAABAAQAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB5tZGF0EgAKBzgADtAQQBkyCRAAAAAP+I9ngw==",new Promise((n=>{e.onload=()=>n(!0),e.onerror=()=>n(!1)}))}),m,(function(e){const n=v();return e.arrayBuffer().then((e=>(0,l.Ud)(n).avifDecode(e))).finally((()=>n.terminate()))}));async function x(e){e=function(e){const n=(new DOMParser).parseFromString(e,"image/svg+xml"),t=n.documentElement;if(t.getAttribute("width")&&t.getAttribute("height"))return e;const r=t.getAttribute("viewBox");if(null===r)throw Error("SVG must have width/height or viewBox");const[,,i,a]=r.split(/\s+/);return t.setAttribute("width",i),t.setAttribute("height",a),(new XMLSerializer).serializeToString(n)}(e);const n=new Blob([e],{type:"image/svg+xml"});return function(e,n={}){const{width:t=e.width,height:r=e.height,sx:i=0,sy:a=0,sw:o=e.width,sh:s=e.height}=n,c=document.createElement("canvas");c.width=t,c.height=r;const l=c.getContext("2d");if(!l)throw new Error("Could not create canvas context");return l.drawImage(e,i,a,o,s,0,0,t,r),l.getImageData(0,0,t,r)}(await u(n))}function w(e){switch(e.type){case"image/svg+xml":return e.text().then(x);case"image/webp":return y(e);case"image/avif":return j(e);default:return m(e)}}var A=t(1626),O=t(4685);function C(){return(C=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var N=c.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),_=c.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"});const S=function(e){return c.createElement("svg",C({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),N,_)};function k(){return(k=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var T=c.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),E=c.createElement("path",{d:"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"});const P=function(e){return c.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),T,E)};function I(){return(I=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var F=c.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),R=c.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"});const B=function(e){return c.createElement("svg",I({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),F,R)};function W(){return(W=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var M=c.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),U=c.createElement("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"});const D=function(e){return c.createElement("svg",W({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),M,U)};function L(e){const{type:n,Icon:t,IconChecked:r,name:a,children:o,checked:s,disabled:c,onChange:l=d}=e;return(0,i.jsxs)("label",Object.assign({className:"_2Ov17"},{children:[(0,i.jsx)("input",{type:n,className:"_2IoHf",name:a,disabled:c,onChange:l},void 0),(0,i.jsx)("span",Object.assign({className:(0,A.Z)("_2H-Mw",{OBGYY:s})},{children:s?(0,i.jsx)(r,{},void 0):(0,i.jsx)(t,{},void 0)}),void 0),o&&(0,i.jsx)("span",Object.assign({className:"_11H37"},{children:o}),void 0)]}),void 0)}function V(e){e.currentTarget.blur()}function z(e){const{className:n,children:t,title:r,href:a,disabled:o,active:s,onClick:c}=e,l=(0,A.Z)("qzDJM",n,{_3vITC:s}),u=a?"a":"button";return(0,i.jsx)(u,Object.assign({className:l,title:r,disabled:o,href:a,type:"button",onClick:c,onMouseUp:V},{children:t}),void 0)}function H(e){var n;const t={"--value-percent":`${null!==(n=e.value)&&void 0!==n?n:0}%`};return(0,i.jsxs)("span",Object.assign({className:"_2DhF4",style:t},{children:[(0,i.jsx)("input",{type:"range",className:"_3dzMs",value:e.value,min:e.min,max:e.max,step:e.step,onChange:e.onChange},void 0),(0,i.jsx)("span",Object.assign({className:"_2b567"},{children:(0,i.jsx)("span",{className:"_26ZKf"},void 0)}),void 0)]}),void 0)}function Z(e){const{className:n,children:t,title:r,disabled:a,color:o,busy:s,onClick:c}=e,l=(0,A.Z)("_2wLkD",n,o,{_3XmXG:s});return(0,i.jsx)("button",Object.assign({className:l,title:r,disabled:a,type:"button",onClick:c,onMouseUp:V},{children:t}),void 0)}const G="_1H0a4";function Y(e){const{name:n,className:t,value:r,min:a,max:o,step:s,disabled:l,onChange:u,onValueChange:d}=e,[f,h]=function(e=0,n=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY,r=0){const[i,a]=(0,c.useState)(e);return[i,function(e){if(e>t)e=t;else if(e<n)e=n;else if(0!==r){const n=e/r;Number.isInteger(n)||(e=Math.round(n)*r)}return a(e),e}]}(r,a,o,.5),p=void 0===r?f:r;function v(e){const n=e.target.valueAsNumber;u&&u(e),d&&d(n),h(n)}return(0,i.jsxs)("div",Object.assign({className:(0,A.Z)("_2dfjc",t)},{children:[(0,i.jsx)("input",{type:"number",className:"xI_9P",disabled:l,name:n,value:r,onChange:v},void 0),(0,i.jsx)("button",{type:"button",className:(0,A.Z)(G,"dBnP0"),tabIndex:-1,disabled:l,onClick:()=>v(p+(s||1))},void 0),(0,i.jsx)("button",{type:"button",className:G,tabIndex:-1,disabled:l,onClick:()=>v(p-(s||1))},void 0)]}),void 0)}const X="_3_cLi",$="_1p1yr";function q(){const e=document.body.querySelectorAll("._3_cLi"),n=e[e.length-2];if(n)return n.classList.add($),()=>n.classList.remove($)}function K(e){const{className:n,onClose:t=d}=e;function r(e){"Escape"===e.key&&(t(),e.stopImmediatePropagation())}return(0,c.useEffect)((()=>(window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r))),[]),(0,c.useLayoutEffect)(q,[]),(0,a.createPortal)((0,i.jsx)("div",Object.assign({className:X},{children:(0,i.jsx)("div",Object.assign({className:(0,A.Z)(n,"_1Vq87")},{children:e.children}),void 0)}),void 0),document.body)}function Q(e){const{state:n,className:t,children:r,onChange:a}=e;function o(e,t){const r=n.x+e,i=n.y+t;a({scale:n.scale,x:r,y:i})}return(0,i.jsx)("div",Object.assign({style:{touchAction:"none"},className:t,onWheel:function(e){const{ctrlKey:t,deltaMode:r,clientX:i,clientY:o}=e;let{deltaY:s}=e;e.preventDefault(),1===r&&(s*=15);const c=1-s/(t?100:300),l=e.currentTarget.firstElementChild.getBoundingClientRect(),u=(l.left+l.width/2-i)*(c-1),d=(l.top+l.height/2-o)*(c-1);a({x:n.x+u,y:n.y+d,scale:n.scale*c})},onTouchStart:function(e){!function(e,n){const t=e.touches[0];function r(e){const r=e.touches[0];n(r.pageX-t.pageX,r.pageY-t.pageY)}document.addEventListener("touchmove",r),document.addEventListener("touchend",(function e(n){n.preventDefault(),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",e)}))}(e.nativeEvent,o)},onMouseDown:function(e){0===e.button&&function(e,n){const t=e.pageX,r=e.pageY;function i(e){n(e.pageX-t,e.pageY-r)}document.addEventListener("mousemove",i),document.addEventListener("mouseup",(function e(n){n.preventDefault(),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)}))}(e.nativeEvent,o)}},{children:r}),void 0)}var J=t(693);function ee(e){return(0,i.jsxs)("div",Object.assign({className:"_3Neg9"},{children:[(0,i.jsx)("select",Object.assign({},e,{className:"_2rF3V"}),void 0),(0,i.jsx)(J.Z,{className:"_2Arv_"},void 0)]}),void 0)}function ne(e){return L({...e,type:"checkbox",Icon:S,IconChecked:P})}function te(e){return L({...e,type:"radio",Icon:B,IconChecked:D})}var re=t(5564),ie=t(6314),ae=t(9573),oe=t(8877),se=t(7721),ce=t(5185);function le(e){const{description:n,url:t,icon:r,onClick:a}=e,[o,s]=(0,c.useState)(!1);return(0,i.jsxs)("button",Object.assign({className:"_2Z_sH",onClick:async function(){if(!o){s(!0);try{await a(t)}finally{s(!1)}}}},{children:[(0,i.jsx)("img",{src:r,alt:"icon",className:"ZflhA"},void 0),o&&(0,i.jsx)("div",{className:"_2BAvs"},void 0),(0,i.jsx)("span",Object.assign({className:"_3fIXD"},{children:n}),void 0)]}),t)}const ue="_3SDL7",de=[{description:"Large photo (2.8MB)",url:re,icon:ie},{description:"Artwork (408KB)",url:ae,icon:oe},{description:"Colorful text (68KB)",url:ce,icon:se}],fe=new AbortController;function he(e){const{onCancel:n,onFileChange:t}=e,r=function(){const[e,n]=(0,c.useState)(!1),t=(0,c.useRef)(0);return{isInArea:e,enter:function(){n(++t.current>0)},leave:function(){n(--t.current>0)},reset:function(){t.current=0,n(!1)}}}(),a=(0,c.useRef)(fe),[o,s]=(0,c.useState)("");function l(e){w(e).then((n=>t(e,n))).catch((()=>s("Can not decode file as image.")))}async function u(e){const n=new AbortController;a.current.abort(),a.current=n;const{signal:t}=n;try{l(await async function(e,n){const t=await fetch(e,{signal:n}),r=await t.blob(),i=/[^;]*/.exec(r.type)[0],a=new URL(e).pathname.split("/").pop()||"image",o=t.headers.get("last-modified"),s=o?new Date(o).getTime():void 0;return new File([r],a,{type:i,lastModified:s})}(e,t))}catch(e){if("AbortError"!==e.name)throw e}}const d=de.map((e=>(0,c.createElement)(le,Object.assign({},e,{key:e.url,onClick:u}))));return(0,i.jsxs)(K,Object.assign({onClose:n},{children:[(0,i.jsxs)("div",Object.assign({className:"dialog-content"},{children:[(0,i.jsxs)("label",Object.assign({className:(0,A.Z)("_3uHix",{_2jvwR:r.isInArea}),tabIndex:0,onDragEnter:r.enter,onDragOver:e=>e.preventDefault(),onDrop:function(e){e.preventDefault(),r.reset(),a.current.abort();const{items:n}=e.dataTransfer,t=n[0].getAsFile();t?l(t):s("The dropped item is not a file")},onDragLeave:r.leave},{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",Object.assign({className:"wYvdR"},{children:(0,i.jsx)(O.Z,{},void 0)}),void 0),(0,i.jsx)("span",Object.assign({className:ue},{children:"Drag & drop"}),void 0)]},void 0),(0,i.jsx)("div",Object.assign({className:ue},{children:"Or select an image"}),void 0),(0,i.jsx)("input",{className:"_3-brh",name:"file",type:"file",accept:"image/*",onChange:function(e){a.current.abort();const{files:n}=e.currentTarget;(null==n?void 0:n.length)&&l(n[0])}},void 0)]}),void 0),(0,i.jsx)("span",Object.assign({className:"_2Sr67"},{children:"Or try one of these:"}),void 0),(0,i.jsx)("div",Object.assign({className:"_3BC6E"},{children:d}),void 0)]}),void 0),(0,i.jsxs)("div",Object.assign({className:"dialog-actions"},{children:[(0,i.jsx)("span",Object.assign({className:"Qed9H"},{children:o}),void 0),(0,i.jsx)(Z,Object.assign({color:"second",onClick:n},{children:"Back"}),void 0)]}),void 0)]}),void 0)}function pe(e){const{file:n}=e,{width:t,height:r,data:a}=e.image,o=(n.size/a.byteLength*100).toFixed(2);return(0,i.jsxs)("div",Object.assign({className:"dialog-content"},{children:[(0,i.jsx)("canvas",{className:"WKrzW",ref:function(n){if(!n)return;const t=n.getContext("2d");null==t||t.putImageData(e.image,0,0)},width:t,height:r},void 0),(0,i.jsxs)("dl",Object.assign({className:"lL9Er"},{children:[(0,i.jsx)("dt",{children:"File name:"},void 0),(0,i.jsx)("dd",{children:n.name},void 0),(0,i.jsx)("dt",{children:"Type:"},void 0),(0,i.jsx)("dd",{children:n.type},void 0),(0,i.jsx)("dt",{children:"Resolution:"},void 0),(0,i.jsxs)("dd",{children:[t," x ",r]},void 0),(0,i.jsx)("dt",{children:"Raw size:"},void 0),(0,i.jsx)("dd",{children:h(a.byteLength)},void 0),(0,i.jsx)("dt",{children:"File size:"},void 0),(0,i.jsxs)("dd",{children:[h(n.size)," (",o,"%)"]},void 0)]}),void 0)]}),void 0)}t(9650),t(8059);const ve={hfAsymmetry:1,goodQualitySeek:1.5,badQualitySeek:.5},ge={form:"_3_OKa dialog-content",field:"_2vX3s",inlineLabel:"_2MSGh",label:"ba7J1"};function me(e){const{options:n,onChange:t}=e;function r(e){const{name:r,valueAsNumber:i}=e.currentTarget;t({...n,[r]:i})}const a=Object.entries(n).map((([e,n])=>(0,i.jsxs)("label",Object.assign({className:ge.field},{children:[(0,i.jsx)("span",Object.assign({className:ge.label},{children:e}),void 0),(0,i.jsx)(Y,{className:ge.value,name:e,min:0,step:.1,value:n,onChange:r},void 0)]}),e)));return(0,i.jsx)("fieldset",Object.assign({className:"subfields"},{children:a}),void 0)}function be(e){const{workerCount:n,onWorkerCountChange:t,onMeasureChange:r}=e,{time:a,SSIM:o,PSNR:s,butteraugli:l}=e.options,[u,d]=(0,c.useState)(ve);let f=null;function h(n){const{name:t,checked:i}=n.currentTarget,a="butteraugli"!==t?i:i&&u;r({...e.options,[t]:a})}return l&&(f=(0,i.jsx)(me,{options:u,onChange:d},void 0)),(0,i.jsxs)("form",Object.assign({className:ge.form},{children:[(0,i.jsxs)("label",{children:[(0,i.jsx)("span",Object.assign({className:ge.inlineLabel},{children:"Worker count:"}),void 0),(0,i.jsx)(Y,{value:n,min:1,step:1,onChange:e=>t(e.target.valueAsNumber)},void 0)]},void 0),(0,i.jsx)(ne,Object.assign({checked:o,name:"SSIM",onChange:h},{children:"Calculate SSIM"}),void 0),(0,i.jsx)(ne,Object.assign({checked:s,name:"PSNR",onChange:h},{children:"Calculate PSNR"}),void 0),(0,i.jsx)(ne,Object.assign({checked:!!l,name:"butteraugli",onChange:h},{children:"Calculate Butteraugli"}),void 0),f]}),void 0)}const ye="_29qBc";var je=t(6293),xe=t(659);const we={variableGroup:"_33pnL controls",radioButtonGroup:"_1SeOc",field:"_3BEoo",active:"_13aJ6"};function Ae(e){const{property:n,label:t,enumObject:r,defaultValue:a}=e;function o(e){var t;const{state:o,onChange:s}=e,c=null!==(t=o.values[n])&&void 0!==t?t:a,l=Object.keys(r).map((e=>(0,i.jsx)(te,Object.assign({name:e,checked:c===e,onChange:()=>function(e){const t={...o};t.values[n]=e,s(t)}(e)},{children:e}),e)));return(0,i.jsx)("div",{children:l},void 0)}return{id:n,ValueField:function(e){var r,o;const{state:s,onChange:c,onFocus:l}=e,u=null!==(r=s.variables[n])&&void 0!==r?r:[],d=null!==(o=s.values[n])&&void 0!==o?o:a,f=Object.keys(u).map((e=>(0,i.jsx)(te,Object.assign({name:e,checked:d===e,onChange:()=>c(e)},{children:e}),e)));return(0,i.jsxs)("label",Object.assign({onFocus:l},{children:[(0,i.jsxs)("p",{children:[t,(0,i.jsx)("span",Object.assign({className:we.optionValue},{children:d}),void 0)]},void 0),(0,i.jsx)("div",{children:f},void 0)]}),void 0)},OptionField:function(e){var a;const{state:s,onChange:c}=e,l=s.varNames.includes(n),u=null!==(a=s.variables[n])&&void 0!==a?a:[],d=Object.entries(r).map((e=>{const[n,t]=e;return(0,i.jsx)(ne,Object.assign({name:n,checked:u.includes(n)},{children:n}),n)}));return(0,i.jsxs)("fieldset",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(ne,{checked:l,onChange:function(e){e.currentTarget.checked?s.varNames.push(n):s.varNames=s.varNames.filter((e=>e!=n)),c({...s})}},void 0),(0,i.jsx)("span",{children:t},void 0)]},void 0),l?(0,i.jsx)("div",{children:d},void 0):o(e)]},void 0)},generate:function(e,t){const{varNames:i,values:a,variables:o}=e;if(i.includes(n)){const e=o[n],i=[];for(const a of e)i.push({...t,[n]:r[a]});return i}return t[n]=r[a[n]],[t]}}}const Oe={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0},Ce={spinner:"_1qBIvUTIPlLZjVhWjUUAx4"};function Ne(e){const{property:n,label:t,min:r,max:a,step:o,defaultValue:s}=e;function c(e){var t;const{state:c,onChange:l}=e,u=null!==(t=c.values[n])&&void 0!==t?t:s;return(0,i.jsxs)("label",{children:[(0,i.jsx)(H,{value:u,min:r,max:a,step:o,onChange:function(e){const t=e.currentTarget.valueAsNumber,r={...c};r.values[n]=t,l(r)}},void 0),(0,i.jsx)("span",{children:u},void 0)]},void 0)}function l(t){var s;const{state:c,onChange:l}=t,u=null!==(s=c.variables[n])&&void 0!==s?s:e,{min:d,max:f,step:h}=u;function p(e){const{valueAsNumber:t,name:r}=e.currentTarget;u[r]=t;const i={...c};i.variables[n]=u,l(i)}return(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",Object.assign({className:Ce.spinner},{children:[(0,i.jsx)("span",{children:"from:"},void 0),(0,i.jsx)(Y,{name:"min",value:d,min:r,max:a,step:o,onChange:p},void 0)]}),void 0),(0,i.jsxs)("label",Object.assign({className:Ce.spinner},{children:[(0,i.jsx)("span",{children:"to:"},void 0),(0,i.jsx)(Y,{name:"max",value:f,min:r,max:a,step:o,onChange:p},void 0)]}),void 0),(0,i.jsxs)("label",Object.assign({className:Ce.spinner},{children:[(0,i.jsx)("span",{children:"step:"},void 0),(0,i.jsx)(Y,{name:"step",value:h,min:r,max:a,step:o,onChange:p},void 0)]}),void 0)]},void 0)}return{id:n,ValueField:function(r){var a,o;const{state:c,onChange:l,onFocus:u}=r,d=null!==(a=c.variables[n])&&void 0!==a?a:e,{min:f,max:h,step:p}=d,v=null!==(o=c.values[n])&&void 0!==o?o:s;return(0,i.jsxs)("label",Object.assign({onFocus:u},{children:[(0,i.jsxs)("p",{children:[t,(0,i.jsx)("span",Object.assign({className:Ce.optionValue},{children:v}),void 0)]},void 0),(0,i.jsx)(H,{value:v,min:f,max:h,step:p,onChange:function(e){l(e.currentTarget.valueAsNumber)}},void 0)]}),void 0)},OptionField:function(e){const{state:r,onChange:a}=e,o=r.varNames.includes(n);return(0,i.jsxs)("fieldset",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(ne,{checked:o,onChange:function(e){e.currentTarget.checked?r.varNames.push(n):r.varNames=r.varNames.filter((e=>e!=n)),a({...r})}},void 0),(0,i.jsx)("span",{children:t},void 0)]},void 0),o?l(e):c(e)]},void 0)},generate:function(e,t){const{varNames:r,values:i,variables:a}=e;if(r.includes(n)){const{min:e,max:r,step:i}=a[n],o=[];for(let a=e;a<=r;a+=i)o.push({...t,[n]:a});return o}return t[n]=i[n],[t]}}}function _e(e){const{property:n,label:t,defaultValue:r}=e;function a(e){var a;const{state:o,onChange:s}=e,c=null!==(a=o.values[n])&&void 0!==a?a:r;return(0,i.jsx)(ne,Object.assign({checked:c,onChange:function(e){const t={...o};t.values[n]=e.currentTarget.checked,s(t)}},{children:t}),void 0)}return{id:n,ValueField:function(e){var a;const{state:o,onChange:s,onFocus:c}=e,l=null!==(a=o.values[n])&&void 0!==a?a:r;return(0,i.jsxs)("label",Object.assign({onFocus:c},{children:[(0,i.jsx)(ne,Object.assign({checked:l,onChange:function(e){s(e.currentTarget.checked)}},{children:t}),void 0),";"]}),void 0)},OptionField:function(e){const{state:r,onChange:o}=e,s=r.varNames.includes(n);return(0,i.jsxs)("fieldset",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(ne,{checked:s,onChange:function(e){e.currentTarget.checked?r.varNames.push(n):r.varNames=r.varNames.filter((e=>e!=n)),o({...r})}},void 0),(0,i.jsx)("span",{children:t},void 0)]},void 0),s?(0,i.jsx)("strong",{children:"OFF & ON"},void 0):a(e)]},void 0)},generate:function(e,t){const{varNames:r,values:i}=e;return r.includes(n)?[{...t,[n]:!1},{...t,[n]:!0}]:(t[n]=i[n],[t])}}}const Se="WebP",ke="image/webp",Te="webp";function Ee(){return{varNames:[],values:Oe,variables:{}}}const Pe=[_e({property:"lossless",label:"lossless",defaultValue:Oe.lossless}),Ne({property:"quality",label:"Quality (-q)",min:0,max:100,step:1,defaultValue:Oe.quality}),Ne({property:"method",label:"Method (-m)",min:0,max:6,step:1,defaultValue:Oe.method}),Ne({property:"sns",label:"Spatial noise shaping (-sns)",min:0,max:100,step:1,defaultValue:Oe.sns}),Ae({property:"preset",label:"Preset (-preset)",enumObject:{default:{},photo:{sns_strength:80,filter_sharpness:3,filter_strength:30,preprocessing:2},picture:{sns_strength:80,filter_sharpness:4,filter_strength:35,preprocessing:-3},drawing:{sns_strength:25,filter_sharpness:6,filter_strength:10},icon:{sns_strength:25,filter_strength:10,preprocessing:-3},text:{sns_strength:0,filter_strength:0,segments:2,preprocessing:-3}},defaultValue:"default"}),_e({property:"filter_type",label:"User strong filter (-strong)",defaultValue:Oe.filter_type}),Ne({property:"filter_strength",label:"Filter strength (-f)",min:0,max:100,step:1,defaultValue:Oe.filter_strength}),_e({property:"autofilter",label:"Auto adjust filter strength (-af)",defaultValue:Oe.autofilter}),Ne({property:"filter_sharpness",label:"Filter sharpness (-sharpness)",min:0,max:7,step:1,defaultValue:Oe.filter_sharpness}),Ae({property:"image_hint",label:"Hint (-hint)",enumObject:{DEFAULT:0,PICTURE:1,PHOTO:2,GRAPH:3},defaultValue:"DEFAULT"})];function Ie(e){const{state:n=Ee(),onChange:t}=e,r=Pe.map((({id:e,OptionField:r})=>(0,i.jsx)(r,{state:n,onChange:t},e)));return(0,i.jsx)(i.Fragment,{children:r},void 0)}function Fe(e){const{state:n,onChange:t,onSeriesChange:r}=e,[a,o]=(0,c.useState)(n.values),s={...n,values:a},l=Pe.filter((e=>n.varNames.includes(e.id))).map((({id:e,ValueField:c})=>(0,i.jsx)(c,{state:s,onFocus:function(){const t=[e],i=Re({...n,varNames:t,values:a});r(i)},onChange:function(r){const i={...a,[e]:r};o(i);const s=Re({...n,varNames:[],values:i});t(s[0])}},e)));return(0,i.jsx)(i.Fragment,{children:l},void 0)}function Re(e){let n=[{...Oe}];for(const t of Pe)n=t.generate(e,n[0]);return n}function Be(e,n){return n.webpEncode(e)}const We=[r],Me=Object.fromEntries(We.map((e=>[e.name,e])));function Ue(e){const[n,t]=(0,c.useState)(We),[r,a]=(0,c.useState)(e.value),[o,s]=(0,c.useState)(We[0]),l=n.map(((e,r)=>{const a=(0,A.Z)("_2SlrA",{_1krxL:e===o});return(0,i.jsxs)("div",Object.assign({className:a,onClick:()=>s(e)},{children:[(0,i.jsx)(z,Object.assign({className:"_3doEr",onClick:function(i){i.stopPropagation(),n.splice(r,1),t([...n]),e===o&&s(n[0])}},{children:(0,i.jsx)(xe.Z,{},void 0)}),void 0),(0,i.jsx)("span",Object.assign({className:"_2G5o7"},{children:e.name}),void 0)]}),e.name)})),{OptionsPanel:u}=o;return(0,i.jsxs)("div",Object.assign({className:"_1LeZ1 dialog-content"},{children:[(0,i.jsxs)("div",Object.assign({className:"_1IVOA"},{children:[l,(0,i.jsx)(z,Object.assign({title:"Add encoder",className:"_265Bb _2SlrA",onClick:function(){}},{children:(0,i.jsx)(je.Z,{},void 0)}),void 0)]}),void 0),(0,i.jsx)(u,{state:r[o.name],onChange:function(n){const t={...r,[o.name]:n};a(t),e.onChange(t)}},void 0)]}),void 0)}function De(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:"Resize:"},void 0),(0,i.jsxs)("select",{children:[(0,i.jsx)("option",{children:"100"},void 0),(0,i.jsx)("option",{children:"50"},void 0),(0,i.jsx)("option",{children:"25"},void 0),(0,i.jsx)("option",{children:"12.5"},void 0),(0,i.jsx)("option",{children:"6.25"},void 0)]},void 0)]},void 0)}function Le(e){const{file:n,image:t,onStart:r,onClose:a,onSelectFile:o}=e,[s,l]=(0,c.useState)({}),[u,d]=(0,c.useState)({}),[f,h]=(0,c.useState)(navigator.hardwareConcurrency),[p,v]=(0,c.useState)({time:!1,SSIM:!1,PSNR:!0,butteraugli:!1}),[g,m]=(0,c.useState)(0),b=["Information","Preprocess","Encoders","Measure"],y=[];for(let e=0;e<b.length;e++){const n=b[e],t=e===g?(0,A.Z)(ye,"wG4Ax"):ye;y.push((0,i.jsx)("div",Object.assign({className:t,onClick:()=>m(e)},{children:n}),e))}let j;switch(g){case 0:j=(0,i.jsx)(pe,{file:n,image:t},void 0);break;case 1:j=(0,i.jsx)(De,{onChange:d},void 0);break;case 2:j=(0,i.jsx)(Ue,{value:s,onChange:l},void 0);break;case 3:j=(0,i.jsx)(be,{workerCount:f,options:p,onWorkerCountChange:h,onMeasureChange:v},void 0);break;default:throw new Error}const x=n&&Object.keys(s).length;return(0,i.jsxs)(K,Object.assign({className:"_6sryz",onClose:a},{children:[(0,i.jsx)("div",Object.assign({className:"_3x7vU"},{children:y}),void 0),j,(0,i.jsxs)("div",Object.assign({className:"dialog-actions"},{children:[(0,i.jsx)(Z,Object.assign({onClick:o},{children:"Select file..."}),void 0),(0,i.jsx)(Z,Object.assign({color:"second",onClick:a},{children:"Cancel"}),void 0),(0,i.jsx)(Z,Object.assign({disabled:!x,onClick:function(){r({encode:s,preprocess:{},measure:p,threads:f})}},{children:"Start"}),void 0)]}),void 0)]}),void 0)}const Ve=new Intl.RelativeTimeFormat("en");function ze(e,n,t){return(t-n)/n*(performance.now()-e)}function He(e){const{value:n,max:t,onCancel:r}=e,[a]=(0,c.useState)((()=>performance.now())),o=(0,c.useMemo)((()=>function(e,n){let t,r=!1;return function(...e){return r?t:(r=!0,setTimeout((()=>r=!1),500),t=n.apply(this,e))}}(0,ze)),[])(a,n,t),s=Number.isNaN(o)?"----":Ve.format(~~(o/1e3),"seconds");return(0,i.jsxs)(K,{children:[(0,i.jsxs)("div",Object.assign({className:"_1RFbq dialog-content"},{children:[(0,i.jsx)("h1",{children:"Encoding..."},void 0),(0,i.jsxs)("div",Object.assign({className:"_3vxdS"},{children:[(0,i.jsxs)("span",{children:[n," / ",t]},void 0),(0,i.jsx)("span",{children:s},void 0)]}),void 0),(0,i.jsx)("progress",{value:n,max:t,className:"mrzz8"},void 0)]}),void 0),(0,i.jsx)("div",Object.assign({className:"_3UNgR dialog-actions"},{children:(0,i.jsx)(Z,Object.assign({color:"second",onClick:r},{children:" Cancel "}),void 0)}),void 0)]},void 0)}function Ze(e){const[n,t]=(0,c.useState)(),[r,a]=(0,c.useState)(),[o,s]=(0,c.useState)(!0),[l,u]=(0,c.useState)(null),[d,f]=(0,c.useState)(1),[h,p]=(0,c.useState)(0);return e.open?l?(0,i.jsx)(He,{value:h,max:d,onCancel:function(){l.terminate(),u(null)}},void 0):o?(0,i.jsx)(he,{onCancel:function(){n?s(!1):e.onClose()},onFileChange:async function(e){const n=await w(e);t(e),a(n),s(!1)}},void 0):(0,i.jsx)(Le,{image:r,file:n,onSelectFile:()=>s(!0),onClose:e.onClose,onStart:async function(t){if(!n)throw new Error("File is null");const{preprocess:i,encode:a,threads:o,measure:s}=t,c=[await w(n)];for(const[e,n]of Object.entries(i));We.map((e=>e.name)).filter((e=>e in a));let l=0;const d=[];for(const e of We){const{name:n,getOptionsList:t}=e,r=a[n];if(!r)continue;const i=t(r);d.push([e,i]),l+=i.length}f(c.length*l),p(0);const h=new Map;for(const e of c){const n=new Map;h.set(e,n);for(const[t,r]of d){const i=new Map;n.set(t.name,i);const a=new g(e,{encoder:t,threads:o,optionsList:r,measure:s});u(a);const c=await a.encode();a.terminate(),u(null);for(let e=0;e<r.length;e++){const n=JSON.stringify(r[e]);i.set(n,c[e])}}}e.onChange({state:a,map:h,original:{file:n,data:r}})}},void 0):null}function Ge(e){const{onStart:n}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("section",{children:(0,i.jsx)(Z,Object.assign({onClick:n},{children:"Try it!"}),void 0)},void 0),(0,i.jsx)("section",{children:"TODO"},void 0)]},void 0)}var Ye=t(6551),Xe=t(3937),$e=t(7174);function qe(){return(qe=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var Ke=c.createElement("path",{d:"M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"});const Qe=function(e){return c.createElement("svg",qe({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 438.549 438.549",fill:"currentColor"},e),Ke)},Je={container:"_3kS7K",inputs:"_1Tvc7 controls",imageView:"_1iZci",wrapper:"_2sQef",canvas:"_1YBWC"};var en;function nn(e,n){if(null===n.current)throw new Error("Canvas is null");const t=n.current.getContext("2d");if(!t)throw new Error("Canvas not initialized");t.putImageData(e,0,0)}function tn(e){const{original:n,optimized:t}=e,{width:r=0,height:a=0}=n.data||{},[o,s]=(0,c.useState)(en.Compressed),[l,u]=(0,c.useState)(100),[d,f]=(0,c.useState)({x:0,y:0,scale:1}),h=(0,c.useRef)(null),p=(0,c.useRef)(null);function v(e){const{children:n,target:t,disabled:r,title:a}=e;return(0,i.jsx)(z,Object.assign({active:o===t,disabled:r,title:a,onClick:()=>s(t)},{children:n}),void 0)}(0,c.useEffect)((function(){f({x:0,y:0,scale:1}),nn(n.data,h)}),[n]),(0,c.useEffect)((function(){const{metrics:e,data:n}=t;nn(o===en.HeatMap?e.butteraugli.heatMap:n,p)}),[o,t]);let g=null,m=100;o===en.AbsDiff&&(m=l,g=(0,i.jsxs)("label",{children:["Brightness:",(0,i.jsx)(Y,{value:l,min:100,step:50,onValueChange:u},void 0)]},void 0));const b={width:r,height:a,"--scale":d.scale,"--x":d.x+"px","--y":d.y+"px","--brightness":`${m}%`},y=o===en.AbsDiff?"difference":void 0,j=!t.metrics.butteraugli,x=j?"You should enable butteraugli to see this":void 0;return(0,i.jsxs)("div",Object.assign({className:Je.container},{children:[(0,i.jsxs)("div",Object.assign({className:Je.inputs},{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(v,Object.assign({target:en.Original},{children:"Original"}),void 0),(0,i.jsx)(v,Object.assign({target:en.Compressed},{children:"Output"}),void 0),(0,i.jsx)(v,Object.assign({target:en.AbsDiff},{children:"Difference"}),void 0),(0,i.jsx)(v,Object.assign({disabled:j,title:x,target:en.HeatMap},{children:"HeatMap"}),void 0)]},void 0),g]}),void 0),(0,i.jsx)("div",{className:Je.controls},void 0),(0,i.jsx)(Q,Object.assign({className:Je.imageView,state:d,onChange:f},{children:(0,i.jsxs)("div",Object.assign({className:Je.wrapper,style:b},{children:[(0,i.jsx)("canvas",{className:Je.canvas,ref:h,width:r,height:a},void 0),(0,i.jsx)("canvas",{className:Je.canvas,ref:p,width:r,height:a,style:{mixBlendMode:y},hidden:o===en.Original},void 0)]}),void 0)}),void 0)]}),void 0)}!function(e){e[e.Original=0]="Original",e[e.Compressed=1]="Compressed",e[e.AbsDiff=2]="AbsDiff",e[e.HeatMap=3]="HeatMap"}(en||(en={}));var rn=t(4085);function an(e){const{original:n,outputs:t,index:r}=e,[a,o]=(0,c.useState)();return(0,c.useEffect)((()=>{if(!a)return;a.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:r});const e=a.getOption().series;a.setOption({legend:{formatter:n=>{const t=e.filter((e=>e.name===n));return`${n}: ${t[0].data[r].toFixed(2)}`},data:a.getOption().legend.data}})})),(0,i.jsx)("section",Object.assign({className:"_3T5Kh"},{children:(0,i.jsx)("div",{className:"JAZV5",ref:function(e){if(e&&!a){const r=(0,rn.S1)(e,"dark",{renderer:"svg"});o(r),function(e,n,t){const r=[],i=[],a=[];let o=0;function s(e,n){if(void 0===n(t[0]))return;const s=t.map(n);r.push(e),i.push({type:"value",show:!1}),a.push({name:e,type:"line",data:s,yAxisIndex:o++})}const c=n.file.size/100;s("Compression Ratio %",(e=>e.buffer.byteLength/c)),i[0].show=!0,s("Encode Time (ms)",(e=>e.time)),s("SSIM",(e=>e.metrics.SSIM)),s("PSNR (db)",(e=>e.metrics.PSNR)),s("Butteraugli Source",(e=>{var n;return null===(n=e.metrics.butteraugli)||void 0===n?void 0:n.source})),e.setOption({tooltip:{trigger:"axis",showContent:!1,triggerOn:"none"},legend:{data:r},xAxis:{data:t.map(((e,n)=>n))},yAxis:i,series:a,backgroundColor:"transparent"})}(r,n,t)}}},void 0)}),void 0)}function on(e){const{children:n}=e,t=(0,A.Z)(we.field);return(0,i.jsx)("div",Object.assign({className:t,onClick:()=>{}},{children:n}),void 0)}function sn(e){const{result:n,onImageChange:t,onSeriesChange:r,onOutputChange:a}=e,{state:o,map:s,original:l}=n,u=s.get(l.data),[d,f]=(0,c.useState)((()=>u.keys().next().value)),h=Object.entries(u).map((e=>{const[n,t]=e;return(0,i.jsx)("option",Object.assign({value:n},{children:n}),n)})),p=Me[d];return(0,i.jsxs)("div",Object.assign({className:we.variableGroup},{children:[(0,i.jsx)(p.Controls,{state:o[d],onChange:e=>a(u.get(d).get(JSON.stringify(e))),onSeriesChange:function(e){const n=u.get(d);r(e.map((e=>n.get(JSON.stringify(e)))))}},void 0),h.length>1&&(0,i.jsx)(on,{children:(0,i.jsx)(ee,Object.assign({value:d,onChange:function(e){f(e.currentTarget.value)}},{children:h}),void 0)},void 0)]}),void 0)}const cn="_3RfWA";function ln(e){const{title:n,buffer:t,filename:r,children:a}=e,{mimeType:o,extension:s}=e.codec,[l,u]=(0,c.useState)("");return(0,c.useEffect)((()=>()=>URL.revokeObjectURL(l)),[]),(0,i.jsx)(z,Object.assign({className:cn,title:n,disabled:!t,onClick:function(){const e=new Blob([t],{type:o});URL.revokeObjectURL(l);const n=URL.createObjectURL(e);u(n);const i=document.createElement("a");i.href=n,i.download=r.replace(/.[^.]*$/,`.${s}`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}},{children:a}),void 0)}function un(e){var n;const{result:t,onStart:r}=e,[a,o]=(0,c.useState)(!0),[s,l]=(0,c.useState)(t.map.keys().next().value),[u,d]=(0,c.useState)([]),[f,h]=(0,c.useState)(),p=u.indexOf(f);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tn,Object.assign({},t,{optimized:f}),void 0),a&&(0,i.jsx)(an,{original:t.original,outputs:u,index:p},void 0),(0,i.jsxs)("div",Object.assign({className:"_3BYoV controls"},{children:[(0,i.jsx)(z,Object.assign({title:"Fork me from GitHub",href:"https://github.com/Kaciras/ICAnalyze",className:cn},{children:(0,i.jsx)(Qe,{},void 0)}),void 0),(0,i.jsx)(z,Object.assign({title:"Select an image",className:cn,onClick:r},{children:(0,i.jsx)(Ye.Z,{},void 0)}),void 0),(0,i.jsx)(z,Object.assign({title:"Show chart",className:cn,active:a,onClick:()=>o(!a)},{children:(0,i.jsx)(Xe.Z,{},void 0)}),void 0),(0,i.jsx)(ln,Object.assign({title:"Download compressed image",filename:null===(n=t.original)||void 0===n?void 0:n.file.name,codec:WebP,buffer:null==f?void 0:f.buffer},{children:(0,i.jsx)($e.Z,{},void 0)}),void 0)]}),void 0),(0,i.jsx)(sn,{result:t,onImageChange:l,onSeriesChange:d,onOutputChange:h},void 0)]},void 0)}(function(){try{new File([],"")}catch{return!1}return!!CSS.supports("mix-blend-mode: difference")&&"AbortController"in window})()||alert("ICAnalyze does not support this browser, please switch to a modern one"),o.S({dsn:"https://d101904fac2c486ea6f8563c2cf054af@o253601.ingest.sentry.io/5499968",integrations:[new s.jK.BrowserTracing],tracesSampleRate:.2}),a.render((0,i.jsx)((function(){const[e,n]=(0,c.useState)(!1),[t,r]=(0,c.useState)(),a=()=>n(!1);return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsx)(un,{result:t,onStart:a},void 0):(0,i.jsx)(Ge,{onStart:a},void 0),(0,i.jsx)(Ze,{open:e,onChange:function(e){n(!1),r(e)},onClose:()=>n(!1)},void 0)]},void 0)}),{},void 0),document.getElementById("root"))},8877:(e,n,t)=>{"use strict";e.exports=t.p+"artwork-icon.bc259.jpg"},9573:(e,n,t)=>{"use strict";e.exports=t.p+"artwork.b7c32.jpg"},7721:(e,n,t)=>{"use strict";e.exports=t.p+"colorful-text-icon.75a8e.png"},5185:(e,n,t)=>{"use strict";e.exports=t.p+"colorful-text.b5bb7.png"},2993:()=>{},1386:()=>{}},n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={id:r,loaded:!1,exports:{}};return e[r](i,i.exports,t),i.loaded=!0,i.exports}t.m=e,t.x=e=>{},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.u=e=>e+".js",t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),(()=>{t.b=document.baseURI||self.location.href;var e={826:0},n=[[1614,783]],r=e=>{},i=(i,a)=>{for(var o,s,[c,l,u,d]=a,f=0,h=[];f<c.length;f++)s=c[f],t.o(e,s)&&e[s]&&h.push(e[s][0]),e[s]=0;for(o in l)t.o(l,o)&&(t.m[o]=l[o]);for(u&&u(t),i&&i(a);h.length;)h.shift()();return d&&n.push.apply(n,d),r()},a=self.webpackChunkic_analyze=self.webpackChunkic_analyze||[];function o(){for(var r,i=0;i<n.length;i++){for(var a=n[i],o=!0,s=1;s<a.length;s++){var c=a[s];0!==e[c]&&(o=!1)}o&&(n.splice(i--,1),r=t(t.s=a[0]))}return 0===n.length&&(t.x(),t.x=e=>{}),r}a.forEach(i.bind(null,0)),a.push=i.bind(null,a.push.bind(a));var s=t.x;t.x=()=>(t.x=s||(e=>{}),(r=o)())})(),t.x()})();
//# sourceMappingURL=index.js.map
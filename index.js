(()=>{var e={964:(e,t,n)=>{var r,a=(r=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,a,i;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){a=e,i=t}));var o,l,c,s,u,m={};for(o in t)t.hasOwnProperty(o)&&(m[o]=t[o]);l="object"==typeof window,c="function"==typeof importScripts,s="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,u=!l&&!s&&!c;var f,d,p,h,g="";s?(g=c?n(1386).dirname(g)+"/":"//",f=function(e,t){return p||(p=n(2993)),h||(h=n(1386)),e=h.normalize(e),p.readFileSync(e,t?null:"utf8")},d=function(e){return(e=f(e,!0)).buffer||(e=new Uint8Array(e)),_(e.buffer),e},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){throw e})),process.on("unhandledRejection",X),t.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(f=function(e){return read(e)}),d=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(_("object"==typeof(e=read(e,"binary"))),e)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(l||c)&&(c?g=self.location.href:document.currentScript&&(g=document.currentScript.src),r&&(g=r),g=0!==g.indexOf("blob:")?g.substr(0,g.lastIndexOf("/")+1):"",f=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(d=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var v,y=t.print||console.log.bind(console),A=t.printErr||console.warn.bind(console);for(o in m)m.hasOwnProperty(o)&&(t[o]=m[o]);m=null,t.wasmBinary&&(v=t.wasmBinary),t.noExitRuntime&&t.noExitRuntime,"object"!=typeof WebAssembly&&X("no native wasm support detected");var b,E=new WebAssembly.Table({initial:50,maximum:50,element:"anyfunc"}),w=!1;function _(e,t){e||X("Assertion failed: "+t)}var C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(e,t,n){var r=t+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.subarray&&C)return C.decode(e.subarray(t,n));for(r="";t<n;){var a=e[t++];if(128&a){var i=63&e[t++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|i);else{var o=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&e[t++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}var S,T,N,k,I,P,R,O,B,F="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function W(e,t){for(var n=e>>1,r=n+t/2;!(n>=r)&&I[n];)++n;if(32<(n<<=1)-e&&F)return F.decode(N.subarray(e,n));for(n=0,r="";;){var a=k[e+2*n>>1];if(0==a||n==t/2)return r;++n,r+=String.fromCharCode(a)}}function M(e,t,n){if(void 0===n&&(n=2147483647),2>n)return 0;var r=t;n=(n-=2)<2*e.length?n/2:e.length;for(var a=0;a<n;++a)k[t>>1]=e.charCodeAt(a),t+=2;return k[t>>1]=0,t-r}function j(e){return 2*e.length}function U(e,t){for(var n=0,r="";!(n>=t/4);){var a=P[e+4*n>>2];if(0==a)break;++n,65536<=a?(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a)):r+=String.fromCharCode(a)}return r}function D(e,t,n){if(void 0===n&&(n=2147483647),4>n)return 0;var r=t;n=r+n-4;for(var a=0;a<e.length;++a){var i=e.charCodeAt(a);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++a)),P[t>>2]=i,(t+=4)+4>n)break}return P[t>>2]=0,t-r}function V(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);55296<=r&&57343>=r&&++n,t+=4}return t}function L(e){S=e,t.HEAP8=T=new Int8Array(e),t.HEAP16=k=new Int16Array(e),t.HEAP32=P=new Int32Array(e),t.HEAPU8=N=new Uint8Array(e),t.HEAPU16=I=new Uint16Array(e),t.HEAPU32=R=new Uint32Array(e),t.HEAPF32=O=new Float32Array(e),t.HEAPF64=B=new Float64Array(e)}var z=t.INITIAL_MEMORY||16777216;(b=t.wasmMemory?t.wasmMemory:new WebAssembly.Memory({initial:z/65536,maximum:32768}))&&(S=b.buffer),z=S.byteLength,L(S);var H=[],Q=[],Y=[],Z=[];function G(){var e=t.preRun.shift();H.unshift(e)}var K=0,J=null,q=null;function X(e){throw t.onAbort&&t.onAbort(e),A(e),w=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),i(e),e}function $(e){var t=te;return String.prototype.startsWith?t.startsWith(e):0===t.indexOf(e)}function ee(){return $("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={};var te="metrics.wasm";if(!ee()){var ne=te;te=t.locateFile?t.locateFile(ne,g):g+ne}function re(){try{if(v)return new Uint8Array(v);if(d)return d(te);throw"both async and sync fetching of the wasm failed"}catch(e){X(e)}}function ae(e){for(;0<e.length;){var n=e.shift();if("function"==typeof n)n(t);else{var r=n.S;"number"==typeof r?void 0===n.L?E.get(r)():E.get(r)(n.L):r(void 0===n.L?null:n.L)}}}function ie(e){this.K=e-16,this.fa=function(e){P[this.K+8>>2]=e},this.ba=function(e){P[this.K+0>>2]=e},this.da=function(){P[this.K+4>>2]=0},this.aa=function(){T[this.K+12>>0]=0},this.ea=function(){T[this.K+13>>0]=0},this.X=function(e,t){this.fa(e),this.ba(t),this.da(),this.aa(),this.ea()}}function oe(){return 0<oe.N}var le={};function ce(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function se(e){return this.fromWireType(R[e>>2])}var ue={},me={},fe={};function de(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=t&&57>=t?"_"+e:e}function pe(e,t){return e=de(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function he(e){var t=Error,n=pe(e,(function(t){this.name=e,this.message=t,void 0!==(t=Error(t).stack)&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var ge=void 0;function ve(e,t,n){function r(t){if((t=n(t)).length!==e.length)throw new ge("Mismatched type converter count");for(var r=0;r<e.length;++r)_e(e[r],t[r])}e.forEach((function(e){fe[e]=t}));var a=Array(t.length),i=[],o=0;t.forEach((function(e,t){me.hasOwnProperty(e)?a[t]=me[e]:(i.push(e),ue.hasOwnProperty(e)||(ue[e]=[]),ue[e].push((function(){a[t]=me[e],++o===i.length&&r(a)})))})),0===i.length&&r(a)}function ye(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var Ae=void 0;function be(e){for(var t="";N[e];)t+=Ae[N[e++]];return t}var Ee=void 0;function we(e){throw new Ee(e)}function _e(e,t,n){if(n=n||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||we('type "'+r+'" must have a positive integer typeid pointer'),me.hasOwnProperty(e)){if(n.W)return;we("Cannot register type '"+r+"' twice")}me[e]=t,delete fe[e],ue.hasOwnProperty(e)&&(t=ue[e],delete ue[e],t.forEach((function(e){e()})))}var Ce=[],xe=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Se(e){4<e&&0==--xe[e].M&&(xe[e]=void 0,Ce.push(e))}function Te(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=Ce.length?Ce.pop():xe.length;return xe[t]={M:1,value:e},t}}function Ne(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function ke(e,t){switch(t){case 2:return function(e){return this.fromWireType(O[e>>2])};case 3:return function(e){return this.fromWireType(B[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Ie(e){var t=Function;if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var n=pe(t.name||"unknownFunctionName",(function(){}));return n.prototype=t.prototype,n=new n,(e=t.apply(n,e))instanceof Object?e:n}function Pe(e,n){var r=-1!=(e=be(e)).indexOf("j")?function(e,n){_(0<=e.indexOf("j"),"getDynCaller should only be called with i64 sigs");var r=[];return function(){r.length=arguments.length;for(var a=0;a<arguments.length;a++)r[a]=arguments[a];return-1!=e.indexOf("j")?r&&r.length?t["dynCall_"+e].apply(null,[n].concat(r)):t["dynCall_"+e].call(null,n):E.get(n).apply(null,r)}}(e,n):E.get(n);return"function"!=typeof r&&we("unknown function pointer with signature "+e+": "+n),r}var Re=void 0;function Oe(e){var t=be(e=Ye(e));return Qe(e),t}function Be(e,t,n){switch(t){case 0:return n?function(e){return T[e]}:function(e){return N[e]};case 1:return n?function(e){return k[e>>1]}:function(e){return I[e>>1]};case 2:return n?function(e){return P[e>>2]}:function(e){return R[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var Fe={},We=[];function Me(e,t){var n=me[e];return void 0===n&&we(t+" has unknown type "+Oe(e)),n}var je=[null,[],[]];ge=t.InternalError=he("InternalError");for(var Ue=Array(256),De=0;256>De;++De)Ue[De]=String.fromCharCode(De);Ae=Ue,Ee=t.BindingError=he("BindingError"),t.count_emval_handles=function(){for(var e=0,t=5;t<xe.length;++t)void 0!==xe[t]&&++e;return e},t.get_first_emval=function(){for(var e=5;e<xe.length;++e)if(void 0!==xe[e])return xe[e];return null},Re=t.UnboundTypeError=he("UnboundTypeError"),Q.push({S:function(){ze()}});var Ve={d:function(e,t,n,r){X("Assertion failed: "+(e?x(N,e,void 0):"")+", at: "+[t?t?x(N,t,void 0):"":"unknown filename",n,r?r?x(N,r,void 0):"":"unknown function"])},B:function(e){return He(e+16)+16},x:function(e,t,n){throw new ie(e).X(t,n),"uncaught_exception"in oe?oe.N++:oe.N=1,e},b:E,s:function(e){var t=le[e];delete le[e];var n=t.Z,r=t.$,a=t.O;ve([e],a.map((function(e){return e.V})).concat(a.map((function(e){return e.ha}))),(function(e){var i={};return a.forEach((function(t,n){var r=e[n],o=t.T,l=t.U,c=e[n+a.length],s=t.ga,u=t.ia;i[t.R]={read:function(e){return r.fromWireType(o(l,e))},write:function(e,t){var n=[];s(u,e,c.toWireType(n,t)),ce(n)}}})),[{name:t.name,fromWireType:function(e){var t,n={};for(t in i)n[t]=i[t].read(e);return r(e),n},toWireType:function(e,t){for(var a in i)if(!(a in t))throw new TypeError('Missing field:  "'+a+'"');var o=n();for(a in i)i[a].write(o,t[a]);return null!==e&&e.push(r,o),o},argPackAdvance:8,readValueFromPointer:se,J:r}]}))},z:function(e,t,n,r,a){var i=ye(n);_e(e,{name:t=be(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:a},argPackAdvance:8,readValueFromPointer:function(e){if(1===n)var r=T;else if(2===n)r=k;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);r=P}return this.fromWireType(r[e>>i])},J:null})},y:function(e,t){_e(e,{name:t=be(t),fromWireType:function(e){var t=xe[e].value;return Se(e),t},toWireType:function(e,t){return Te(t)},argPackAdvance:8,readValueFromPointer:se,J:null})},p:function(e,t,n){n=ye(n),_e(e,{name:t=be(t),fromWireType:function(e){return e},toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+Ne(t)+'" to '+this.name);return t},argPackAdvance:8,readValueFromPointer:ke(t,n),J:null})},r:function(e,n,r,a,i,o){var l=function(e,t){for(var n=[],r=0;r<e;r++)n.push(P[(t>>2)+r]);return n}(n,r);e=be(e),i=Pe(a,i),function(e,n,r){t.hasOwnProperty(e)?((void 0===r||void 0!==t[e].I&&void 0!==t[e].I[r])&&we("Cannot register public name '"+e+"' twice"),function(e,n){var r=t;if(void 0===r[e].I){var a=r[e];r[e]=function(){return r[e].I.hasOwnProperty(arguments.length)||we("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+r[e].I+")!"),r[e].I[arguments.length].apply(this,arguments)},r[e].I=[],r[e].I[a.P]=a}}(e,e),t.hasOwnProperty(r)&&we("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),t[e].I[r]=n):(t[e]=n,void 0!==r&&(t[e].ja=r))}(e,(function(){!function(e,t){var n=[],r={};throw t.forEach((function e(t){r[t]||me[t]||(fe[t]?fe[t].forEach(e):(n.push(t),r[t]=!0))})),new Re(e+": "+n.map(Oe).join([", "]))}("Cannot call "+e+" due to unbound types",l)}),n-1),ve([],l,(function(r){var a=[r[0],null].concat(r.slice(1)),l=r=e,c=i,s=a.length;2>s&&we("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=null!==a[1]&&!1,m=!1,f=1;f<a.length;++f)if(null!==a[f]&&void 0===a[f].J){m=!0;break}var d="void"!==a[0].name,p="",h="";for(f=0;f<s-2;++f)p+=(0!==f?", ":"")+"arg"+f,h+=(0!==f?", ":"")+"arg"+f+"Wired";l="return function "+de(l)+"("+p+") {\nif (arguments.length !== "+(s-2)+") {\nthrowBindingError('function "+l+" called with ' + arguments.length + ' arguments, expected "+(s-2)+" args!');\n}\n",m&&(l+="var destructors = [];\n");var g=m?"destructors":"null";for(p="throwBindingError invoker fn runDestructors retType classParam".split(" "),c=[we,c,o,ce,a[0],a[1]],u&&(l+="var thisWired = classParam.toWireType("+g+", this);\n"),f=0;f<s-2;++f)l+="var arg"+f+"Wired = argType"+f+".toWireType("+g+", arg"+f+"); // "+a[f+2].name+"\n",p.push("argType"+f),c.push(a[f+2]);if(u&&(h="thisWired"+(0<h.length?", ":"")+h),l+=(d?"var rv = ":"")+"invoker(fn"+(0<h.length?", ":"")+h+");\n",m)l+="runDestructors(destructors);\n";else for(f=u?1:2;f<a.length;++f)s=1===f?"thisWired":"arg"+(f-2)+"Wired",null!==a[f].J&&(l+=s+"_dtor("+s+"); // "+a[f].name+"\n",p.push(s+"_dtor"),c.push(a[f].J));if(d&&(l+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),p.push(l+"}\n"),a=Ie(p).apply(null,c),f=n-1,!t.hasOwnProperty(r))throw new ge("Replacing nonexistant public symbol");return void 0!==t[r].I&&void 0!==f?t[r].I[f]=a:(t[r]=a,t[r].P=f),[]}))},f:function(e,t,n,r,a){function i(e){return e}t=be(t),-1===a&&(a=4294967295);var o=ye(n);if(0===r){var l=32-8*n;i=function(e){return e<<l>>>l}}var c=-1!=t.indexOf("unsigned");_e(e,{name:t,fromWireType:i,toWireType:function(e,n){if("number"!=typeof n&&"boolean"!=typeof n)throw new TypeError('Cannot convert "'+Ne(n)+'" to '+this.name);if(n<r||n>a)throw new TypeError('Passing a number "'+Ne(n)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+r+", "+a+"]!");return c?n>>>0:0|n},argPackAdvance:8,readValueFromPointer:Be(t,o,0!==r),J:null})},e:function(e,t,n){function r(e){var t=R;return new a(S,t[1+(e>>=2)],t[e])}var a=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];_e(e,{name:n=be(n),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{W:!0})},q:function(e,t){var n="std::string"===(t=be(t));_e(e,{name:t,fromWireType:function(e){var t=R[e>>2];if(n)for(var r=e+4,a=0;a<=t;++a){var i=e+4+a;if(a==t||0==N[i]){if(r=r?x(N,r,i-r):"",void 0===o)var o=r;else o+=String.fromCharCode(0),o+=r;r=i+1}}else{for(o=Array(t),a=0;a<t;++a)o[a]=String.fromCharCode(N[e+4+a]);o=o.join("")}return Qe(e),o},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r="string"==typeof t;r||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||we("Cannot pass non-string to std::string");var a=(n&&r?function(){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&t.charCodeAt(++n)),127>=r?++e:e=2047>=r?e+2:65535>=r?e+3:e+4}return e}:function(){return t.length})(),i=He(4+a+1);if(R[i>>2]=a,n&&r)!function(e,t,n){var r=N;if(0<n){n=t+n-1;for(var a=0;a<e.length;++a){var i=e.charCodeAt(a);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++a)),127>=i){if(t>=n)break;r[t++]=i}else{if(2047>=i){if(t+1>=n)break;r[t++]=192|i>>6}else{if(65535>=i){if(t+2>=n)break;r[t++]=224|i>>12}else{if(t+3>=n)break;r[t++]=240|i>>18,r[t++]=128|i>>12&63}r[t++]=128|i>>6&63}r[t++]=128|63&i}}r[t]=0}}(t,i+4,a+1);else if(r)for(r=0;r<a;++r){var o=t.charCodeAt(r);255<o&&(Qe(i),we("String has UTF-16 code units that do not fit in 8 bits")),N[i+4+r]=o}else for(r=0;r<a;++r)N[i+4+r]=t[r];return null!==e&&e.push(Qe,i),i},argPackAdvance:8,readValueFromPointer:se,J:function(e){Qe(e)}})},j:function(e,t,n){if(n=be(n),2===t)var r=W,a=M,i=j,o=function(){return I},l=1;else 4===t&&(r=U,a=D,i=V,o=function(){return R},l=2);_e(e,{name:n,fromWireType:function(e){for(var n,a=R[e>>2],i=o(),c=e+4,s=0;s<=a;++s){var u=e+4+s*t;s!=a&&0!=i[u>>l]||(c=r(c,u-c),void 0===n?n=c:(n+=String.fromCharCode(0),n+=c),c=u+t)}return Qe(e),n},toWireType:function(e,r){"string"!=typeof r&&we("Cannot pass non-string to C++ string type "+n);var o=i(r),c=He(4+o+t);return R[c>>2]=o>>l,a(r,c+4,o+t),null!==e&&e.push(Qe,c),c},argPackAdvance:8,readValueFromPointer:se,J:function(e){Qe(e)}})},k:function(e,t,n,r,a,i){le[e]={name:be(t),Z:Pe(n,r),$:Pe(a,i),O:[]}},g:function(e,t,n,r,a,i,o,l,c,s){le[e].O.push({R:be(t),V:n,T:Pe(r,a),U:i,ha:o,ga:Pe(l,c),ia:s})},A:function(e,t){_e(e,{Y:!0,name:t=be(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},l:function(e,t,n,r){e=We[e],t||we("Cannot use deleted val. handle = "+t),t=xe[t].value;var a=Fe[n];e(t,n=void 0===a?be(n):a,null,r)},h:Se,m:function(e,t){for(var n=(t=function(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=Me(P[(t>>2)+r],"parameter "+r);return n}(e,t))[0],r=n.name+"_$"+t.slice(1).map((function(e){return e.name})).join("_")+"$",a=["retType"],i=[n],o="",l=0;l<e-1;++l)o+=(0!==l?", ":"")+"arg"+l,a.push("argType"+l),i.push(t[1+l]);r="return function "+de("methodCaller_"+r)+"(handle, name, destructors, args) {\n";var c=0;for(l=0;l<e-1;++l)r+="    var arg"+l+" = argType"+l+".readValueFromPointer(args"+(c?"+"+c:"")+");\n",c+=t[l+1].argPackAdvance;for(r+="    var rv = handle[name]("+o+");\n",l=0;l<e-1;++l)t[l+1].deleteObject&&(r+="    argType"+l+".deleteObject(arg"+l+");\n");return n.Y||(r+="    return retType.toWireType(destructors, rv);\n"),a.push(r+"};\n"),function(e){var t=We.length;return We.push(e),t}(e=Ie(a).apply(null,i))},i:function(e){4<e&&(xe[e].M+=1)},t:function(){return Te([])},n:function(e,t){return Te(e=(e=Me(e,"_emval_take_value")).readValueFromPointer(t))},c:function(){X()},v:function(e,t,n){N.copyWithin(e,t,t+n)},w:function(e){e>>>=0;var t=N.length;if(2147483648<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296),0<(r=Math.max(16777216,e,r))%65536&&(r+=65536-r%65536);e:{try{b.grow(Math.min(2147483648,r)-S.byteLength+65535>>>16),L(b.buffer);var a=1;break e}catch(e){}a=void 0}if(a)return!0}return!1},o:function(e,t,n,r){for(var a=0,i=0;i<n;i++){for(var o=P[t+8*i>>2],l=P[t+(8*i+4)>>2],c=0;c<l;c++){var s=N[o+c],u=je[e];0===s||10===s?((1===e?y:A)(x(u,0)),u.length=0):u.push(s)}a+=l}return P[r>>2]=a,0},a:b,u:function(){}};!function(){function e(e){t.asm=e.exports,K--,t.monitorRunDependencies&&t.monitorRunDependencies(K),0==K&&(null!==J&&(clearInterval(J),J=null),q&&(e=q,q=null,e()))}function n(t){e(t.instance)}function r(e){return(v||!l&&!c||"function"!=typeof fetch||$("file://")?Promise.resolve().then(re):fetch(te,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+te+"'";return e.arrayBuffer()})).catch((function(){return re()}))).then((function(e){return WebAssembly.instantiate(e,a)})).then(e,(function(e){A("failed to asynchronously prepare wasm: "+e),X(e)}))}var a={a:Ve};if(K++,t.monitorRunDependencies&&t.monitorRunDependencies(K),t.instantiateWasm)try{return t.instantiateWasm(a,e)}catch(e){return A("Module.instantiateWasm callback failed with error: "+e),!1}!function(){if(v||"function"!=typeof WebAssembly.instantiateStreaming||ee()||$("file://")||"function"!=typeof fetch)return r(n);fetch(te,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,a).then(n,(function(e){return A("wasm streaming compile failed: "+e),A("falling back to ArrayBuffer instantiation"),r(n)}))}))}()}();var Le,ze=t.___wasm_call_ctors=function(){return(ze=t.___wasm_call_ctors=t.asm.C).apply(null,arguments)},He=t._malloc=function(){return(He=t._malloc=t.asm.D).apply(null,arguments)},Qe=t._free=function(){return(Qe=t._free=t.asm.E).apply(null,arguments)},Ye=t.___getTypeName=function(){return(Ye=t.___getTypeName=t.asm.F).apply(null,arguments)};function Ze(){function e(){if(!Le&&(Le=!0,t.calledRun=!0,!w)){if(ae(Q),ae(Y),a(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();Z.unshift(e)}ae(Z)}}if(!(0<K)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)G();ae(H),0<K||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.___embind_register_native_and_builtin_types=function(){return(t.___embind_register_native_and_builtin_types=t.asm.G).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.H).apply(null,arguments)},q=function e(){Le||Ze(),Le||(q=e)},t.run=Ze,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return Ze(),e.ready});e.exports=a},2351:(e,t,n)=>{"use strict";var r={};n.r(r),n.d(r,{encode:()=>te,extension:()=>ee,mimeType:()=>$,name:()=>X,optionTemplate:()=>ne});var a={};n.r(a),n.d(a,{Subsampling:()=>oe,encode:()=>le,extension:()=>ie,mimeType:()=>ae,name:()=>re,optionTemplate:()=>ce});var i=n(7294),o=n(3935),l=n(5410),c=n(6336),s=n(6196);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var m=i.createElement("path",{d:"M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"});const f=function(e){return i.createElement("svg",u({width:"1em",height:"1em",viewBox:"0 0 438.549 438.549",fill:"currentColor"},e),m)};var d=n(6010);function p(e){e.currentTarget.blur()}function h(e){const{className:t,children:n,title:r,href:a,disabled:o,active:l,onClick:c}=e,s=(0,d.Z)("qzDJM",t,{_3vITC:l}),u=a?"a":"button";return i.createElement(u,{className:s,title:r,disabled:o,href:a,type:"button",onClick:c,onMouseUp:p},n)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var v=i.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),y=i.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"});const A=function(e){return i.createElement("svg",g({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),v,y)};function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var E=i.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),w=i.createElement("path",{d:"M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"});const _=function(e){return i.createElement("svg",b({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor"},e),E,w)},C=()=>{},x=["","K","M","G","T","P","E","Z","Y"];function S(e,t=1024){const n=Math.abs(e);if(0==n)return e.toFixed(2)+" B";const r=~~(Math.log2(n)/Math.log2(t));return`${(e/t**r).toFixed(2)} ${x[r]}B`}function T(e){const{name:t,children:n,checked:r,disabled:a,onChange:o=C}=e;return i.createElement("label",{className:"_1Rf6P"},i.createElement("input",{type:"checkbox",className:"_2l4gd",name:t,disabled:a,onChange:o}),i.createElement("span",{className:(0,d.Z)("_2c_5M",{eMYLD:r})},r?i.createElement(_,null):i.createElement(A,null)),i.createElement("span",{className:"_3zAfJ"},n))}function N(e){const{name:t,children:n,checked:r,disabled:a,onChange:o=C}=e;return i.createElement("label",{className:"_1Ra8L"},i.createElement("input",{type:"radio",className:"_1GCir",name:t,disabled:a,onChange:e=>o(e.currentTarget.checked)}),i.createElement("span",{className:(0,d.Z)("_14VZt",{ixxKB:r})}),i.createElement("span",{className:"_1bBLB"},n))}function k(e){var t;const n={"--value-percent":(null!==(t=e.value)&&void 0!==t?t:0)+"%"};return i.createElement("span",{className:"_2DhF4",style:n},i.createElement("input",{type:"range",className:"_3dzMs",value:e.value,min:e.min,max:e.max,step:e.step,onChange:e.onChange}),i.createElement("span",{className:"_2b567"},i.createElement("span",{className:"_26ZKf"})))}function I(e){const{className:t,children:n,title:r,disabled:a,color:o,busy:l,onClick:c}=e,s=(0,d.Z)("_1AJKp",t,o,{j6_PE:l});return i.createElement("button",{className:s,title:r,disabled:a,type:"button",onClick:c,onMouseUp:p},n)}const P="_1H0a4";function R(e){const{disabled:t,onChange:n,value:r,min:a,max:o,step:l,name:c,className:s}=e,[u,m]=function(e=0,t=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=0){const[a,o]=(0,i.useState)(e);return[a,function(e){if(e>n)e=n;else if(e<t)e=t;else if(0!==r){const t=e/r;Number.isInteger(t)||(e=Math.round(t)*r)}return o(e),e}]}(r,a,o,.5),f=void 0===r?u:r;function p(e){e=m(e),n&&n(e)}return i.createElement("div",{className:(0,d.Z)("_2dfjc",s)},i.createElement("input",{type:"number",className:"xI_9P",disabled:t,name:c,value:r,onChange:p}),i.createElement("button",{type:"button",className:(0,d.Z)(P,"dBnP0"),tabIndex:-1,disabled:t,onClick:()=>p(f+(l||1))}),i.createElement("button",{type:"button",className:P,tabIndex:-1,disabled:t,onClick:()=>p(f-(l||1))}))}const O="_3_cLi",B="_1p1yr";function F(){const e=document.body.querySelectorAll("._3_cLi"),t=e[e.length-2];if(t)return t.classList.add(B),()=>t.classList.remove(B)}function W(e){const{className:t,onClose:n=C}=e;function r(e){"Escape"===e.key&&(n(),e.stopImmediatePropagation())}return(0,i.useEffect)((()=>(window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r))),[]),(0,i.useLayoutEffect)(F,[]),(0,o.createPortal)(i.createElement("div",{className:O},i.createElement("div",{className:(0,d.Z)(t,"_1Vq87")},e.children)),document.body)}var M=n(9870);async function j(e){const t=URL.createObjectURL(e);try{return await async function(e){const t=new Image;t.decoding="async",t.src=e;const n=new Promise(((e,n)=>{t.onload=()=>e(),t.onerror=()=>n(Error("Image loading error"))}));return t.decode&&await t.decode().catch((()=>null)),await n,t}(t)}finally{URL.revokeObjectURL(t)}}function U(){return new Worker(new URL(n.p+n.u(843),n.b))}new Map,new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\x00\x00\x00 ftypavif\x00\x00\x00\x00/,"image/avif"]]);class D{constructor(e,t){if(this.workers=[],this.index=0,e<1)throw new Error("Thread count must be at least 1");this.count=e,this.encoder=t}onProgress(e){}async encode(e,t,n){this.image=e,this.optionsList=t,this.measureOptions=n;const r=t.length;this.results=new Array(r);const a=new Array(this.workers.length);this.workers=[];for(let t=0;t<this.count;t++){const t=U(),n=M.Ud(t);await n.setImageToEncode(e),this.workers.push(t),a.push(this.poll(n))}return Promise.all(a).then((()=>this.results))}stop(){this.workers.forEach((e=>e.terminate()))}async poll(e){const{results:t,optionsList:n,encoder:r}=this;for(;this.index<n.length;){const a=this.index++;this.onProgress(a);const{buffer:i,time:o}=await r.encode(n[a],e),l=new Blob([i],{type:r.mimeType}),c=await Y(l),s=await this.measure(e,c);t[a]={time:o,buffer:i,data:c,metrics:s}}}async measure(e,t){const{SSIM:n,PSNR:r,butteraugli:a}=this.measureOptions,i={};if(r&&(i.PSNR=await e.calcPSNR(t)),n&&(i.SSIM=await e.calcSSIM(t)),a){const[n,r]=await e.calcButteraugli(t,{ensureAlpha:!0}),a=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height);a.data.set(new Uint8ClampedArray(r)),i.butteraugli={source:n,heatMap:a}}return i}}async function V(e){const t="createImageBitmap"in self?await createImageBitmap(e):await j(e),n=document.createElement("canvas"),{width:r,height:a}=t;n.width=r,n.height=a;const i=n.getContext("2d");return i.drawImage(t,0,0),i.getImageData(0,0,r,a)}function L(e,t,n){let r;return r=async function(a){return r=await e()?t:n,await r(a)},e=>r(e)}const z=L((function(){const e=new Image;return e.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",new Promise((t=>{e.onload=()=>t(!0),e.onerror=()=>t(!1)}))}),(function(e){return V(new Blob([e],{type:"image/webp"}))}),(async function(e,t){return t||(t=M.Ud(U())),t.webpDecode(e)})),H=L((function(){const e=new Image;return e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABYAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAABAAQAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB5tZGF0EgAKBzgADtAQQBkyCRAAAAAP+I9ngw==",new Promise((t=>{e.onload=()=>t(!0),e.onerror=()=>t(!1)}))}),(function(e){return V(new Blob([e],{type:"image/avif"}))}),(async function(e){const t=U();return M.Ud(t).avifDecode(e)}));async function Q(e){e=function(e){const t=(new DOMParser).parseFromString(e,"image/svg+xml"),n=t.documentElement;if(n.getAttribute("width")&&n.getAttribute("height"))return e;const r=n.getAttribute("viewBox");if(null===r)throw Error("SVG must have width/height or viewBox");const[,,a,i]=r.split(/\s+/);return n.setAttribute("width",a),n.setAttribute("height",i),(new XMLSerializer).serializeToString(t)}(e);const t=new Blob([e],{type:"image/svg+xml"});return function(e,t={}){const{width:n=e.width,height:r=e.height,sx:a=0,sy:i=0,sw:o=e.width,sh:l=e.height}=t,c=document.createElement("canvas");c.width=n,c.height=r;const s=c.getContext("2d");if(!s)throw new Error("Could not create canvas context");return s.drawImage(e,a,i,o,l,0,0,n,r),s.getImageData(0,0,n,r)}(await j(t))}function Y(e){switch(e.type){case"image/svg+xml":return e.text().then(Q);case"image/webp":return e.arrayBuffer().then(z);case"image/avif":return e.arrayBuffer().then(H);default:return V(e)}}var Z;!function(e){e[e.WEBP_HINT_DEFAULT=0]="WEBP_HINT_DEFAULT",e[e.WEBP_HINT_PICTURE=1]="WEBP_HINT_PICTURE",e[e.WEBP_HINT_PHOTO=2]="WEBP_HINT_PHOTO",e[e.WEBP_HINT_GRAPH=3]="WEBP_HINT_GRAPH"}(Z||(Z={}));const G={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};class K{constructor(e,t,n){this.min=e,this.max=t,this.defaultValue=n}newValue(){return this.defaultValue}ValueField(e,t){const{min:n,max:r}=this;return i.createElement("label",null,i.createElement("p",null,e),i.createElement("input",{type:"number",min:n,max:r,value:t}))}newVariable(){return{min:this.min,max:this.max,step:1}}VariableField(e,t){const{min:n,max:r}=this;return i.createElement("div",null,i.createElement("p",null,e),i.createElement("label",null,i.createElement("span",null,"min: "),i.createElement(R,{value:t.min,min:n,max:r})),i.createElement("label",null,i.createElement("span",null,"max: "),i.createElement("input",{type:"number",min:n,max:r,value:t.max})),i.createElement("label",null,i.createElement("span",null,"step: "),i.createElement("input",{type:"number",min:n,max:r,value:t.step})))}*generate(e,t,n){const{min:r,max:a,step:i}=n;for(let n=r;n<a;n+=i)yield{...t,[e]:n}}}class J{constructor(e){this.defaultValue=e}newValue(){return this.defaultValue}ValueField(e,t){return i.createElement(T,{checked:t})}newVariable(){}VariableField(e){return i.createElement("strong",null,"OFF & ON")}*generate(e,t){yield{...t,[e]:!1},yield{...t,[e]:!0}}}class q{constructor(e,t){this.enumObject=e,this.defaultValue=t}newValue(){return this.defaultValue}ValueField(e,t){const n=Object.keys(this.enumObject).map((e=>i.createElement(N,{key:e,name:e,checked:t},e)));return i.createElement("div",null,n)}newVariable(){const e=Object.keys(this.enumObject).map((e=>({[e]:!1})));return e[this.defaultValue]=!0,e}VariableField(e,t){const n=Object.entries(t).map((t=>i.createElement(T,{key:e,name:e,checked:t[1]},t[0])));return i.createElement("div",null,n)}generate(e,t,n){return Object.entries(n).filter((e=>e[1])).map((e=>this.enumObject[e[0]]))}}const X="WebP",$="image/webp",ee="webp";function te(e,t){return t.webpEncode(e)}const ne=[{label:"Quality (-q)",name:"quality",type:new K(0,100,75),defaultVariable:!0},{label:"Method (-m)",name:"method",type:new K(0,6,4)},{label:"Spatial noise shaping (-sns)",name:"sns",type:new K(0,100,50)},{label:"Filter strength (-f)",name:"filter_strength",type:new K(0,100,60)},{label:"Preset (-preset)",name:"preset",type:new q({default:{},photo:{sns_strength:80,filter_sharpness:3,filter_strength:30,preprocessing:2},picture:{sns_strength:80,filter_sharpness:4,filter_strength:35,preprocessing:-3},drawing:{sns_strength:25,filter_sharpness:6,filter_strength:10},icon:{sns_strength:25,filter_strength:10,preprocessing:-3},text:{sns_strength:0,filter_strength:0,preprocessing:-3,segments:2}},"default")},{label:"User strong filter (-strong)",name:"filter_type",type:new J(!0)},{label:"Auto adjust filter strength (-af)",name:"autofilter",type:new J(!1)},{label:"Filter sharpness (-sharpness)",name:"filter_sharpness",type:new K(0,7,0)},{label:"Hint (-hint)",name:"image_hint",type:new q({DEFAULT:0,PICTURE:1,PHOTO:2,GRAPH:3},"DEFAULT")}],re="AVIF",ae="image/avif",ie="avif",oe={YUV400:0,YUV420:1,YUV422:2,YUV444:3};function le(e,t){return t.avifEncode(e)}const ce=[{label:"minQuantizer",name:"minQuantizer",type:new K(0,63,33),defaultVariable:!0},{label:"maxQuantizer",name:"maxQuantizer",type:new K(0,63,63)},{label:"minQuantizerAlpha",name:"minQuantizer",type:new K(0,63,33),defaultVariable:!0},{label:"maxQuantizerAlpha",name:"maxQuantizerAlpha",type:new K(0,63,63)},{label:"speed",name:"speed",type:new K(0,10,8)},{label:"subsample",name:"subsample",type:new q(oe,"YUV420")}],se=ne,ue=[r,a],me=Object.fromEntries(ue.map((e=>[e.name,e]))),fe="_29qBc";function de(e){const{encoder:t,onConfigChange:n,onEncoderChange:r}=e,{vars:a,valueState:o,variableState:l}=e.config,c=t.optionTemplate.map((e=>{const{name:t,type:n}=e,r=a.includes(t);let c;return c=r?n.VariableField(t,l[t]):n.ValueField(t,o[t]),i.createElement("div",{key:t},i.createElement(N,{checked:r,name:"vars",onChange:e=>{e&&onVarsChange([t])}},t),c)}));return i.createElement("form",null,i.createElement("select",{value:t.name,onChange:function(e){r(me[e.currentTarget.value])}},ue.map((e=>i.createElement("option",{key:e.name},e.name)))),i.createElement("span",null,"Resize:"),i.createElement("select",null,i.createElement("option",null,"100"),i.createElement("option",null,"50"),i.createElement("option",null,"25"),i.createElement("option",null,"12.5"),i.createElement("option",null,"6.25")),i.createElement("fieldset",null,c))}function pe(e){const{file:t}=e,{width:n,height:r,data:a}=e.image,o=(t.size/a.byteLength*100).toFixed(2);return i.createElement("div",{className:"dialog-content"},i.createElement("canvas",{className:"WKrzW",ref:function(t){if(!t)return;const n=t.getContext("2d");null==n||n.putImageData(e.image,0,0)},width:n,height:r}),i.createElement("dl",{className:"lL9Er"},i.createElement("dt",null,"File name:"),i.createElement("dd",null,t.name),i.createElement("dt",null,"Type:"),i.createElement("dd",null,t.type),i.createElement("dt",null,"Resolution:"),i.createElement("dd",null,n," x ",r),i.createElement("dt",null,"Raw size:"),i.createElement("dd",null,S(a.byteLength)),i.createElement("dt",null,"File size:"),i.createElement("dd",null,S(t.size)," (",o,"%)")))}n(964),n(556);const he={hfAsymmetry:1,goodQualitySeek:1.5,badQualitySeek:.5,ensureAlpha:!1},ge="_2vX3s",ve="ba7J1",ye="_3TEx7";function Ae(e){const{workerCount:t,onWorkerCountChange:n,onMeasureChange:r}=e,{SSIM:a,PSNR:o,butteraugli:l}=e.options,[c,s]=(0,i.useState)(he);let u;if(l){const{badQualitySeek:e,goodQualitySeek:t,hfAsymmetry:n}=l;u=i.createElement("fieldset",{className:"subfields"},i.createElement("label",{className:ge},i.createElement("span",{className:ve},"hfAsymmetry"),i.createElement(R,{className:ye,name:"hfAsymmetry",min:0,step:.1,value:n})),i.createElement("label",{className:ge},i.createElement("span",{className:ve},"badQualitySeek"),i.createElement(R,{className:ye,name:"badQualitySeek",min:0,max:2,step:.1,value:e})),i.createElement("label",{className:ge},i.createElement("span",{className:ve},"goodQualitySeek"),i.createElement(R,{className:ye,name:"goodQualitySeek",min:0,max:2,step:.1,value:t})))}function m(t){const{name:n,checked:a}=t.currentTarget,i="butteraugli"!==n?a:a&&c;r({...e.options,[n]:i})}return i.createElement("form",{className:"_3_OKa dialog-content"},i.createElement("label",null,i.createElement("span",{className:"_2MSGh"},"Worker count:"),i.createElement(R,{value:t,min:1,step:1,onChange:n})),i.createElement(T,{checked:a,name:"SSIM",onChange:m},"Calculate SSIM"),i.createElement(T,{checked:o,name:"PSNR",onChange:m},"Calculate PSNR"),i.createElement(T,{checked:!!l,name:"butteraugli",onChange:m},"Calculate Butteraugli"),u)}function be(e){const{file:t,image:n,onStart:r,onClose:a,onSelectFile:o}=e,[l,c]=(0,i.useState)((()=>se.filter((e=>e.defaultVariable)).map((e=>e.name)))),[s,u]=(0,i.useState)({}),[m,f]=(0,i.useState)(4),[p,h]=(0,i.useState)({SSIM:!1,PSNR:!0,butteraugli:!1}),[g,v]=(0,i.useState)(0),y=["Select File","Options","Metrics"],A=[];for(let e=0;e<y.length;e++){const t=y[e],n=e===g?(0,d.Z)(fe,"wG4Ax"):fe;A.push(i.createElement("div",{key:e,className:n,onClick:()=>v(e)},t))}let b;switch(g){case 0:b=i.createElement(pe,{file:t,image:n});break;case 1:b=i.createElement(de,{vars:l,options:s,onVarsChange:c});break;case 2:b=i.createElement(Ae,{workerCount:m,options:p,onWorkerCountChange:f,onMeasureChange:h});break;default:throw new Error}return i.createElement(W,{className:"_6sryz",onClose:a},i.createElement("div",{className:"_3x7vU"},A),b,i.createElement("div",{className:"dialog-actions"},i.createElement(I,{onClick:o},"Select file"),i.createElement(I,{color:"second",onClick:a},"Cancel"),i.createElement(I,{disabled:!t,onClick:async function(){const e=new Array(101);for(let t=0;t<101;t++)e[t]={...G,quality:t};r(e,p,m)}},"Start")))}const Ee=new Intl.RelativeTimeFormat("en");function we(e,t,n){return(n-t)/t*(performance.now()-e)}function _e(e){const{value:t,max:n,onCancel:r}=e,[a]=(0,i.useState)((()=>performance.now())),o=(0,i.useMemo)((()=>function(e,t){let n,r=!1;return function(...e){return r?n:(r=!0,setTimeout((()=>r=!1),500),n=t.apply(this,e))}}(0,we)),[])(a,t,n),l=Number.isNaN(o)?"----":Ee.format(~~(o/1e3),"seconds");return i.createElement(W,null,i.createElement("div",{className:"_1RFbq dialog-content"},i.createElement("h1",null,"Encoding..."),i.createElement("div",{className:"_3vxdS"},i.createElement("span",null,t,"/",n),i.createElement("span",null,"Remaining: ",l)),i.createElement("progress",{value:t,max:n,className:"mrzz8"})),i.createElement("div",{className:"_3UNgR dialog-actions"},i.createElement(I,{color:"second",onClick:r}," Cancel ")))}var Ce=n(3851);const xe="_3SDL7";function Se(e){const{onCancel:t,onFileChange:n}=e,r=function(){const[e,t]=(0,i.useState)(!1),n=(0,i.useRef)(0);return{isInArea:e,enter:function(){t(++n.current>0)},leave:function(){t(--n.current>0)},reset:function(){n.current=0,t(!1)}}}(),a=(0,i.useRef)(null),[o,l]=(0,i.useState)(!1),[c,s]=(0,i.useState)("");function u(e){Y(e).then((t=>n(e,t))).catch((()=>s("Can not decode file as image")))}return i.createElement(W,{onClose:t},i.createElement("form",{className:"_34kSI dialog-content"},i.createElement("label",{className:(0,d.Z)("_3uHix",{_2jvwR:r.isInArea}),tabIndex:0,onDragEnter:r.enter,onDragOver:e=>e.preventDefault(),onDrop:function(e){e.preventDefault(),r.reset();const{items:t}=e.dataTransfer,n=t[0].getAsFile();n?u(n):s("The dropped item is not a file")},onDragLeave:r.leave},i.createElement("div",null,i.createElement("span",{className:"wYvdR"},i.createElement(Ce.Z,null)),i.createElement("span",{className:xe},"Drag & drop")),i.createElement("div",{className:xe},"Or select an image"),i.createElement("input",{className:"_3-brh",name:"file",type:"file",accept:"image/*",onChange:function(e){u(e.currentTarget.files[0])}})),i.createElement("label",null,i.createElement("span",{className:"_3IWsb"},"Or image url"),i.createElement("input",{className:"_2PTc9 text-box",name:"url",ref:a})),i.createElement("div",{className:"Qed9H"},c)),i.createElement("div",{className:"dialog-actions"},i.createElement(I,{color:"second",onClick:t},"Back"),i.createElement(I,{busy:o,onClick:async function(){const e=a.current.value;if(e){l(!0);try{u(await async function(e){const t=await(await fetch(e)).blob(),n=new URL(e).pathname.split("/").pop()||"image";return new File([t],n)}(e))}catch(e){s(e.message)}finally{l(!1)}}}},"Download Url")))}function Te(e){const[t,n]=(0,i.useState)(),[a,o]=(0,i.useState)(),[l,c]=(0,i.useState)(!0),[s,u]=(0,i.useState)({}),[m,f]=(0,i.useState)(1),[d,p]=(0,i.useState)(0);return s?i.createElement(_e,{value:d,max:m,onCancel:function(){s.stop(),u(null)}}):l?i.createElement(Se,{onCancel:function(){t||e.onClose(),c(!1)},onFileChange:async function(e){const t=await Y(e);n(e),o(t),c(!1)}}):i.createElement(be,{image:a,file:t,onSelectFile:()=>c(!0),onClose:e.onClose,onStart:async function(n,a,i){if(!t)throw new Error("File is null");const o=new D(i,r);o.onProgress=p,u(o),f(n.length),p(0);const l=await Y(t),c=await o.encode(l,n,a);e.onChange({file:t,data:l},r,c)}})}var Ne=n(1055),ke=n.n(Ne);function Ie(e){const{original:t,outputs:n,index:r}=e,[a,o]=(0,i.useState)();return(0,i.useEffect)((()=>{null==a||a.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:r});const e=null==a?void 0:a.getOption().series;null==a||a.setOption({legend:{formatter:t=>{const n=e.filter((e=>e.name===t));return`${t}: ${n[0].data[r]}`},data:["Compression Ratio %","Encode Time (ms)","PSNR (db)"]}})})),i.createElement("section",{className:"_3T5Kh"},i.createElement("div",{className:"JAZV5",ref:function(e){if(e&&!a){const r=ke().init(e,"dark",{renderer:"svg"});o(r),function(e){const r="line",a=[{name:"Compression Ratio %",type:r,data:n.map((e=>e.buffer.byteLength/t.file.size)),yAxisIndex:0},{name:"Encode Time (ms)",type:r,data:n.map((e=>e.time)),yAxisIndex:1},{name:"PSNR (db)",type:r,data:n.map((e=>e.metrics.PSNR)),yAxisIndex:2}],i={tooltip:{trigger:"axis",showContent:!1,triggerOn:"none"},legend:{data:["Compression Ratio %","Encode Time (ms)","PSNR (db)"]},xAxis:{data:n.map(((e,t)=>t))},yAxis:[{type:"value"},{type:"value"},{type:"value",offset:40}],backgroundColor:"transparent",series:a},{SSIM:o,PSNR:l,butteraugli:c}=n[0].metrics;o&&a.push({name:"SSIM",type:r,data:n.map((e=>e.metrics.SSIM)),yAxisIndex:2}),null==e||e.setOption(i)}(r)}}}))}const Pe="_1qN8w",Re="_1YBWC";var Oe;function Be(e){const{original:t,optimized:n}=e,{width:r=0,height:a=0}=(null==t?void 0:t.data)||{},[o,l]=(0,i.useState)(Oe.Compressed),[c,s]=(0,i.useState)(100),[u,m]=(0,i.useState)(1),[f,d]=(0,i.useState)({x:0,y:0}),p=(0,i.useRef)(null),g=(0,i.useRef)(null);function v(e){const{children:t,target:n,disabled:r}=e;return i.createElement(h,{active:o===n,disabled:r,onClick:()=>l(n)},t)}function y(){const e=f.x,t=f.y;return(n,r)=>{d({x:e+n,y:t+r})}}(0,i.useEffect)((function(){t&&(m(1),d({x:0,y:0}),p.current.getContext("2d").putImageData(t.data,0,0))}),[t]),(0,i.useEffect)((function(){if(!n)return;const{metrics:e,data:t}=n,r=g.current.getContext("2d");if(!r)throw new Error("Could not create canvas context");o===Oe.HeatMap?r.putImageData(e.butteraugli.heatMap,0,0):r.putImageData(t,0,0)}),[o,n]);let A=null,b=100;o===Oe.AbsDiff&&(b=c,A=i.createElement("label",null,"Brightness:",i.createElement(R,{value:c,min:100,step:50,onChange:s})));const E={width:r,height:a,"--scale":u,"--x":f.x+"px","--y":f.y+"px","--brightness":b+"%"},w=o===Oe.AbsDiff?"difference":void 0,_=!(null==n?void 0:n.metrics.butteraugli);return i.createElement("div",{className:"_3kS7K"},i.createElement("aside",{className:"_1Tvc7 controls"},i.createElement("div",null,i.createElement(v,{target:Oe.Original},"Original"),i.createElement(v,{target:Oe.Compressed},"Compressed"),i.createElement(v,{target:Oe.AbsDiff},"Difference"),i.createElement(v,{disabled:_,target:Oe.HeatMap},"HeatMap")),A),i.createElement("div",{className:"_1iZci",onWheel:function(e){const{ctrlKey:t,deltaMode:n}=e;let{deltaY:r}=e;e.preventDefault(),1===n&&(r*=15),m(u*(1-r/(t?100:300)))},onMouseDown:e=>0===e.button&&function(e,t){const n=e.pageX,r=e.pageY;function a(e){t(e.pageX-n,e.pageY-r)}document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function e(t){t.preventDefault(),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e)}))}(e.nativeEvent,y()),onTouchStart:e=>function(e,t){const n=e.touches[0];function r(e){const r=e.touches[0];t(r.pageX-n.pageX,r.pageY-n.pageY)}document.addEventListener("touchmove",r),document.addEventListener("touchend",(function e(t){t.preventDefault(),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",e)}))}(e.nativeEvent,y())},i.createElement("div",{className:"_2sQef",style:E},i.createElement("canvas",{className:Re,ref:p,width:r,height:a}),i.createElement("canvas",{className:Re,style:{mixBlendMode:w},ref:g,width:r,height:a,hidden:o===Oe.Original}))))}!function(e){e[e.Original=0]="Original",e[e.Compressed=1]="Compressed",e[e.AbsDiff=2]="AbsDiff",e[e.HeatMap=3]="HeatMap"}(Oe||(Oe={}));const Fe={encoder:void 0,original:void 0,outputs:[]};function We(e){const{title:t,buffer:n,filename:r,children:a}=e,{mimeType:o,extension:l}=e.encoder||{},[c,s]=(0,i.useState)("");return(0,i.useEffect)((()=>()=>URL.revokeObjectURL(c)),[]),i.createElement(h,{className:Pe,title:t,disabled:!n,onClick:function(){const e=new Blob([n],{type:o});URL.revokeObjectURL(c);const t=URL.createObjectURL(e);s(t);const a=document.createElement("a");a.href=t,a.download=r.replace(/.[^.]*$/,"."+l),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},a)}o.render(i.createElement((function(){var e,t;const[n,r]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[u,m]=(0,i.useState)(0),[d,p]=(0,i.useState)(Fe);return(0,i.useEffect)((()=>o(d!==Fe)),[d]),i.createElement(i.Fragment,null,i.createElement(Be,Object.assign({},d,{optimized:d.outputs[u]})),a&&i.createElement(Ie,Object.assign({},d,{index:u})),i.createElement("div",{className:"_2vHCK controls"},i.createElement(h,{title:"Fork me from GitHub",href:"https://github.com/Kaciras/ICAnalyze",className:Pe},i.createElement(f,null)),i.createElement(h,{title:"Select an image",className:Pe,onClick:()=>r(!0)},i.createElement(l.Z,null)),i.createElement(h,{title:"Show chart",className:Pe,disabled:d===Fe,active:a,onClick:()=>o(!a)},i.createElement(c.Z,null)),i.createElement(We,{title:"Download compressed image",filename:null===(e=d.original)||void 0===e?void 0:e.file.name,encoder:d.encoder,buffer:null===(t=d.outputs[u])||void 0===t?void 0:t.buffer},i.createElement(s.Z,null))),i.createElement("div",{className:"_36pDd controls"},i.createElement("label",null,i.createElement("p",null,"Quality (-q)",i.createElement("span",{className:"_1Keds"},u)),i.createElement(k,{value:u,min:0,step:1,max:100,onChange:e=>m(e.currentTarget.valueAsNumber)}))),n&&i.createElement(Te,{onClose:()=>r(!1),onChange:async function(e,t,n){p({outputs:n,encoder:t,original:e}),m(75),r(!1)}}))}),null),document.getElementById("root"))},2993:()=>{},1386:()=>{}},t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.u=e=>e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={826:0},t=[[2351,776]],r=()=>{};function a(){for(var r,a=0;a<t.length;a++){for(var i=t[a],o=!0,l=1;l<i.length;l++){var c=i[l];0!==e[c]&&(o=!1)}o&&(t.splice(a--,1),r=n(n.s=i[0]))}return 0===t.length&&(n.x(),n.x=()=>{}),r}n.x=()=>{n.x=()=>{},o=o.slice();for(var e=0;e<o.length;e++)i(o[e]);return(r=a)()};var i=a=>{for(var i,o,[c,s,u,m]=a,f=0,d=[];f<c.length;f++)o=c[f],n.o(e,o)&&e[o]&&d.push(e[o][0]),e[o]=0;for(i in s)n.o(s,i)&&(n.m[i]=s[i]);for(u&&u(n),l(a);d.length;)d.shift()();return m&&t.push.apply(t,m),r()},o=self.webpackChunkic_analyze=self.webpackChunkic_analyze||[],l=o.push.bind(o);o.push=i})(),n.x()})();
//# sourceMappingURL=index.js.map